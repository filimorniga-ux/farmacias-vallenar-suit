-- RLS Enforcer: Supabase Direct\n\nBEGIN;\n\n-- 1. Enable RLS en Tablas PÃºblicas\nALTER TABLE public."audit_logs" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."sales" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."accounts_payable" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."ai_usage_log" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."app_settings" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."audit_events" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."warehouses" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."attendance_logs" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."audit_action_catalog" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."board_notes" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."bodegas" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."cash_counts" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."cash_movements" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."cash_register_sessions" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."categories" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."configuracion_global" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."customers" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."employee_shifts" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."financial_accounts" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."inventory" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."inventory_batches" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."inventory_imports" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."invoice_history" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."isp_registry" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."invoice_parsings" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."laboratories" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."legal_documents" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."login_attempts" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."lotes" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."maintenance_backup_inventory_batches_location_fix_20260220" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."monthly_closing_entries" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."movimientos_inventario" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."monthly_closings" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."notifications" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."price_adjustment_batches" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."product_suppliers" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."purchase_orders" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."queue_tickets" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."productos" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."quote_items" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."quotes" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."reconciliation_alerts" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."reconciliation_justifications" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."shift_logs" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."reconciliation_patterns" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."retry_queue" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."shift_templates" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."sales_headers" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."schema_migrations" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."shipment_items" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."shipments" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."staff_contracts" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."stock_movements" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."supplier_catalog_files" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."suppliers" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."system_alerts" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."time_off_requests" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."system_configs" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."therapeutic_actions" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."treasury_remittances" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."treasury_transactions" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."users" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."terminals" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."accounts_payable_payments" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."audit_log" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."cash_reconciliations" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."locations" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."sucursales" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."sale_items" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."products" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."product_batches" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."purchase_order_items" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."sales_items" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."supplier_account_documents" ENABLE ROW LEVEL SECURITY;\nALTER TABLE public."ventas" ENABLE ROW LEVEL SECURITY;\n\n-- 2. Reforzar Views a INVOKER\nALTER VIEW public."v_daily_audit_summary" SET (security_invoker = true);\nALTER VIEW public."v_invoice_parsings_pending" SET (security_invoker = true);\nALTER VIEW public."v_problematic_reconciliations" SET (security_invoker = true);\nALTER VIEW public."v_reconciliation_summary" SET (security_invoker = true);\nALTER VIEW public."v_suspicious_activity" SET (security_invoker = true);\nALTER VIEW public."v_terminals_status" SET (security_invoker = true);\nALTER VIEW public."v_user_activity_timeline" SET (security_invoker = true);\nALTER VIEW public."v_zombie_sessions" SET (security_invoker = true);\nALTER VIEW public."v_accounts_payable_aging" SET (security_invoker = true);\nALTER VIEW public."v_accounts_payable_summary" SET (security_invoker = true);\nALTER VIEW public."v_active_reconciliation_alerts" SET (security_invoker = true);\nALTER VIEW public."v_ai_usage_summary" SET (security_invoker = true);\nALTER VIEW public."v_audit_chain_integrity" SET (security_invoker = true);\nALTER VIEW public."v_cashier_reconciliation_history" SET (security_invoker = true);\n\nCOMMIT;\n