(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:n="",children:c,iconNode:d,...o},h)=>(0,t.createElement)("svg",{ref:h,...a,width:r,height:r,stroke:e,strokeWidth:i?24*Number(l)/Number(r):l,className:s("lucide",n),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(o)&&{"aria-hidden":"true"},...o},[...d.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(c)?c:[c]])),i=(e,a)=>{let i=(0,t.forwardRef)(({className:i,...n},c)=>(0,t.createElement)(l,{ref:c,iconNode:a,className:s(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...n}));return i.displayName=r(e),i};e.s(["default",()=>i],75254)},18566,(e,t,r)=>{t.exports=e.r(76562)},42760,e=>{"use strict";let t,r,s,a;var l,i=e.i(71645);let n=e=>{let t,r=new Set,s=(e,s)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=s?s:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,l={setState:s,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(s,a,l);return l},c=e=>t=>{try{let r=e(t);if(r instanceof Promise)return r;return{then:e=>c(e)(r),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>c(t)(e)}}},d=(s=(l=(t=e=>({user:null,isAuthenticated:!1,login:t=>e({user:t,isAuthenticated:!0}),logout:()=>e({user:null,isAuthenticated:!1})}),r={name:"auth-storage"},(e,s,a)=>{let l,i={storage:function(e,t){let r;try{r=e()}catch(e){return}return{getItem:e=>{var t;let s=e=>null===e?null:JSON.parse(e,void 0),a=null!=(t=r.getItem(e))?t:null;return a instanceof Promise?a.then(s):s(a)},setItem:(e,t)=>r.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>r.removeItem(e)}}(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...r},n=!1,d=new Set,o=new Set,h=i.storage;if(!h)return t((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),e(...t)},s,a);let u=()=>{let e=i.partialize({...s()});return h.setItem(i.name,{state:e,version:i.version})},x=a.setState;a.setState=(e,t)=>(x(e,t),u());let m=t((...t)=>(e(...t),u()),s,a);a.getInitialState=()=>m;let p=()=>{var t,r;if(!h)return;n=!1,d.forEach(e=>{var t;return e(null!=(t=s())?t:m)});let a=(null==(r=i.onRehydrateStorage)?void 0:r.call(i,null!=(t=s())?t:m))||void 0;return c(h.getItem.bind(h))(i.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];else{if(i.migrate){let t=i.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(t=>{var r;let[a,n]=t;if(e(l=i.merge(n,null!=(r=s())?r:m),!0),a)return u()}).then(()=>{null==a||a(l,void 0),l=s(),n=!0,o.forEach(e=>e(l))}).catch(e=>{null==a||a(void 0,e)})};return a.persist={setOptions:e=>{i={...i,...e},e.storage&&(h=e.storage)},clearStorage:()=>{null==h||h.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>n,onHydrate:e=>(d.add(e),()=>{d.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},i.skipHydration||p(),l||m}))?n(l):n,Object.assign(a=e=>(function(e,t=e=>e){let r=i.default.useSyncExternalStore(e.subscribe,i.default.useCallback(()=>t(e.getState()),[e,t]),i.default.useCallback(()=>t(e.getInitialState()),[e,t]));return i.default.useDebugValue(r),r})(s,e),s),a);e.s(["useAuthStore",0,d],42760)},84901,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),a=e.i(42760);function l({children:e,allowedRoles:l}){let i=(0,s.useRouter)(),{isAuthenticated:n,user:c}=(0,a.useAuthStore)(),[d,o]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{n?l&&c&&!l.includes(c.role)?i.push("/"):o(!0):i.push("/login")},[n,c,i,l]),d)?(0,t.jsx)(t.Fragment,{children:e}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})}e.s(["default",()=>l])},1928,e=>{"use strict";let t=(0,e.i(75254).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);e.s(["ShoppingCart",()=>t],1928)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},55784,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(55436),a=e.i(1928),l=e.i(75254);let i=(0,l.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),n=(0,l.default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),c=(0,l.default)("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),d=(0,l.default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]),o=(0,l.default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);var h=e.i(7233);let u=(0,l.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);async function x(e,t){await new Promise(e=>setTimeout(e,800));let r=Math.round(e/1.19);return{folio:Math.floor(1e5*Math.random())+1,fecha:new Date().toISOString(),total:e,neto:r,iva:e-r,items:t,razon_social:"FARMACIAS VALLENAR SPA",rut_emisor:"76.123.456-7",direccion:"Calle Prat 123, Vallenar",giro:"VENTA AL POR MENOR DE PRODUCTOS FARMACEUTICOS",track_id:crypto.randomUUID(),estado:"ACEPTADO"}}function m(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(e)}let p=(0,l.default)("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);function g({data:e}){return(0,t.jsxs)("div",{className:"bg-white p-4 w-[300px] mx-auto text-black font-mono text-xs print-only",children:[(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("h1",{className:"font-bold text-lg uppercase",children:e.razon_social}),(0,t.jsxs)("p",{children:["RUT: ",e.rut_emisor]}),(0,t.jsx)("p",{children:e.giro}),(0,t.jsx)("p",{children:e.direccion}),(0,t.jsx)("p",{children:"Fono: +56 51 261 2345"})]}),(0,t.jsxs)("div",{className:"text-center border-t border-b border-black py-2 mb-4",children:[(0,t.jsx)("h2",{className:"font-bold text-sm",children:"BOLETA ELECTRÓNICA"}),(0,t.jsxs)("p",{className:"text-lg font-bold",children:["Nº ",e.folio]}),(0,t.jsx)("p",{children:"S.I.I. - VALLENAR"}),(0,t.jsxs)("p",{className:"mt-1",children:["Fecha: ",new Date(e.fecha).toLocaleString()]})]}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsxs)("table",{className:"w-full text-left",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-black border-dashed",children:[(0,t.jsx)("th",{className:"py-1 w-8",children:"Cant"}),(0,t.jsx)("th",{className:"py-1",children:"Desc"}),(0,t.jsx)("th",{className:"py-1 text-right",children:"Total"})]})}),(0,t.jsx)("tbody",{children:e.items.map((e,r)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"py-1 align-top",children:e.cantidad}),(0,t.jsx)("td",{className:"py-1 align-top",children:e.nombre}),(0,t.jsx)("td",{className:"py-1 align-top text-right",children:m(e.total)})]},r))})]})}),(0,t.jsxs)("div",{className:"border-t border-black border-dashed pt-2 mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Neto:"}),(0,t.jsx)("span",{children:m(e.neto)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"IVA (19%):"}),(0,t.jsx)("span",{children:m(e.iva)})]}),(0,t.jsxs)("div",{className:"flex justify-between font-bold text-sm mt-1",children:[(0,t.jsx)("span",{children:"TOTAL:"}),(0,t.jsx)("span",{children:m(e.total)})]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center mb-4",children:[(0,t.jsx)("div",{className:"border-2 border-black p-2 mb-1",children:(0,t.jsx)(p,{size:64,className:"text-black"})}),(0,t.jsxs)("p",{className:"text-[10px] uppercase text-center",children:["Timbre Electrónico SII",(0,t.jsx)("br",{}),"Res. 80 de 2014 - Verifique documento: www.sii.cl"]})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"font-bold",children:"¡GRACIAS POR SU PREFERENCIA!"}),(0,t.jsx)("p",{className:"text-[10px] mt-1",children:"Copia Cliente"})]})]})}var y=e.i(84901);let b=[{id:1,name:"Paracetamol 500mg",price:2990,stock:100,requiresPrescription:!1},{id:2,name:"Ibuprofeno 400mg",price:3490,stock:50,requiresPrescription:!1},{id:3,name:"Amoxicilina 500mg",price:5990,stock:30,requiresPrescription:!0},{id:4,name:"Loratadina 10mg",price:1990,stock:80,requiresPrescription:!1},{id:5,name:"Losartán 50mg",price:8990,stock:150,requiresPrescription:!1}];function f(){let[e,l]=(0,r.useState)(""),[m,p]=(0,r.useState)([]),[f,j]=(0,r.useState)(!1),[v,N]=(0,r.useState)(null),[w,k]=(0,r.useState)(!1),S=(e,t)=>{p(r=>r.map(r=>{if(r.id===e){let e=r.quantity+t;return e>0?{...r,quantity:e}:r}return r}))},C=m.reduce((e,t)=>e+t.price*t.quantity,0),A=async()=>{if(0!==m.length){j(!0);try{let e=m.map(e=>({nombre:e.name,cantidad:e.quantity,precio:e.price,total:e.price*e.quantity})),t=await x(C,e);N(t),k(!0),p([])}catch(e){alert("Error al procesar la venta")}finally{j(!1)}}},M=()=>{k(!1),N(null),p([])},I=b.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));return(0,t.jsx)(y.default,{allowedRoles:["ADMIN","QUIMICO","VENDEDOR"],children:(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4",children:[(0,t.jsxs)("div",{className:"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsx)("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(s.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar producto...",className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:e,onChange:e=>l(e.target.value)})]})}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:I.map(e=>(0,t.jsxs)("button",{onClick:()=>{p(t=>t.find(t=>t.id===e.id)?t.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{...e,quantity:1}])},className:"bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-all text-left group",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-900 group-hover:text-blue-600",children:e.name}),(0,t.jsxs)("div",{className:"text-gray-500 text-sm mt-1",children:["Stock: ",e.stock]}),(0,t.jsxs)("div",{className:"text-lg font-bold text-blue-600 mt-2",children:["$",e.price.toLocaleString()]}),e.requiresPrescription&&(0,t.jsx)("span",{className:"inline-block mt-2 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:"Receta"})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm h-[calc(100vh-2rem)] flex flex-col sticky top-4",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,t.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,t.jsx)(a.ShoppingCart,{className:"text-blue-600"}),"Carro de Compra"]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:0===m.length?(0,t.jsx)("div",{className:"text-center text-gray-400 py-8",children:"Carro vacío"}):m.map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["$",e.price.toLocaleString()," x ",e.quantity]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-white rounded-lg border border-gray-200",children:[(0,t.jsx)("button",{onClick:()=>S(e.id,-1),className:"p-1 hover:bg-gray-100 rounded-l-lg",children:(0,t.jsx)(u,{size:16})}),(0,t.jsx)("span",{className:"w-8 text-center text-sm",children:e.quantity}),(0,t.jsx)("button",{onClick:()=>S(e.id,1),className:"p-1 hover:bg-gray-100 rounded-r-lg",children:(0,t.jsx)(h.Plus,{size:16})})]}),(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void p(e=>e.filter(e=>e.id!==t))},className:"text-red-500 hover:text-red-700 p-1",children:(0,t.jsx)(i,{size:18})})]})]},e.id))}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-100 bg-gray-50 rounded-b-xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4 text-lg font-bold",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{children:["$",C.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,t.jsxs)("button",{className:"flex items-center justify-center gap-2 p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,t.jsx)(c,{size:20,className:"text-green-600"}),"Efectivo"]}),(0,t.jsxs)("button",{className:"flex items-center justify-center gap-2 p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,t.jsx)(n,{size:20,className:"text-blue-600"}),"Tarjeta"]})]}),(0,t.jsx)("button",{onClick:A,disabled:0===m.length||f,className:"w-full py-4 bg-blue-600 text-white rounded-xl font-bold text-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:f?"Procesando...":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{}),"Emitir Boleta"]})})]})]})]}),w&&v&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden flex flex-col max-h-[90vh]",children:[(0,t.jsxs)("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[(0,t.jsx)("h3",{className:"font-bold text-lg text-gray-800",children:"Boleta Generada"}),(0,t.jsxs)("button",{onClick:M,className:"text-gray-400 hover:text-gray-600",children:[(0,t.jsx)("span",{className:"sr-only",children:"Cerrar"}),"✕"]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-100 flex justify-center",children:(0,t.jsx)("div",{className:"shadow-lg",children:(0,t.jsx)(g,{data:v})})}),(0,t.jsxs)("div",{className:"p-4 border-t bg-white grid grid-cols-2 gap-4",children:[(0,t.jsxs)("button",{onClick:M,className:"flex items-center justify-center gap-2 px-4 py-3 border border-gray-300 rounded-xl text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(h.Plus,{size:20}),"Nueva Venta"]}),(0,t.jsxs)("button",{onClick:()=>{window.print()},className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition-colors shadow-lg shadow-blue-200",children:[(0,t.jsx)(o,{size:20}),"Imprimir"]})]})]})})]})})}e.s(["default",()=>f],55784)}]);