(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:o="",children:n,iconNode:d,...c},u)=>(0,t.createElement)("svg",{ref:u,...a,width:r,height:r,stroke:e,strokeWidth:i?24*Number(l)/Number(r):l,className:s("lucide",o),...!n&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(n)?n:[n]])),i=(e,a)=>{let i=(0,t.forwardRef)(({className:i,...o},n)=>(0,t.createElement)(l,{ref:n,iconNode:a,className:s(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...o}));return i.displayName=r(e),i};e.s(["default",()=>i],75254)},68834,79473,e=>{"use strict";var t=e.i(71645);let r=e=>{let t,r=new Set,s=(e,s)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=s?s:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,l={setState:s,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(s,a,l);return l},s=e=>{let s=e?r(e):r,a=e=>(function(e,r=e=>e){let s=t.default.useSyncExternalStore(e.subscribe,t.default.useCallback(()=>r(e.getState()),[e,r]),t.default.useCallback(()=>r(e.getInitialState()),[e,r]));return t.default.useDebugValue(s),s})(s,e);return Object.assign(a,s),a},a=e=>e?s(e):s;function l(e,t){let r;try{r=e()}catch(e){return}return{getItem:e=>{var s;let a=e=>null===e?null:JSON.parse(e,null==t?void 0:t.reviver),l=null!=(s=r.getItem(e))?s:null;return l instanceof Promise?l.then(a):a(l)},setItem:(e,s)=>r.setItem(e,JSON.stringify(s,null==t?void 0:t.replacer)),removeItem:e=>r.removeItem(e)}}e.s(["create",()=>a],68834);let i=e=>t=>{try{let r=e(t);if(r instanceof Promise)return r;return{then:e=>i(e)(r),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>i(t)(e)}}},o=(e,t)=>(r,s,a)=>{let o,n={storage:l(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},d=!1,c=new Set,u=new Set,m=n.storage;if(!m)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),r(...e)},s,a);let p=()=>{let e=n.partialize({...s()});return m.setItem(n.name,{state:e,version:n.version})},h=a.setState;a.setState=(e,t)=>(h(e,t),p());let x=e((...e)=>(r(...e),p()),s,a);a.getInitialState=()=>x;let g=()=>{var e,t;if(!m)return;d=!1,c.forEach(e=>{var t;return e(null!=(t=s())?t:x)});let a=(null==(t=n.onRehydrateStorage)?void 0:t.call(n,null!=(e=s())?e:x))||void 0;return i(m.getItem.bind(m))(n.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];else{if(n.migrate){let t=n.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;let[a,l]=e;if(r(o=n.merge(l,null!=(t=s())?t:x),!0),a)return p()}).then(()=>{null==a||a(o,void 0),o=s(),d=!0,u.forEach(e=>e(o))}).catch(e=>{null==a||a(void 0,e)})};return a.persist={setOptions:e=>{n={...n,...e},e.storage&&(m=e.storage)},clearStorage:()=>{null==m||m.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>g(),hasHydrated:()=>d,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(u.add(e),()=>{u.delete(e)})},n.skipHydration||g(),o||x};e.s(["createJSONStorage",()=>l,"persist",()=>o],79473)},18566,(e,t,r)=>{t.exports=e.r(76562)},59105,e=>{"use strict";var t=e.i(68834),r=e.i(79473);let s=(0,t.create)()((0,r.persist)(e=>({user:null,isAuthenticated:!1,role:null,login:t=>e({user:t,isAuthenticated:!0,role:t.role}),logout:()=>e({user:null,isAuthenticated:!1,role:null})}),{name:"farmacias-vallenar-auth"}));e.s(["useAuthStore",0,s])},84901,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),a=e.i(59105);function l({children:e,allowedRoles:l}){let i=(0,s.useRouter)(),{isAuthenticated:o,role:n}=(0,a.useAuthStore)(),[d,c]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{o?l&&n&&!l.includes(n)?i.push("/"):c(!0):i.push("/login")},[o,n,i,l]),d)?(0,t.jsx)(t.Fragment,{children:e}):null}e.s(["default",()=>l])},69638,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],69638)},1928,e=>{"use strict";let t=(0,e.i(75254).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);e.s(["ShoppingCart",()=>t],1928)},78894,e=>{"use strict";let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},54484,e=>{"use strict";var t=e.i(43476),r=e.i(78894),s=e.i(1928);function a({suggestions:e}){return 0===e.length?(0,t.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"mx-auto h-12 w-12 text-green-500",children:(0,t.jsx)(s.ShoppingCart,{className:"h-full w-full"})}),(0,t.jsx)("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"Sin sugerencias"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"El inventario está saludable. No se requieren compras urgentes."})]}):(0,t.jsxs)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:[(0,t.jsxs)("div",{className:"bg-red-50 px-4 py-3 border-b border-red-200 flex items-center gap-2",children:[(0,t.jsx)(r.AlertTriangle,{className:"h-5 w-5 text-red-600"}),(0,t.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Sugerencia de Compra Urgente"})]}),(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:"Producto"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Stock Actual"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Mínimo"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Sugerido"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Proveedor"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:e.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:e.nombre}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-red-600 font-bold",children:e.stock_actual}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.stock_minimo}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-blue-600 font-bold bg-blue-50",children:e.sugerencia_pedido}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.proveedor_sugerido})]},e.producto_id))})]})]})}e.s(["default",()=>a])},92719,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),a=e.i(69638),l=e.i(31278);function i({suppliers:e,products:i}){let o=(0,s.useRouter)(),[n,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),[m,p]=(0,r.useState)({proveedor_id:"",producto_id:"",cantidad:"",numero_lote:"",fecha_vencimiento:""}),h=async e=>{e.preventDefault(),d(!0);try{if(!(await fetch("/api/supply/receive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...m,producto_id:Number(m.producto_id),cantidad:Number(m.cantidad)})})).ok)throw Error("Error al recibir producto");u(!0),p({proveedor_id:"",producto_id:"",cantidad:"",numero_lote:"",fecha_vencimiento:""}),o.refresh(),setTimeout(()=>u(!1),3e3)}catch(e){console.error(e),alert("Error al guardar la recepción")}finally{d(!1)}};return(0,t.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,t.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,t.jsx)("h3",{className:"text-base font-semibold leading-6 text-gray-900",children:"Ingreso de Mercadería (Factura)"}),(0,t.jsx)("div",{className:"mt-2 max-w-xl text-sm text-gray-500",children:(0,t.jsx)("p",{children:"Registre la recepción de productos para actualizar el stock."})}),(0,t.jsxs)("form",{className:"mt-5 space-y-4",onSubmit:h,children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"proveedor",className:"block text-sm font-medium text-gray-700",children:"Proveedor"}),(0,t.jsxs)("select",{id:"proveedor",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border",value:m.proveedor_id,onChange:e=>p({...m,proveedor_id:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"Seleccione..."}),e.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre_fantasia},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"producto",className:"block text-sm font-medium text-gray-700",children:"Producto"}),(0,t.jsxs)("select",{id:"producto",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border",value:m.producto_id,onChange:e=>p({...m,producto_id:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"Seleccione..."}),i.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"cantidad",className:"block text-sm font-medium text-gray-700",children:"Cantidad"}),(0,t.jsx)("input",{type:"number",id:"cantidad",required:!0,min:"1",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border",value:m.cantidad,onChange:e=>p({...m,cantidad:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"lote",className:"block text-sm font-medium text-gray-700",children:"Nuevo Lote"}),(0,t.jsx)("input",{type:"text",id:"lote",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border",value:m.numero_lote,onChange:e=>p({...m,numero_lote:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"vencimiento",className:"block text-sm font-medium text-gray-700",children:"Vencimiento"}),(0,t.jsx)("input",{type:"date",id:"vencimiento",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border",value:m.fecha_vencimiento,onChange:e=>p({...m,fecha_vencimiento:e.target.value})})]})]}),(0,t.jsxs)("div",{className:"pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:n,className:"inline-flex justify-center rounded-md bg-purple-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-purple-600 disabled:opacity-50",children:n?(0,t.jsx)(l.Loader2,{className:"animate-spin h-5 w-5"}):"Registrar Recepción"}),c&&(0,t.jsxs)("span",{className:"ml-3 inline-flex items-center text-green-600 text-sm font-medium",children:[(0,t.jsx)(a.CheckCircle,{className:"h-5 w-5 mr-1"})," Guardado"]})]})]})]})})}e.s(["default",()=>i])}]);