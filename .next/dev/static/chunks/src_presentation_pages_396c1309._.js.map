{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/LandingPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { usePharmaStore } from '../store/useStore';\nimport { ShoppingCart, Truck, Users, Clock, Lock, ArrowRight, BarChart3, Building2, Ticket, MapPin, ScanBarcode } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { EmployeeProfile } from '../../domain/types';\n\nconst LandingPage: React.FC = () => {\n    const navigate = useNavigate();\n    const { login, logout, user, employees } = usePharmaStore();\n    const [pin, setPin] = useState('');\n    const [error, setError] = useState('');\n    const [isLoginModalOpen, setIsLoginModalOpen] = useState(false);\n    const [targetRoute, setTargetRoute] = useState('');\n    const [selectedEmployee, setSelectedEmployee] = useState<EmployeeProfile | null>(null);\n    const [step, setStep] = useState<'select' | 'pin'>('select');\n\n    // Role mapping based on which card was clicked\n    const ROUTE_TO_ROLES: Record<string, string[]> = {\n        '/dashboard': ['MANAGER'],                    // Gerencia -> Only Manager\n        '/inventory': ['MANAGER', 'QF', 'WAREHOUSE'], // Inventario -> Manager, QF, Warehouse\n        '/pos': ['CASHIER', 'QF', 'MANAGER'],        // POS -> Cashiers, QF, Manager\n        '/warehouse': ['WAREHOUSE', 'MANAGER'],       // Warehouse -> Warehouse staff, Manager\n        '/network': ['MANAGER'],                      // Network -> Only Manager\n    };\n\n    // Filter employees based on target route\n    const filteredEmployees = targetRoute && ROUTE_TO_ROLES[targetRoute]\n        ? employees.filter(emp => ROUTE_TO_ROLES[targetRoute].includes(emp.role) && emp.status === 'ACTIVE')\n        : employees.filter(emp => emp.status === 'ACTIVE');\n\n    // Security: Auto-logout when landing on this page\n    useEffect(() => {\n        logout();\n        // Sesi√≥n cerrada por seguridad al volver al inicio.\n    }, []);\n\n    // Navigate after successful login (when user state updates)\n    useEffect(() => {\n        if (user && targetRoute) {\n            navigate(targetRoute);\n            setTargetRoute(''); // Clear target route\n        }\n    }, [user, targetRoute, navigate]);\n\n    const handleCardClick = (route: string) => {\n        // ALL cards now require login for security\n        if (user) {\n            navigate(route);\n        } else {\n            setTargetRoute(route);\n            setIsLoginModalOpen(true);\n            setStep('select');\n            setSelectedEmployee(null);\n            setPin('');\n            setError('');\n        }\n    };\n\n    const handleEmployeeSelect = (employee: EmployeeProfile) => {\n        setSelectedEmployee(employee);\n        setStep('pin');\n        setError('');\n    };\n\n    const handleLogin = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!selectedEmployee) return;\n\n        if (login(selectedEmployee.id, pin)) {\n            setIsLoginModalOpen(false);\n            // Navigation will happen via useEffect when user state updates\n        } else {\n            setError('PIN Incorrecto');\n            setPin('');\n            // Shake animation will be handled by AnimatePresence\n        }\n    };\n\n    const handleBack = () => {\n        setStep('select');\n        setSelectedEmployee(null);\n        setPin('');\n        setError('');\n    };\n\n    const BentoCard = ({ title, icon: Icon, color, route, desc }: any) => (\n        <motion.div\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n            className={`relative overflow-hidden rounded-3xl p-8 cursor-pointer shadow-xl transition-all ${color} text-white group`}\n            onClick={() => handleCardClick(route)}\n        >\n            <div className=\"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity\">\n                <Icon size={120} />\n            </div>\n            <div className=\"relative z-10 flex flex-col h-full justify-between\">\n                <div>\n                    <div className=\"bg-white/20 w-12 h-12 rounded-2xl flex items-center justify-center mb-4 backdrop-blur-sm\">\n                        <Icon size={24} />\n                    </div>\n                    <h3 className=\"text-2xl font-bold mb-2\">{title}</h3>\n                    <p className=\"text-white/80 text-sm font-medium\">{desc}</p>\n                </div>\n                <div className=\"flex items-center text-sm font-bold mt-4\">\n                    ACCEDER <ArrowRight size={16} className=\"ml-2\" />\n                </div>\n            </div>\n        </motion.div>\n    );\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 flex flex-col items-center justify-center p-6\">\n            <header className=\"mb-12 text-center\">\n                <h1 className=\"text-4xl font-extrabold text-slate-900 tracking-tight mb-2\">\n                    Farmacias <span className=\"text-cyan-600\">Vallenar</span> Suit\n                </h1>\n                <p className=\"text-slate-500 font-medium\">Sistema ERP Cl√≠nico Integral v2.1</p>\n            </header>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-7xl w-full\">\n                {/* Gerencia */}\n                <BentoCard\n                    title=\"GERENCIA & BI\"\n                    icon={BarChart3}\n                    color=\"bg-gradient-to-br from-purple-600 to-pink-600\"\n                    route=\"/dashboard\"\n                    desc=\"Reportes y An√°lisis Ejecutivo\"\n                />\n\n                {/* Administraci√≥n */}\n                <BentoCard\n                    title=\"ADMINISTRACI√ìN\"\n                    icon={Building2}\n                    color=\"bg-gradient-to-br from-blue-500 to-cyan-600\"\n                    route=\"/inventory\"\n                    desc=\"Inventario y Gesti√≥n de Stock\"\n                />\n\n                {/* POS */}\n                <BentoCard\n                    title=\"Punto de Venta\"\n                    icon={ShoppingCart}\n                    color=\"bg-gradient-to-br from-emerald-500 to-teal-600\"\n                    route=\"/pos\"\n                    desc=\"Ventas, Recetas y Caja\"\n                />\n\n                {/* Log√≠stica */}\n                <BentoCard\n                    title=\"Log√≠stica\"\n                    icon={Truck}\n                    color=\"bg-gradient-to-br from-orange-400 to-red-500\"\n                    route=\"/warehouse\"\n                    desc=\"Inventario y Operaciones WMS\"\n                />\n\n                {/* Network Manager - Only for Managers */}\n                <BentoCard\n                    title=\"GESTI√ìN DE RED\"\n                    icon={MapPin}\n                    color=\"bg-gradient-to-br from-slate-700 to-slate-900\"\n                    route=\"/network\"\n                    desc=\"Sucursales, Equipos y Kioscos\"\n                />\n\n                {/* Kioscos & Terminales */}\n                <BentoCard\n                    title=\"RELOJ CONTROL\"\n                    icon={Clock}\n                    color=\"bg-amber-500\"\n                    route=\"/access\"\n                    desc=\"Modo Kiosco para asistencia y marcaje biom√©trico.\"\n                />\n\n                <BentoCard\n                    title=\"TOTEM DE FILAS\"\n                    icon={Ticket}\n                    color=\"bg-pink-500\"\n                    route=\"/queue\"\n                    desc=\"Auto-atenci√≥n de clientes y emisi√≥n de n√∫meros.\"\n                />\n\n                <BentoCard\n                    title=\"CONSULTOR DE PRECIOS\"\n                    icon={ScanBarcode}\n                    color=\"bg-indigo-600\"\n                    route=\"/price-check\"\n                    desc=\"Esc√°ner de precios para clientes\"\n                />\n            </div>\n\n            {/* Login Modal */}\n            <AnimatePresence>\n                {isLoginModalOpen && (\n                    <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n                        <motion.div\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            exit={{ opacity: 0, y: 20 }}\n                            className=\"bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md\"\n                        >\n                            {step === 'select' ? (\n                                <>\n                                    <div className=\"text-center mb-8\">\n                                        <div className=\"bg-cyan-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4\">\n                                            <Users className=\"text-cyan-700\" size={32} />\n                                        </div>\n                                        <h2 className=\"text-2xl font-bold text-slate-900\">¬øQui√©n eres?</h2>\n                                        <p className=\"text-slate-500\">Selecciona tu perfil</p>\n                                        {/* Debug Info */}\n                                        <div className=\"mt-2 text-xs text-slate-400 space-y-1\">\n                                            <p>üìä Total Empleados: {employees.length}</p>\n                                            <p>üéØ Filtrados: {filteredEmployees.length}</p>\n                                            <p>üìç Ruta: {targetRoute}</p>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"grid grid-cols-2 gap-4 mb-6\">\n                                        {filteredEmployees.length > 0 ? (\n                                            filteredEmployees.map(emp => (\n                                                <motion.button\n                                                    key={emp.id}\n                                                    whileHover={{ scale: 1.05 }}\n                                                    whileTap={{ scale: 0.95 }}\n                                                    onClick={() => handleEmployeeSelect(emp)}\n                                                    className=\"p-4 rounded-2xl border-2 border-slate-200 hover:border-cyan-500 hover:bg-cyan-50 transition-all group\"\n                                                >\n                                                    <div className=\"w-16 h-16 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center text-white font-bold text-2xl mx-auto mb-2 group-hover:scale-110 transition-transform\">\n                                                        {emp.name.charAt(0)}\n                                                    </div>\n                                                    <p className=\"font-bold text-slate-800 text-sm\">{emp.name}</p>\n                                                    <p className=\"text-xs text-slate-400\">{emp.job_title}</p>\n                                                </motion.button>\n                                            ))\n                                        ) : (\n                                            <div className=\"col-span-2 text-center py-8 text-slate-400\">\n                                                <p>No hay usuarios disponibles para este m√≥dulo</p>\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    <button\n                                        onClick={() => setIsLoginModalOpen(false)}\n                                        className=\"w-full py-3 rounded-xl font-bold text-slate-500 hover:bg-slate-100 transition\"\n                                    >\n                                        Cancelar\n                                    </button>\n                                </>\n                            ) : (\n                                <>\n                                    <div className=\"text-center mb-8\">\n                                        <div className=\"w-20 h-20 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center text-white font-bold text-3xl mx-auto mb-4\">\n                                            {selectedEmployee?.name.charAt(0)}\n                                        </div>\n                                        <h2 className=\"text-2xl font-bold text-slate-900\">{selectedEmployee?.name}</h2>\n                                        <p className=\"text-slate-500\">{selectedEmployee?.job_title}</p>\n                                    </div>\n\n                                    <form onSubmit={handleLogin} className=\"space-y-6\">\n                                        {/* Hidden username for accessibility */}\n                                        <input\n                                            type=\"text\"\n                                            name=\"username\"\n                                            autoComplete=\"username\"\n                                            className=\"hidden\"\n                                            readOnly\n                                            value={selectedEmployee?.rut || ''}\n                                        />\n\n                                        <div>\n                                            <label htmlFor=\"pin-input\" className=\"block text-center text-sm font-bold text-slate-600 mb-2\">\n                                                Ingresa tu PIN de 4 d√≠gitos\n                                            </label>\n                                            <motion.input\n                                                id=\"pin-input\"\n                                                name=\"pin_access_code\"\n                                                key={error} // This will cause re-mount and trigger animation when error changes\n                                                animate={error ? { x: [-10, 10, -10, 10, 0] } : {}}\n                                                transition={{ duration: 0.4 }}\n                                                type=\"password\"\n                                                maxLength={4}\n                                                className={`w-full text-center text-4xl tracking-[1em] font-bold py-4 border-b-4 ${error ? 'border-red-500' : 'border-slate-200'} focus:border-cyan-600 focus:outline-none transition-colors text-slate-800 placeholder-slate-300`}\n                                                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                                                value={pin}\n                                                onChange={(e) => setPin(e.target.value.replace(/\\D/g, '').slice(0, 4))}\n                                                autoFocus\n                                                autoComplete=\"new-password\"\n                                            />\n                                        </div>\n\n                                        {error && (\n                                            <motion.p\n                                                initial={{ opacity: 0 }}\n                                                animate={{ opacity: 1 }}\n                                                className=\"text-red-500 text-center font-medium\"\n                                            >\n                                                {error}\n                                            </motion.p>\n                                        )}\n\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            <button\n                                                type=\"button\"\n                                                onClick={handleBack}\n                                                className=\"py-3 rounded-xl font-bold text-slate-500 hover:bg-slate-100 transition\"\n                                            >\n                                                Atr√°s\n                                            </button>\n                                            <button\n                                                type=\"submit\"\n                                                disabled={pin.length < 4}\n                                                className=\"py-3 rounded-xl font-bold bg-cyan-600 text-white hover:bg-cyan-700 shadow-lg shadow-cyan-200 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                                            >\n                                                Ingresar\n                                            </button>\n                                        </div>\n                                    </form>\n\n                                    <div className=\"mt-8 text-center text-xs text-slate-400\">\n                                        <p>PIN Demo: Miguel (0000), Javiera (1234)</p>\n                                    </div>\n                                </>\n                            )}\n                        </motion.div>\n                    </div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n};\n\nexport default LandingPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 721, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/DashboardPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { usePharmaStore } from '../store/useStore';\nimport { ShoppingCart, Truck, Users, Clock, Lock, ArrowRight, BarChart3, Building2 } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { EmployeeProfile } from '../../domain/types';\n\nconst DashboardPage: React.FC = () => {\n    const navigate = useNavigate();\n    const { login, logout, user, employees } = usePharmaStore();\n\n    const [pin, setPin] = useState('');\n    const [error, setError] = useState('');\n    const [isLoginModalOpen, setIsLoginModalOpen] = useState(false);\n    const [targetRoute, setTargetRoute] = useState('');\n    const [selectedEmployee, setSelectedEmployee] = useState<EmployeeProfile | null>(null);\n    const [step, setStep] = useState<'select' | 'pin'>('select');\n\n    // Role mapping based on which card was clicked\n    const ROUTE_TO_ROLES: Record<string, string[]> = {\n        '/reports': ['MANAGER'],                    // Gerencia -> Only Manager\n        '/settings': ['MANAGER', 'ADMIN', 'QF'],     // Administraci√≥n -> Manager, Admin, QF\n        '/pos': ['CASHIER', 'QF', 'MANAGER'],        // POS -> Cashiers, QF, Manager\n        '/warehouse': ['WAREHOUSE', 'MANAGER'],       // Warehouse -> Warehouse staff, Manager\n    };\n\n    // Filter employees based on target route\n    const filteredEmployees = targetRoute && ROUTE_TO_ROLES[targetRoute]\n        ? employees.filter(emp => ROUTE_TO_ROLES[targetRoute].includes(emp.role) && emp.status === 'ACTIVE')\n        : employees.filter(emp => emp.status === 'ACTIVE');\n\n    // Navigate after successful login (when user state updates)\n    useEffect(() => {\n        if (user && targetRoute) {\n            navigate(targetRoute);\n            setTargetRoute(''); // Clear target route\n        }\n    }, [user, targetRoute, navigate]);\n\n    const handleCardClick = (route: string) => {\n        if (user) {\n            navigate(route);\n        } else {\n            setTargetRoute(route);\n            setIsLoginModalOpen(true);\n            setStep('select');\n            setSelectedEmployee(null);\n            setPin('');\n            setError('');\n        }\n    };\n\n    const handleEmployeeSelect = (employee: EmployeeProfile) => {\n        setSelectedEmployee(employee);\n        setStep('pin');\n        setError('');\n    };\n\n    const handleLogin = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!selectedEmployee) return;\n\n        if (login(selectedEmployee.id, pin)) {\n            setIsLoginModalOpen(false);\n            // Navigation will happen via useEffect when user state updates\n        } else {\n            setError('PIN Incorrecto');\n            setPin('');\n            // Shake animation will be handled by AnimatePresence\n        }\n    };\n\n    const handleBack = () => {\n        setStep('select');\n        setSelectedEmployee(null);\n        setPin('');\n        setError('');\n    };\n\n    const BentoCard = ({ title, icon: Icon, color, route, desc }: any) => (\n        <motion.div\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n            className={`relative overflow-hidden rounded-3xl p-8 cursor-pointer shadow-xl transition-all ${color} text-white group`}\n            onClick={() => handleCardClick(route)}\n        >\n            <div className=\"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity\">\n                <Icon size={120} />\n            </div>\n            <div className=\"relative z-10 flex flex-col h-full justify-between\">\n                <div>\n                    <div className=\"bg-white/20 w-12 h-12 rounded-2xl flex items-center justify-center mb-4 backdrop-blur-sm\">\n                        <Icon size={24} />\n                    </div>\n                    <h3 className=\"text-2xl font-bold mb-2\">{title}</h3>\n                    <p className=\"text-white/80 text-sm font-medium\">{desc}</p>\n                </div>\n                <div className=\"flex items-center text-sm font-bold mt-4\">\n                    ACCEDER <ArrowRight size={16} className=\"ml-2\" />\n                </div>\n            </div>\n        </motion.div>\n    );\n\n    return (\n        <div className=\"min-h-screen bg-slate-50 flex flex-col items-center justify-center p-6\">\n            <header className=\"mb-12 text-center\">\n                <h1 className=\"text-4xl font-extrabold text-slate-900 tracking-tight mb-2\">\n                    Farmacias <span className=\"text-cyan-600\">Vallenar</span> Suit\n                </h1>\n                <p className=\"text-slate-500 font-medium\">Sistema ERP Cl√≠nico Integral v2.1</p>\n            </header>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-7xl w-full\">\n                {/* Gerencia */}\n                <BentoCard\n                    title=\"GERENCIA & BI\"\n                    icon={BarChart3}\n                    color=\"bg-gradient-to-br from-purple-600 to-pink-600\"\n                    route=\"/reports\"\n                    desc=\"Reportes y An√°lisis Ejecutivo\"\n                />\n\n                {/* Administraci√≥n */}\n                <BentoCard\n                    title=\"ADMINISTRACI√ìN\"\n                    icon={Building2}\n                    color=\"bg-gradient-to-br from-blue-500 to-cyan-600\"\n                    route=\"/settings\"\n                    desc=\"Configuraci√≥n y Gesti√≥n\"\n                />\n\n                {/* POS */}\n                <BentoCard\n                    title=\"Punto de Venta\"\n                    icon={ShoppingCart}\n                    color=\"bg-gradient-to-br from-emerald-500 to-teal-600\"\n                    route=\"/pos\"\n                    desc=\"Ventas, Recetas y Caja\"\n                />\n\n                {/* Log√≠stica */}\n                <BentoCard\n                    title=\"Log√≠stica\"\n                    icon={Truck}\n                    color=\"bg-gradient-to-br from-orange-400 to-red-500\"\n                    route=\"/warehouse\"\n                    desc=\"Inventario y Operaciones WMS\"\n                />\n            </div>\n\n            {/* Login Modal */}\n            <AnimatePresence>\n                {isLoginModalOpen && (\n                    <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n                        <motion.div\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            exit={{ opacity: 0, y: 20 }}\n                            className=\"bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md\"\n                        >\n                            {step === 'select' ? (\n                                <>\n                                    <div className=\"text-center mb-8\">\n                                        <div className=\"bg-cyan-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4\">\n                                            <Users className=\"text-cyan-700\" size={32} />\n                                        </div>\n                                        <h2 className=\"text-2xl font-bold text-slate-900\">¬øQui√©n eres?</h2>\n                                        <p className=\"text-slate-500\">Selecciona tu perfil</p>\n                                        {/* Debug Info */}\n                                        <div className=\"mt-2 text-xs text-slate-400 space-y-1\">\n                                            <p>üìä Total Empleados: {employees.length}</p>\n                                            <p>üéØ Filtrados: {filteredEmployees.length}</p>\n                                            <p>üìç Ruta: {targetRoute}</p>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"grid grid-cols-2 gap-4 mb-6\">\n                                        {filteredEmployees.length > 0 ? (\n                                            filteredEmployees.map(emp => (\n                                                <motion.button\n                                                    key={emp.id}\n                                                    whileHover={{ scale: 1.05 }}\n                                                    whileTap={{ scale: 0.95 }}\n                                                    onClick={() => handleEmployeeSelect(emp)}\n                                                    className=\"p-4 rounded-2xl border-2 border-slate-200 hover:border-cyan-500 hover:bg-cyan-50 transition-all group\"\n                                                >\n                                                    <div className=\"w-16 h-16 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center text-white font-bold text-2xl mx-auto mb-2 group-hover:scale-110 transition-transform\">\n                                                        {emp.name.charAt(0)}\n                                                    </div>\n                                                    <p className=\"font-bold text-slate-800 text-sm\">{emp.name}</p>\n                                                    <p className=\"text-xs text-slate-400\">{emp.job_title}</p>\n                                                </motion.button>\n                                            ))\n                                        ) : (\n                                            <div className=\"col-span-2 text-center py-8 text-slate-400\">\n                                                <p>No hay usuarios disponibles para este m√≥dulo</p>\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    <button\n                                        onClick={() => setIsLoginModalOpen(false)}\n                                        className=\"w-full py-3 rounded-xl font-bold text-slate-500 hover:bg-slate-100 transition\"\n                                    >\n                                        Cancelar\n                                    </button>\n                                </>\n                            ) : (\n                                <>\n                                    <div className=\"text-center mb-8\">\n                                        <div className=\"w-20 h-20 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center text-white font-bold text-3xl mx-auto mb-4\">\n                                            {selectedEmployee?.name.charAt(0)}\n                                        </div>\n                                        <h2 className=\"text-2xl font-bold text-slate-900\">{selectedEmployee?.name}</h2>\n                                        <p className=\"text-slate-500\">{selectedEmployee?.job_title}</p>\n                                    </div>\n\n                                    <form onSubmit={handleLogin} className=\"space-y-6\">\n                                        {/* Hidden username for accessibility */}\n                                        <input\n                                            type=\"text\"\n                                            name=\"username\"\n                                            autoComplete=\"username\"\n                                            className=\"hidden\"\n                                            readOnly\n                                            value={selectedEmployee?.rut || ''}\n                                        />\n\n                                        <div>\n                                            <label htmlFor=\"dashboard-pin-input\" className=\"block text-center text-sm font-bold text-slate-600 mb-2\">\n                                                Ingresa tu PIN de 4 d√≠gitos\n                                            </label>\n                                            <motion.input\n                                                id=\"dashboard-pin-input\"\n                                                name=\"pin\"\n                                                key={error} // This will cause re-mount and trigger animation when error changes\n                                                animate={error ? { x: [-10, 10, -10, 10, 0] } : {}}\n                                                transition={{ duration: 0.4 }}\n                                                type=\"password\"\n                                                maxLength={4}\n                                                className={`w-full text-center text-4xl tracking-[1em] font-bold py-4 border-b-4 ${error ? 'border-red-500' : 'border-slate-200'} focus:border-cyan-600 focus:outline-none transition-colors text-slate-800 placeholder-slate-300`}\n                                                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                                                value={pin}\n                                                onChange={(e) => {\n                                                    setPin(e.target.value);\n                                                    setError('');\n                                                }}\n                                                autoFocus\n                                                autoComplete=\"new-password\"\n                                            />\n                                        </div>\n\n                                        {error && (\n                                            <motion.p\n                                                initial={{ opacity: 0 }}\n                                                animate={{ opacity: 1 }}\n                                                className=\"text-red-500 text-center font-medium\"\n                                            >\n                                                {error}\n                                            </motion.p>\n                                        )}\n\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            <button\n                                                type=\"button\"\n                                                onClick={handleBack}\n                                                className=\"py-3 rounded-xl font-bold text-slate-500 hover:bg-slate-100 transition\"\n                                            >\n                                                Atr√°s\n                                            </button>\n                                            <button\n                                                type=\"submit\"\n                                                disabled={pin.length < 4}\n                                                className=\"py-3 rounded-xl font-bold bg-cyan-600 text-white hover:bg-cyan-700 shadow-lg shadow-cyan-200 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                                            >\n                                                Ingresar\n                                            </button>\n                                        </div>\n                                    </form>\n\n                                    <div className=\"mt-8 text-center text-xs text-slate-400\">\n                                        <p>PIN Demo: Miguel (0000), Javiera (1234)</p>\n                                    </div>\n                                </>\n                            )}\n                        </motion.div>\n                    </div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n};\n\nexport default DashboardPage;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;;;;;;;;AAGA,MAAM,gBAA0B;;IAC5B,MAAM,WAAW,IAAA,8LAAW;IAC5B,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,IAAA,6JAAc;IAEzD,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAC;IAC/B,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAyB;IACjF,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAmB;IAEnD,+CAA+C;IAC/C,MAAM,iBAA2C;QAC7C,YAAY;YAAC;SAAU;QACvB,aAAa;YAAC;YAAW;YAAS;SAAK;QACvC,QAAQ;YAAC;YAAW;YAAM;SAAU;QACpC,cAAc;YAAC;YAAa;SAAU;IAC1C;IAEA,yCAAyC;IACzC,MAAM,oBAAoB,eAAe,cAAc,CAAC,YAAY,GAC9D,UAAU,MAAM,CAAC,CAAA,MAAO,cAAc,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,IAAI,MAAM,KAAK,YACzF,UAAU,MAAM,CAAC,CAAA,MAAO,IAAI,MAAM,KAAK;IAE7C,4DAA4D;IAC5D,IAAA,0KAAS;mCAAC;YACN,IAAI,QAAQ,aAAa;gBACrB,SAAS;gBACT,eAAe,KAAK,qBAAqB;YAC7C;QACJ;kCAAG;QAAC;QAAM;QAAa;KAAS;IAEhC,MAAM,kBAAkB,CAAC;QACrB,IAAI,MAAM;YACN,SAAS;QACb,OAAO;YACH,eAAe;YACf,oBAAoB;YACpB,QAAQ;YACR,oBAAoB;YACpB,OAAO;YACP,SAAS;QACb;IACJ;IAEA,MAAM,uBAAuB,CAAC;QAC1B,oBAAoB;QACpB,QAAQ;QACR,SAAS;IACb;IAEA,MAAM,cAAc,CAAC;QACjB,EAAE,cAAc;QAChB,IAAI,CAAC,kBAAkB;QAEvB,IAAI,MAAM,iBAAiB,EAAE,EAAE,MAAM;YACjC,oBAAoB;QACpB,+DAA+D;QACnE,OAAO;YACH,SAAS;YACT,OAAO;QACP,qDAAqD;QACzD;IACJ;IAEA,MAAM,aAAa;QACf,QAAQ;QACR,oBAAoB;QACpB,OAAO;QACP,SAAS;IACb;IAEA,MAAM,YAAY,CAAC,EAAE,KAAK,EAAE,MAAM,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAO,iBAC7D,6LAAC,uMAAM,CAAC,GAAG;YACP,YAAY;gBAAE,OAAO;YAAK;YAC1B,UAAU;gBAAE,OAAO;YAAK;YACxB,WAAW,CAAC,iFAAiF,EAAE,MAAM,iBAAiB,CAAC;YACvH,SAAS,IAAM,gBAAgB;;8BAE/B,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC;wBAAK,MAAM;;;;;;;;;;;8BAEhB,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;;8CACG,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC;wCAAK,MAAM;;;;;;;;;;;8CAEhB,6LAAC;oCAAG,WAAU;8CAA2B;;;;;;8CACzC,6LAAC;oCAAE,WAAU;8CAAqC;;;;;;;;;;;;sCAEtD,6LAAC;4BAAI,WAAU;;gCAA2C;8CAC9C,6LAAC,mOAAU;oCAAC,MAAM;oCAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;;;IAMxD,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAO,WAAU;;kCACd,6LAAC;wBAAG,WAAU;;4BAA6D;0CAC7D,6LAAC;gCAAK,WAAU;0CAAgB;;;;;;4BAAe;;;;;;;kCAE7D,6LAAC;wBAAE,WAAU;kCAA6B;;;;;;;;;;;;0BAG9C,6LAAC;gBAAI,WAAU;;kCAEX,6LAAC;wBACG,OAAM;wBACN,MAAM,kOAAS;wBACf,OAAM;wBACN,OAAM;wBACN,MAAK;;;;;;kCAIT,6LAAC;wBACG,OAAM;wBACN,MAAM,gOAAS;wBACf,OAAM;wBACN,OAAM;wBACN,MAAK;;;;;;kCAIT,6LAAC;wBACG,OAAM;wBACN,MAAM,yOAAY;wBAClB,OAAM;wBACN,OAAM;wBACN,MAAK;;;;;;kCAIT,6LAAC;wBACG,OAAM;wBACN,MAAM,gNAAK;wBACX,OAAM;wBACN,OAAM;wBACN,MAAK;;;;;;;;;;;;0BAKb,6LAAC,+MAAe;0BACX,kCACG,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC,uMAAM,CAAC,GAAG;wBACP,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAG;wBAC7B,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAE;wBAC5B,MAAM;4BAAE,SAAS;4BAAG,GAAG;wBAAG;wBAC1B,WAAU;kCAET,SAAS,yBACN;;8CACI,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAI,WAAU;sDACX,cAAA,6LAAC,gNAAK;gDAAC,WAAU;gDAAgB,MAAM;;;;;;;;;;;sDAE3C,6LAAC;4CAAG,WAAU;sDAAoC;;;;;;sDAClD,6LAAC;4CAAE,WAAU;sDAAiB;;;;;;sDAE9B,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;;wDAAE;wDAAqB,UAAU,MAAM;;;;;;;8DACxC,6LAAC;;wDAAE;wDAAe,kBAAkB,MAAM;;;;;;;8DAC1C,6LAAC;;wDAAE;wDAAU;;;;;;;;;;;;;;;;;;;8CAIrB,6LAAC;oCAAI,WAAU;8CACV,kBAAkB,MAAM,GAAG,IACxB,kBAAkB,GAAG,CAAC,CAAA,oBAClB,6LAAC,uMAAM,CAAC,MAAM;4CAEV,YAAY;gDAAE,OAAO;4CAAK;4CAC1B,UAAU;gDAAE,OAAO;4CAAK;4CACxB,SAAS,IAAM,qBAAqB;4CACpC,WAAU;;8DAEV,6LAAC;oDAAI,WAAU;8DACV,IAAI,IAAI,CAAC,MAAM,CAAC;;;;;;8DAErB,6LAAC;oDAAE,WAAU;8DAAoC,IAAI,IAAI;;;;;;8DACzD,6LAAC;oDAAE,WAAU;8DAA0B,IAAI,SAAS;;;;;;;2CAV/C,IAAI,EAAE;;;;sGAcnB,6LAAC;wCAAI,WAAU;kDACX,cAAA,6LAAC;sDAAE;;;;;;;;;;;;;;;;8CAKf,6LAAC;oCACG,SAAS,IAAM,oBAAoB;oCACnC,WAAU;8CACb;;;;;;;yDAKL;;8CACI,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAI,WAAU;sDACV,kBAAkB,KAAK,OAAO;;;;;;sDAEnC,6LAAC;4CAAG,WAAU;sDAAqC,kBAAkB;;;;;;sDACrE,6LAAC;4CAAE,WAAU;sDAAkB,kBAAkB;;;;;;;;;;;;8CAGrD,6LAAC;oCAAK,UAAU;oCAAa,WAAU;;sDAEnC,6LAAC;4CACG,MAAK;4CACL,MAAK;4CACL,cAAa;4CACb,WAAU;4CACV,QAAQ;4CACR,OAAO,kBAAkB,OAAO;;;;;;sDAGpC,6LAAC;;8DACG,6LAAC;oDAAM,SAAQ;oDAAsB,WAAU;8DAA0D;;;;;;8DAGzG,6LAAC,uMAAM,CAAC,KAAK;oDACT,IAAG;oDACH,MAAK;oDAEL,SAAS,QAAQ;wDAAE,GAAG;4DAAC,CAAC;4DAAI;4DAAI,CAAC;4DAAI;4DAAI;yDAAE;oDAAC,IAAI,CAAC;oDACjD,YAAY;wDAAE,UAAU;oDAAI;oDAC5B,MAAK;oDACL,WAAW;oDACX,WAAW,CAAC,qEAAqE,EAAE,QAAQ,mBAAmB,mBAAmB,gGAAgG,CAAC;oDAClO,aAAY;oDACZ,OAAO;oDACP,UAAU,CAAC;wDACP,OAAO,EAAE,MAAM,CAAC,KAAK;wDACrB,SAAS;oDACb;oDACA,SAAS;oDACT,cAAa;mDAbR;;;;;;;;;;;wCAiBZ,uBACG,6LAAC,uMAAM,CAAC,CAAC;4CACL,SAAS;gDAAE,SAAS;4CAAE;4CACtB,SAAS;gDAAE,SAAS;4CAAE;4CACtB,WAAU;sDAET;;;;;;sDAIT,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;oDACG,MAAK;oDACL,SAAS;oDACT,WAAU;8DACb;;;;;;8DAGD,6LAAC;oDACG,MAAK;oDACL,UAAU,IAAI,MAAM,GAAG;oDACvB,WAAU;8DACb;;;;;;;;;;;;;;;;;;8CAMT,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC;kDAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAU3C;GA7RM;;QACe,8LAAW;QACe,6JAAc;;;KAFvD;uCA+RS"}},
    {"offset": {"line": 1382, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/SupplyChainPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { usePharmaStore } from '../store/useStore';\nimport { PurchasingAgent } from '../../domain/logic/purchasingAgent';\nimport { Package, Truck, CheckCircle, AlertCircle, Plus, Calendar, TrendingUp, Save, RefreshCw, AlertTriangle } from 'lucide-react';\nimport BlindReceptionModal from '../components/scm/BlindReceptionModal';\nimport ManualOrderModal from '../components/supply/ManualOrderModal';\nimport { useNotificationStore } from '../store/useNotificationStore';\nimport { toast } from 'sonner';\n\ntype AnalysisPeriod = 'LAST_7_DAYS' | 'LAST_30_DAYS' | 'LAST_TRIMESTER' | 'LAST_SEMESTER' | 'LAST_YEAR';\n\nconst SupplyChainPage: React.FC = () => {\n    const { inventory, suppliers, purchaseOrders, addPurchaseOrder, receivePurchaseOrder } = usePharmaStore();\n    const { pushNotification } = useNotificationStore();\n\n    const [isReceptionModalOpen, setIsReceptionModalOpen] = useState(false);\n    const [isManualOrderModalOpen, setIsManualOrderModalOpen] = useState(false);\n    const [selectedOrder, setSelectedOrder] = useState<any>(null);\n\n    // Predictive State\n    const [analysisPeriod, setAnalysisPeriod] = useState<AnalysisPeriod>('LAST_30_DAYS');\n    const [suggestedItems, setSuggestedItems] = useState<any[]>([]);\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\n\n    // Initial Analysis & Alert\n    useEffect(() => {\n        runAnalysis();\n    }, [analysisPeriod]);\n\n    const runAnalysis = () => {\n        setIsAnalyzing(true);\n        setTimeout(() => {\n            const suggestions = PurchasingAgent.generateSuggestions(inventory, suppliers, analysisPeriod);\n\n            // Flatten suggestions for the editable table\n            const flatItems = suggestions.flatMap(po =>\n                po.items.map(item => ({\n                    ...item,\n                    supplier_id: po.supplier_id,\n                    supplier_name: suppliers.find(s => s.id === po.supplier_id)?.fantasy_name || 'Desconocido'\n                }))\n            );\n\n            setSuggestedItems(flatItems);\n            setIsAnalyzing(false);\n\n            // Check for critical stock to trigger notification\n            const criticalCount = flatItems.filter(i => (i as any).status === 'CRITICAL').length;\n            if (criticalCount > 0) {\n                pushNotification({\n                    title: 'Stock Cr√≠tico Detectado',\n                    message: `La IA ha detectado ${criticalCount} productos en nivel cr√≠tico. Revise el abastecimiento.`,\n                    type: 'CRITICAL',\n                    roleTarget: 'MANAGER'\n                });\n            }\n        }, 600); // Fake delay for \"AI Processing\" effect\n    };\n\n    const updateQuantity = (sku: string, newQty: number) => {\n        setSuggestedItems(items =>\n            items.map(item => item.sku === sku ? { ...item, quantity: newQty } : item)\n        );\n    };\n\n    const generateOrders = () => {\n        if (suggestedItems.length === 0) return;\n\n        // Group back by supplier\n        const ordersBySupplier: { [key: string]: any[] } = {};\n        suggestedItems.forEach(item => {\n            if (!ordersBySupplier[item.supplier_id]) {\n                ordersBySupplier[item.supplier_id] = [];\n            }\n            ordersBySupplier[item.supplier_id].push(item);\n        });\n\n        // Create Purchase Orders\n        Object.keys(ordersBySupplier).forEach(supplierId => {\n            const items = ordersBySupplier[supplierId];\n            addPurchaseOrder({\n                id: `PO-${Date.now()}-${supplierId.substring(0, 3)}`,\n                supplier_id: supplierId,\n                created_at: Date.now(),\n                status: 'DRAFT',\n                items: items.map(i => ({\n                    sku: i.sku,\n                    name: i.name,\n                    quantity: i.quantity,\n                    cost_price: i.cost_price\n                })),\n                total_estimated: items.reduce((acc, i) => acc + (i.cost_price * i.quantity), 0)\n            });\n        });\n\n        toast.success(`${Object.keys(ordersBySupplier).length} √ìrdenes Generadas`);\n        setSuggestedItems([]); // Clear suggestions\n    };\n\n    const KanbanColumn = ({ title, status, color, icon: Icon }: any) => {\n        const orders = purchaseOrders.filter(po => po.status === status);\n\n        return (\n            <div className=\"flex-1 min-w-[300px] bg-slate-100 rounded-3xl p-4 flex flex-col h-full\">\n                <div className={`flex items-center gap-2 mb-4 px-2 ${color}`}>\n                    <Icon size={20} />\n                    <h3 className=\"font-bold text-slate-700\">{title}</h3>\n                    <span className=\"ml-auto bg-white/50 px-2 py-1 rounded-full text-xs font-bold\">{orders.length}</span>\n                </div>\n\n                <div className=\"flex-1 overflow-y-auto space-y-3\">\n                    {orders.map(po => (\n                        <div key={po.id} className=\"bg-white p-4 rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition-all cursor-pointer\">\n                            <div className=\"flex justify-between items-start mb-2\">\n                                <span className=\"text-xs font-mono text-slate-400\">{po.id}</span>\n                                <span className=\"text-xs font-bold text-slate-600\">{new Date(po.created_at).toLocaleDateString()}</span>\n                            </div>\n                            <h4 className=\"font-bold text-slate-800 mb-1\">{suppliers.find(s => s.id === po.supplier_id)?.fantasy_name || 'Proveedor Desconocido'}</h4>\n                            <p className=\"text-sm text-slate-500 mb-3\">{po.items.length} Items</p>\n\n                            {status === 'SENT' && (\n                                <button\n                                    onClick={() => { setSelectedOrder(po); setIsReceptionModalOpen(true); }}\n                                    className=\"w-full py-2 bg-blue-600 text-white rounded-lg text-xs font-bold hover:bg-blue-700 transition\"\n                                >\n                                    RECEPCIONAR\n                                </button>\n                            )}\n                        </div>\n                    ))}\n                </div>\n            </div>\n        );\n    };\n\n    return (\n        <div className=\"h-screen p-6 bg-slate-50 flex flex-col overflow-hidden\">\n            <header className=\"mb-8 flex justify-between items-center flex-shrink-0\">\n                <div>\n                    <h1 className=\"text-3xl font-extrabold text-slate-900 flex items-center gap-3\">\n                        <Truck className=\"text-cyan-600\" /> Cadena de Suministro\n                    </h1>\n                    <p className=\"text-slate-500\">Gesti√≥n Inteligente de Abastecimiento</p>\n                </div>\n                <div className=\"flex gap-3\">\n                    <button\n                        onClick={() => setIsManualOrderModalOpen(true)}\n                        className=\"flex items-center gap-2 px-6 py-3 bg-white text-slate-700 border border-slate-200 rounded-xl font-bold hover:bg-slate-50 transition\"\n                    >\n                        <Plus size={20} /> Nueva Orden Manual\n                    </button>\n                </div>\n            </header>\n\n            <div className=\"flex-1 flex gap-6 overflow-hidden\">\n                {/* Left: Predictive Analysis */}\n                <div className=\"flex-[2] bg-white rounded-3xl shadow-sm border border-slate-200 flex flex-col overflow-hidden\">\n                    <div className=\"p-6 border-b border-slate-100 flex justify-between items-center\">\n                        <div className=\"flex items-center gap-3\">\n                            <div className=\"p-2 bg-purple-100 text-purple-600 rounded-lg\">\n                                <TrendingUp size={24} />\n                            </div>\n                            <div>\n                                <h2 className=\"text-xl font-bold text-slate-800\">Predicci√≥n de Demanda</h2>\n                                <p className=\"text-xs text-slate-500\">IA basada en historial de ventas</p>\n                            </div>\n                        </div>\n\n                        <div className=\"flex items-center gap-2 bg-slate-50 p-1 rounded-xl border border-slate-200\">\n                            <Calendar size={16} className=\"text-slate-400 ml-2\" />\n                            <select\n                                className=\"bg-transparent text-sm font-bold text-slate-700 p-2 outline-none cursor-pointer\"\n                                value={analysisPeriod}\n                                onChange={(e) => setAnalysisPeriod(e.target.value as AnalysisPeriod)}\n                            >\n                                <option value=\"LAST_7_DAYS\">Tendencia Corta (7 d√≠as)</option>\n                                <option value=\"LAST_30_DAYS\">Tendencia Media (30 d√≠as)</option>\n                                <option value=\"LAST_TRIMESTER\">Tendencia Larga (Trimestre)</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <div className=\"flex-1 overflow-y-auto p-0\">\n                        {isAnalyzing ? (\n                            <div className=\"h-full flex flex-col items-center justify-center text-slate-400\">\n                                <RefreshCw className=\"animate-spin mb-4\" size={48} />\n                                <p>Analizando patrones de consumo...</p>\n                            </div>\n                        ) : suggestedItems.length === 0 ? (\n                            <div className=\"h-full flex flex-col items-center justify-center text-slate-400\">\n                                <CheckCircle className=\"mb-4 text-emerald-200\" size={64} />\n                                <p>Todo en orden. No se requieren compras urgentes.</p>\n                            </div>\n                        ) : (\n                            <table className=\"w-full text-left\">\n                                <thead className=\"bg-slate-50 text-slate-500 font-bold text-xs uppercase sticky top-0 z-10\">\n                                    <tr>\n                                        <th className=\"p-4\">Producto</th>\n                                        <th className=\"p-4\">Stock</th>\n                                        <th className=\"p-4\">Venta (30d)</th>\n                                        <th className=\"p-4\">Cobertura</th>\n                                        <th className=\"p-4\">Sugerencia</th>\n                                        <th className=\"p-4 text-center\">Acci√≥n</th>\n                                    </tr>\n                                </thead>\n                                <tbody className=\"divide-y divide-slate-100 text-sm\">\n                                    {suggestedItems.map((item, idx) => (\n                                        <tr key={`${item.sku}-${idx}`} className=\"hover:bg-slate-50 transition\">\n                                            <td className=\"p-4\">\n                                                <div className=\"font-bold text-slate-800\">{item.name}</div>\n                                                <div className=\"text-xs text-slate-400 font-mono\">{item.sku}</div>\n                                            </td>\n                                            <td className=\"p-4\">\n                                                <div className=\"font-bold text-slate-800\">{item.current_stock} un.</div>\n                                            </td>\n                                            <td className=\"p-4 text-slate-500\">\n                                                {(parseFloat(item.velocity) * 30).toFixed(0)} un/mes\n                                            </td>\n                                            <td className=\"p-4\">\n                                                <div className=\"flex items-center gap-2\">\n                                                    <span className={`w-2 h-2 rounded-full ${item.status === 'CRITICAL' ? 'bg-red-500' :\n                                                        item.status === 'LOW' ? 'bg-amber-500' :\n                                                            item.status === 'EXCESS' ? 'bg-emerald-500' : 'bg-slate-300'\n                                                        }`} />\n                                                    <span className={`font-bold ${item.status === 'CRITICAL' ? 'text-red-600' :\n                                                        item.status === 'LOW' ? 'text-amber-600' :\n                                                            item.status === 'EXCESS' ? 'text-emerald-600' : 'text-slate-600'\n                                                        }`}>\n                                                        {item.coverage > 900 ? '‚àû' : item.coverage} d√≠as\n                                                    </span>\n                                                </div>\n                                            </td>\n                                            <td className=\"p-4\">\n                                                <div className=\"flex items-center gap-2\">\n                                                    <input\n                                                        type=\"number\"\n                                                        className={`w-20 p-2 border rounded-lg font-bold text-center focus:outline-none ${item.quantity > 0 ? 'border-purple-300 bg-purple-50 text-purple-700' : 'border-slate-200 text-slate-400'\n                                                            }`}\n                                                        value={item.quantity}\n                                                        onChange={(e) => updateQuantity(item.sku, parseInt(e.target.value))}\n                                                    />\n                                                    <span className=\"text-xs text-slate-400\">cajas</span>\n                                                </div>\n                                            </td>\n                                            <td className=\"p-4 text-center\">\n                                                <button\n                                                    onClick={() => setSuggestedItems(items => items.filter(i => i.sku !== item.sku))}\n                                                    className=\"text-slate-400 hover:text-red-500 transition\"\n                                                >\n                                                    <AlertTriangle size={16} />\n                                                </button>\n                                            </td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        )}\n                    </div>\n\n                    {suggestedItems.length > 0 && (\n                        <div className=\"p-4 border-t border-slate-100 bg-slate-50 flex justify-between items-center\">\n                            <p className=\"text-sm text-slate-500\">\n                                Se generar√°n <strong>{new Set(suggestedItems.map(i => i.supplier_id)).size}</strong> √≥rdenes de compra.\n                            </p>\n                            <div className=\"flex gap-3\">\n                                <button\n                                    onClick={generateOrders}\n                                    disabled={suggestedItems.length === 0}\n                                    className=\"px-4 py-2 bg-cyan-600 text-white rounded-xl font-bold hover:bg-cyan-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg shadow-cyan-200\"\n                                >\n                                    <RefreshCw size={18} /> Generar √ìrdenes (IA)\n                                </button>\n                                <button\n                                    onClick={() => setIsManualOrderModalOpen(true)}\n                                    className=\"px-4 py-2 bg-slate-800 text-white rounded-xl font-bold hover:bg-slate-700 transition flex items-center gap-2\"\n                                >\n                                    <Plus size={18} /> Nueva Orden Manual\n                                </button>\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                {/* Right: Kanban Status */}\n                <div className=\"flex-1 flex flex-col gap-4 overflow-hidden\">\n                    <KanbanColumn title=\"Borrador\" status=\"DRAFT\" color=\"text-slate-600\" icon={Package} />\n                    <KanbanColumn title=\"Enviado\" status=\"SENT\" color=\"text-blue-600\" icon={Truck} />\n                </div>\n            </div>\n\n            {isReceptionModalOpen && (\n                <BlindReceptionModal\n                    isOpen={isReceptionModalOpen}\n                    onClose={() => setIsReceptionModalOpen(false)}\n                    order={selectedOrder}\n                    onReceive={(order, items) => {\n                        receivePurchaseOrder(order.id, items.map(i => ({ sku: i.sku, received_qty: i.receivedQty })));\n                        setIsReceptionModalOpen(false);\n                    }}\n                />\n            )}\n\n            <ManualOrderModal\n                isOpen={isManualOrderModalOpen}\n                onClose={() => setIsManualOrderModalOpen(false)}\n            />\n        </div>\n    );\n};\n\nexport default SupplyChainPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2238, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/QueueKioskPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { usePharmaStore } from '../store/useStore';\nimport { Ticket, User, ArrowRight, UserPlus, Settings, Printer } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { PrinterService } from '../../domain/services/PrinterService';\n\nconst QueueKioskPage: React.FC = () => {\n    const { generateTicket, customers, addCustomer, printerConfig } = usePharmaStore();\n    const [rut, setRut] = useState('');\n    const [name, setName] = useState('');\n    const [step, setStep] = useState<'SETUP' | 'RUT' | 'NAME' | 'TICKET'>('RUT');\n    const [ticket, setTicket] = useState<any>(null);\n    const [customerName, setCustomerName] = useState('');\n    const [branchId, setBranchId] = useState('');\n\n    // Load Branch Config\n    useEffect(() => {\n        const storedBranch = localStorage.getItem('kiosk_branch_id');\n        if (storedBranch) {\n            setBranchId(storedBranch);\n            setStep('RUT');\n        } else {\n            setStep('SETUP');\n        }\n    }, []);\n\n    const handleSetup = (selectedBranch: string) => {\n        localStorage.setItem('kiosk_branch_id', selectedBranch);\n        setBranchId(selectedBranch);\n        setStep('RUT');\n    };\n\n    const handleNumberClick = (num: string) => {\n        if (rut.length < 12) {\n            const raw = rut.replace(/[^0-9kK]/g, '') + num;\n            setRut(formatRut(raw));\n        }\n    };\n\n    const formatRut = (value: string) => {\n        const clean = value.replace(/[^0-9kK]/g, '');\n        if (clean.length <= 1) return clean;\n        const body = clean.slice(0, -1);\n        const dv = clean.slice(-1).toUpperCase();\n        let formattedBody = '';\n        for (let i = body.length - 1, j = 0; i >= 0; i--, j++) {\n            formattedBody = body.charAt(i) + (j > 0 && j % 3 === 0 ? '.' : '') + formattedBody;\n        }\n        return `${formattedBody}-${dv}`;\n    };\n\n    const handleRutSubmit = () => {\n        if (rut.length < 8) return;\n\n        const existingCustomer = customers.find(c => c.rut === rut);\n\n        if (existingCustomer) {\n            setCustomerName(existingCustomer.fullName);\n            generateAndPrintTicket(rut);\n        } else {\n            setStep('NAME'); // Ask for name to register\n        }\n    };\n\n    const handleRegisterAndTicket = () => {\n        if (!name) return;\n\n        // Register new customer\n        addCustomer({\n            rut,\n            fullName: name,\n            registrationSource: 'KIOSK'\n        });\n\n        setCustomerName(name);\n        generateAndPrintTicket(rut);\n    };\n\n    const handleSkipRegister = () => {\n        generateAndPrintTicket('ANON');\n    };\n\n    const generateAndPrintTicket = (userRut: string) => {\n        const newTicket = generateTicket(userRut, branchId);\n        setTicket(newTicket);\n        setStep('TICKET');\n\n        // Trigger Auto-Print\n        PrinterService.printQueueTicket(newTicket, printerConfig);\n    };\n\n    const reset = () => {\n        setRut('');\n        setName('');\n        setStep('RUT');\n        setTicket(null);\n        setCustomerName('');\n    };\n\n    return (\n        <div className=\"min-h-screen bg-slate-900 flex flex-col items-center justify-center p-8 relative overflow-hidden\">\n            {/* Background Decoration */}\n            <div className=\"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none\">\n                <div className=\"absolute top-[-10%] right-[-10%] w-[500px] h-[500px] bg-cyan-500/20 rounded-full blur-3xl\" />\n                <div className=\"absolute bottom-[-10%] left-[-10%] w-[500px] h-[500px] bg-blue-600/20 rounded-full blur-3xl\" />\n            </div>\n\n            <div className=\"z-10 w-full max-w-2xl\">\n                <header className=\"text-center mb-12\">\n                    <h1 className=\"text-5xl font-extrabold text-white mb-4 tracking-tight\">Bienvenido</h1>\n                    <p className=\"text-slate-400 text-xl\">Farmacias Vallenar Suit</p>\n                    {branchId && <p className=\"text-cyan-500 text-sm mt-2 font-mono\">Terminal: {branchId}</p>}\n                </header>\n\n                <AnimatePresence mode=\"wait\">\n                    {step === 'SETUP' && (\n                        <motion.div\n                            key=\"setup\"\n                            initial={{ opacity: 0, scale: 0.9 }}\n                            animate={{ opacity: 1, scale: 1 }}\n                            className=\"bg-white/10 backdrop-blur-lg rounded-[3rem] p-8 border border-white/10 shadow-2xl text-center\"\n                        >\n                            <div className=\"mb-8\">\n                                <div className=\"w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-400\">\n                                    <Settings size={40} />\n                                </div>\n                                <h2 className=\"text-3xl font-bold text-white mb-2\">Configuraci√≥n Inicial</h2>\n                                <p className=\"text-slate-400\">Selecciona la sucursal para este Totem</p>\n                            </div>\n\n                            <div className=\"grid grid-cols-1 gap-4\">\n                                <button\n                                    onClick={() => handleSetup('SUC-CENTRO')}\n                                    className=\"p-6 bg-slate-800 hover:bg-cyan-600 rounded-2xl text-white font-bold text-xl transition-colors border border-slate-700 hover:border-cyan-400\"\n                                >\n                                    üìç Sucursal Centro\n                                </button>\n                                <button\n                                    onClick={() => handleSetup('SUC-NORTE')}\n                                    className=\"p-6 bg-slate-800 hover:bg-purple-600 rounded-2xl text-white font-bold text-xl transition-colors border border-slate-700 hover:border-purple-400\"\n                                >\n                                    üìç Sucursal Norte\n                                </button>\n                            </div>\n                        </motion.div>\n                    )}\n\n                    {step === 'RUT' && (\n                        <motion.div\n                            key=\"rut\"\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            exit={{ opacity: 0, y: -20 }}\n                            className=\"bg-white/10 backdrop-blur-lg rounded-[3rem] p-8 border border-white/10 shadow-2xl\"\n                        >\n                            <div className=\"bg-slate-800/50 rounded-2xl p-6 mb-8 text-center border border-slate-700\">\n                                <p className=\"text-slate-400 mb-2 text-sm uppercase font-bold tracking-widest\">Ingrese su RUT</p>\n                                <div className=\"text-5xl font-mono font-bold text-white tracking-wider h-16 flex items-center justify-center\">\n                                    {rut || <span className=\"text-slate-600 animate-pulse\">_</span>}\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-3 gap-4 mb-8\">\n                                {[1, 2, 3, 4, 5, 6, 7, 8, 9, 'K', 0].map((num) => (\n                                    <button\n                                        key={num}\n                                        onClick={() => handleNumberClick(num.toString())}\n                                        className=\"h-20 rounded-2xl bg-slate-800 text-white text-3xl font-bold hover:bg-cyan-600 transition-all shadow-lg active:scale-95 flex items-center justify-center\"\n                                    >\n                                        {num}\n                                    </button>\n                                ))}\n                                <button\n                                    onClick={() => setRut(prev => prev.slice(0, -1))}\n                                    className=\"h-20 rounded-2xl bg-red-500/20 text-red-400 text-xl font-bold hover:bg-red-500 hover:text-white transition-all flex items-center justify-center\"\n                                >\n                                    ‚å´\n                                </button>\n                            </div>\n\n                            <button\n                                onClick={handleRutSubmit}\n                                disabled={rut.length < 8}\n                                className=\"w-full py-6 bg-cyan-500 text-white text-2xl font-bold rounded-2xl hover:bg-cyan-400 transition-all shadow-xl shadow-cyan-900/50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3\"\n                            >\n                                Continuar <ArrowRight />\n                            </button>\n                        </motion.div>\n                    )}\n\n                    {step === 'NAME' && (\n                        <motion.div\n                            key=\"name\"\n                            initial={{ opacity: 0, x: 50 }}\n                            animate={{ opacity: 1, x: 0 }}\n                            exit={{ opacity: 0, x: -50 }}\n                            className=\"bg-white/10 backdrop-blur-lg rounded-[3rem] p-8 border border-white/10 shadow-2xl text-center\"\n                        >\n                            <div className=\"mb-8\">\n                                <div className=\"w-20 h-20 bg-cyan-500/20 rounded-full flex items-center justify-center mx-auto mb-4 text-cyan-400\">\n                                    <UserPlus size={40} />\n                                </div>\n                                <h2 className=\"text-3xl font-bold text-white mb-2\">¬°Hola! No te conocemos.</h2>\n                                <p className=\"text-slate-400\">Ingresa tu nombre para registrarte r√°pidamente.</p>\n                            </div>\n\n                            <input\n                                type=\"text\"\n                                autoFocus\n                                placeholder=\"Tu Nombre\"\n                                className=\"w-full bg-slate-800/50 border-2 border-slate-700 rounded-2xl p-6 text-center text-2xl text-white focus:border-cyan-500 focus:outline-none mb-8\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                            />\n\n                            <div className=\"space-y-4\">\n                                <button\n                                    onClick={handleRegisterAndTicket}\n                                    disabled={!name}\n                                    className=\"w-full py-6 bg-cyan-500 text-white text-xl font-bold rounded-2xl hover:bg-cyan-400 transition-all shadow-xl\"\n                                >\n                                    Registrarme y Sacar N√∫mero\n                                </button>\n                                <button\n                                    onClick={handleSkipRegister}\n                                    className=\"w-full py-4 bg-transparent text-slate-400 font-bold hover:text-white transition-colors\"\n                                >\n                                    Omitir y Sacar N√∫mero An√≥nimo\n                                </button>\n                            </div>\n                        </motion.div>\n                    )}\n\n                    {step === 'TICKET' && ticket && (\n                        <motion.div\n                            key=\"ticket\"\n                            initial={{ scale: 0.8, opacity: 0 }}\n                            animate={{ scale: 1, opacity: 1 }}\n                            className=\"bg-white rounded-[3rem] p-12 text-center shadow-2xl max-w-md mx-auto relative overflow-hidden\"\n                        >\n                            <div className=\"absolute top-0 left-0 w-full h-4 bg-gradient-to-r from-cyan-400 to-blue-500\" />\n\n                            <div className=\"mb-8\">\n                                <p className=\"text-slate-400 text-sm uppercase font-bold tracking-widest mb-2\">Tu N√∫mero de Atenci√≥n</p>\n                                <h2 className=\"text-8xl font-black text-slate-900 tracking-tighter\">{ticket.number}</h2>\n                            </div>\n\n                            {customerName && (\n                                <div className=\"mb-8 p-4 bg-cyan-50 rounded-2xl border border-cyan-100\">\n                                    <p className=\"text-cyan-800 font-bold\">¬°Hola, {customerName}!</p>\n                                    <p className=\"text-cyan-600 text-sm\">Gracias por registrarte.</p>\n                                </div>\n                            )}\n\n                            <div className=\"flex items-center justify-center gap-2 text-slate-400 mb-8\">\n                                <Printer size={20} className=\"animate-pulse text-cyan-500\" />\n                                <span className=\"font-mono\">Imprimiendo Ticket...</span>\n                            </div>\n\n                            <button\n                                onClick={reset}\n                                className=\"w-full py-4 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 transition\"\n                            >\n                                Finalizar\n                            </button>\n                        </motion.div>\n                    )}\n                </AnimatePresence>\n            </div>\n        </div>\n    );\n};\n\nexport default QueueKioskPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2847, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/AccessControlPage.tsx"],"sourcesContent":["import React, { useState, useMemo, useRef, useEffect } from 'react';\nimport { User, Clock, Coffee, LogOut, CheckCircle, AlertTriangle, Stethoscope, FileText, Ambulance, ArrowLeftCircle, Lock, Unlock } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { usePharmaStore } from '../store/useStore';\nimport { EmployeeProfile, AttendanceType } from '../../domain/types';\nimport { toast } from 'sonner';\nimport { WebAuthnService } from '../../infrastructure/biometrics/WebAuthnService';\n\nconst AccessControlPage: React.FC = () => {\n    const { employees, registerAttendance } = usePharmaStore();\n\n    // Security State\n    const [isKioskActive, setIsKioskActive] = useState(false);\n    const [adminPin, setAdminPin] = useState('');\n\n    // User Flow State\n    const [selectedEmployee, setSelectedEmployee] = useState<EmployeeProfile | null>(null);\n    const [pin, setPin] = useState('');\n    const [status, setStatus] = useState<'IDLE' | 'SUCCESS' | 'ERROR'>('IDLE');\n    const [actionType, setActionType] = useState<AttendanceType | ''>('');\n    const [showSpecialMenu, setShowSpecialMenu] = useState(false);\n    const [observation, setObservation] = useState('');\n\n    // Filter active employees for the wall\n    const activeEmployees = useMemo(() => employees.filter(e => e.status === 'ACTIVE'), [employees]);\n\n    const handleUnlock = (e: React.FormEvent) => {\n        e.preventDefault();\n        const admin = employees.find(emp => emp.access_pin === adminPin && (emp.role === 'MANAGER' || emp.role === 'ADMIN'));\n        if (admin) {\n            setIsKioskActive(true);\n            toast.success(`Terminal Activado por ${admin.name}`);\n            setAdminPin('');\n        } else {\n            toast.error('PIN no autorizado');\n            setAdminPin('');\n        }\n    };\n\n    const handlePinSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n\n        if (!selectedEmployee || !actionType) return;\n\n        if (pin === selectedEmployee.access_pin) {\n            // Capture Evidence (Photo)\n            const evidencePhoto = captureEvidence();\n\n            // Register Attendance\n            registerAttendance(selectedEmployee.id, actionType as AttendanceType, observation, evidencePhoto);\n\n            setStatus('SUCCESS');\n            toast.success(`Marca registrada: ${actionType}`);\n\n            setTimeout(() => {\n                setStatus('IDLE');\n                setSelectedEmployee(null);\n                setPin('');\n                setActionType('');\n                setObservation('');\n                setShowSpecialMenu(false);\n            }, 3000);\n        } else {\n            setStatus('ERROR');\n            toast.error('PIN Incorrecto');\n            setPin('');\n        }\n    };\n\n    // --- BIOMETRICS & CAMERA ---\n    const videoRef = useRef<HTMLVideoElement>(null);\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n\n    useEffect(() => {\n        // Initialize Camera when kiosk is active\n        if (isKioskActive) {\n            navigator.mediaDevices.getUserMedia({ video: { width: 320, height: 240 } })\n                .then(stream => {\n                    if (videoRef.current) {\n                        videoRef.current.srcObject = stream;\n                    }\n                })\n                .catch(err => console.error(\"Error accessing camera:\", err));\n        }\n    }, [isKioskActive]);\n\n    const captureEvidence = (): string | undefined => {\n        if (videoRef.current && canvasRef.current) {\n            const context = canvasRef.current.getContext('2d');\n            if (context) {\n                context.drawImage(videoRef.current, 0, 0, 320, 240);\n                return canvasRef.current.toDataURL('image/jpeg', 0.5); // Low quality for storage\n            }\n        }\n        return undefined;\n    };\n\n    const handleBiometricLogin = async () => {\n        if (!selectedEmployee || !actionType) return;\n\n        try {\n            toast.info('Coloque su huella o rostro...');\n\n            // Pass registered credentials to allow 1:1 verification\n            const allowedCredentials = selectedEmployee.biometric_credentials || [];\n            const credential = await WebAuthnService.authenticateCredential(allowedCredentials);\n\n            if (credential) {\n                // In a real app, we would verify the credential ID against the user's registered credentials\n                // For this demo, we assume success if the device authenticates\n\n                const evidencePhoto = captureEvidence();\n                registerAttendance(selectedEmployee.id, actionType as AttendanceType, observation, evidencePhoto);\n\n                setStatus('SUCCESS');\n                toast.success(`Marca Biom√©trica Exitosa: ${actionType}`);\n\n                setTimeout(() => {\n                    setStatus('IDLE');\n                    setSelectedEmployee(null);\n                    setPin('');\n                    setActionType('');\n                    setObservation('');\n                    setShowSpecialMenu(false);\n                }, 3000);\n            }\n        } catch (error) {\n            console.error(error);\n            toast.error('Error de autenticaci√≥n biom√©trica');\n        }\n    };\n\n    const handleActionSelect = (type: AttendanceType) => {\n        setActionType(type);\n    };\n\n    const getGreeting = () => {\n        const hour = new Date().getHours();\n        if (hour < 12) return 'Buenos d√≠as';\n        if (hour < 19) return 'Buenas tardes';\n        return 'Buenas noches';\n    };\n\n    // --- LOCK SCREEN ---\n    if (!isKioskActive) {\n        return (\n            <div className=\"min-h-screen bg-slate-950 flex items-center justify-center p-8\">\n                <div className=\"w-full max-w-md text-center\">\n                    <div className=\"mb-8 flex justify-center\">\n                        <div className=\"w-24 h-24 bg-slate-900 rounded-full flex items-center justify-center border-4 border-slate-800\">\n                            <Lock size={40} className=\"text-slate-600\" />\n                        </div>\n                    </div>\n                    <h1 className=\"text-3xl font-bold text-slate-200 mb-2\">Terminal Desactivado</h1>\n                    <p className=\"text-slate-500 mb-8\">Ingrese PIN de Supervisor para activar</p>\n\n                    <form onSubmit={handleUnlock}>\n                        <input\n                            type=\"password\"\n                            maxLength={4}\n                            autoFocus\n                            className=\"w-full text-center text-5xl tracking-[1em] font-bold py-6 bg-slate-900 border-2 border-slate-800 rounded-2xl focus:border-cyan-600 focus:outline-none text-white mb-8 transition-colors\"\n                            value={adminPin}\n                            onChange={(e) => setAdminPin(e.target.value)}\n                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                        />\n                        <button\n                            type=\"submit\"\n                            className=\"w-full py-4 bg-cyan-600 hover:bg-cyan-500 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2\"\n                        >\n                            <Unlock size={20} />\n                            ACTIVAR TERMINAL\n                        </button>\n                    </form>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"min-h-screen bg-slate-900 flex items-center justify-center p-8\">\n            <div className=\"w-full max-w-6xl\">\n                <header className=\"text-center mb-12\">\n                    <h1 className=\"text-4xl font-extrabold text-white mb-2\">Control de Asistencia</h1>\n                    <p className=\"text-slate-400 text-xl capitalize\">{new Date().toLocaleDateString('es-CL', { weekday: 'long', day: 'numeric', month: 'long' })}</p>\n                    <p className=\"text-cyan-400 text-3xl font-mono font-bold mt-2\">\n                        {new Date().toLocaleTimeString('es-CL', { hour: '2-digit', minute: '2-digit' })}\n                    </p>\n                </header>\n\n                <AnimatePresence mode=\"wait\">\n                    {!selectedEmployee ? (\n                        <motion.div\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            exit={{ opacity: 0, y: -20 }}\n                            className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6\"\n                        >\n                            {activeEmployees.map(emp => (\n                                <motion.button\n                                    key={emp.id}\n                                    whileHover={{ scale: 1.05 }}\n                                    whileTap={{ scale: 0.95 }}\n                                    onClick={() => setSelectedEmployee(emp)}\n                                    className={`rounded-3xl p-6 flex flex-col items-center gap-4 transition border group relative overflow-hidden ${emp.current_status === 'IN'\n                                        ? 'bg-slate-800 border-slate-700 hover:border-emerald-500'\n                                        : emp.current_status === 'LUNCH'\n                                            ? 'bg-slate-800/50 border-orange-900/30 hover:border-orange-500'\n                                            : 'bg-slate-800/50 border-slate-800 hover:border-cyan-500'\n                                        }`}\n                                >\n                                    <div className={`w-20 h-20 rounded-full flex items-center justify-center text-2xl font-bold text-white transition-colors ${emp.current_status === 'IN' ? 'bg-emerald-600' :\n                                        emp.current_status === 'LUNCH' ? 'bg-orange-600' :\n                                            emp.current_status === 'ON_PERMISSION' ? 'bg-amber-600' :\n                                                'bg-slate-600 group-hover:bg-cyan-600'\n                                        }`}>\n                                        {emp.name.charAt(0)}\n                                    </div>\n                                    <div className=\"text-center z-10\">\n                                        <h3 className=\"text-lg font-bold text-white leading-tight mb-1\">{emp.name.split(' ')[0]}</h3>\n                                        <p className=\"text-slate-400 text-xs\">{emp.job_title?.replace(/_/g, ' ')}</p>\n                                    </div>\n                                    {emp.current_status === 'IN' && (\n                                        <div className=\"absolute top-4 right-4 w-3 h-3 bg-emerald-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(16,185,129,0.5)]\"></div>\n                                    )}\n                                    {emp.current_status === 'LUNCH' && (\n                                        <div className=\"absolute top-4 right-4\"><Coffee size={16} className=\"text-orange-500\" /></div>\n                                    )}\n                                </motion.button>\n                            ))}\n                        </motion.div>\n                    ) : (\n                        <motion.div\n                            initial={{ opacity: 0, scale: 0.9 }}\n                            animate={{ opacity: 1, scale: 1 }}\n                            exit={{ opacity: 0, scale: 0.9 }}\n                            className=\"bg-white rounded-[3rem] p-12 max-w-3xl mx-auto shadow-2xl relative overflow-hidden\"\n                        >\n                            {status === 'SUCCESS' ? (\n                                <div className=\"text-center py-12\">\n                                    <motion.div\n                                        initial={{ scale: 0 }}\n                                        animate={{ scale: 1 }}\n                                        className=\"inline-block mb-6\"\n                                    >\n                                        <CheckCircle size={100} className=\"text-emerald-500\" />\n                                    </motion.div>\n                                    <h2 className=\"text-4xl font-bold text-slate-900 mb-4\">¬°Marca Registrada!</h2>\n                                    <p className=\"text-2xl text-slate-500\">{getGreeting()}, {selectedEmployee.name.split(' ')[0]}.</p>\n                                </div>\n                            ) : (\n                                <>\n                                    <div className=\"flex items-center gap-8 mb-10 pb-8 border-b border-slate-100\">\n                                        <div className=\"w-24 h-24 rounded-full bg-cyan-600 flex items-center justify-center text-4xl font-bold text-white shadow-lg shadow-cyan-200\">\n                                            {selectedEmployee.name.charAt(0)}\n                                        </div>\n                                        <div>\n                                            <h2 className=\"text-3xl font-bold text-slate-900 mb-1\">{selectedEmployee.name}</h2>\n                                            <p className=\"text-slate-500 font-medium mb-2\">{selectedEmployee.job_title?.replace(/_/g, ' ')}</p>\n                                            <button\n                                                onClick={() => { setSelectedEmployee(null); setActionType(''); setShowSpecialMenu(false); }}\n                                                className=\"text-slate-400 hover:text-slate-600 font-bold text-sm flex items-center gap-1 transition-colors\"\n                                            >\n                                                <ArrowLeftCircle size={16} /> Cambiar Usuario\n                                            </button>\n                                        </div>\n                                        <div className=\"ml-auto text-right\">\n                                            <p className=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1\">Estado Actual</p>\n                                            <span className={`px-4 py-2 rounded-full font-bold text-sm ${selectedEmployee.current_status === 'IN' ? 'bg-emerald-100 text-emerald-700' :\n                                                selectedEmployee.current_status === 'LUNCH' ? 'bg-orange-100 text-orange-700' :\n                                                    selectedEmployee.current_status === 'ON_PERMISSION' ? 'bg-amber-100 text-amber-700' :\n                                                        'bg-slate-100 text-slate-600'\n                                                }`}>\n                                                {selectedEmployee.current_status === 'IN' ? 'üü¢ TRABAJANDO' :\n                                                    selectedEmployee.current_status === 'LUNCH' ? 'üçî EN COLACI√ìN' :\n                                                        selectedEmployee.current_status === 'ON_PERMISSION' ? '‚ö†Ô∏è SALIDA ESPECIAL' :\n                                                            'üî¥ FUERA'}\n                                            </span>\n                                        </div>\n                                    </div>\n\n                                    {!actionType ? (\n                                        <div className=\"space-y-6\">\n                                            {/* --- CASE A: OUT (Start Shift) --- */}\n                                            {selectedEmployee.current_status === 'OUT' && (\n                                                <button onClick={() => handleActionSelect('CHECK_IN')} className=\"w-full p-8 bg-emerald-50 rounded-3xl border-2 border-emerald-100 hover:border-emerald-500 flex flex-col items-center gap-4 transition group\">\n                                                    <Clock size={64} className=\"text-emerald-600 group-hover:scale-110 transition-transform\" />\n                                                    <span className=\"font-bold text-2xl text-emerald-800\">MARCAR INICIO JORNADA</span>\n                                                </button>\n                                            )}\n\n                                            {/* --- CASE B: IN (Working) --- */}\n                                            {selectedEmployee.current_status === 'IN' && (\n                                                !showSpecialMenu ? (\n                                                    <div className=\"grid grid-cols-2 gap-4\">\n                                                        <button onClick={() => handleActionSelect('BREAK_START')} className=\"p-8 bg-orange-50 rounded-3xl border-2 border-orange-100 hover:border-orange-500 flex flex-col items-center gap-4 transition group\">\n                                                            <Coffee size={48} className=\"text-orange-500 group-hover:scale-110 transition-transform\" />\n                                                            <span className=\"font-bold text-xl text-orange-800\">Inicio Colaci√≥n</span>\n                                                        </button>\n                                                        <button onClick={() => handleActionSelect('CHECK_OUT')} className=\"p-8 bg-red-50 rounded-3xl border-2 border-red-100 hover:border-red-500 flex flex-col items-center gap-4 transition group\">\n                                                            <LogOut size={48} className=\"text-red-500 group-hover:scale-110 transition-transform\" />\n                                                            <span className=\"font-bold text-xl text-red-800\">Fin de Jornada</span>\n                                                        </button>\n                                                        <button onClick={() => setShowSpecialMenu(true)} className=\"col-span-2 p-6 bg-amber-50 rounded-3xl border-2 border-amber-100 hover:border-amber-500 flex items-center justify-center gap-3 transition group\">\n                                                            <AlertTriangle size={24} className=\"text-amber-600\" />\n                                                            <span className=\"font-bold text-lg text-amber-800\">Registrar Salida Especial / Permiso</span>\n                                                        </button>\n                                                    </div>\n                                                ) : (\n                                                    <div className=\"space-y-4 animate-in fade-in slide-in-from-bottom-4\">\n                                                        <div className=\"flex items-center justify-between mb-2\">\n                                                            <h3 className=\"font-bold text-slate-700\">Seleccione Tipo de Salida</h3>\n                                                            <button onClick={() => setShowSpecialMenu(false)} className=\"text-sm text-slate-400 hover:text-slate-600\">Cancelar</button>\n                                                        </div>\n                                                        <div className=\"grid grid-cols-3 gap-4\">\n                                                            <button onClick={() => handleActionSelect('MEDICAL_LEAVE')} className=\"p-6 bg-blue-50 rounded-2xl border-2 border-blue-100 hover:border-blue-500 flex flex-col items-center gap-3 transition text-center\">\n                                                                <Stethoscope size={32} className=\"text-blue-600\" />\n                                                                <span className=\"font-bold text-blue-800 leading-tight\">Cita<br />M√©dica</span>\n                                                            </button>\n                                                            <button onClick={() => handleActionSelect('PERMISSION_START')} className=\"p-6 bg-purple-50 rounded-2xl border-2 border-purple-100 hover:border-purple-500 flex flex-col items-center gap-3 transition text-center\">\n                                                                <FileText size={32} className=\"text-purple-600\" />\n                                                                <span className=\"font-bold text-purple-800 leading-tight\">Permiso<br />Personal</span>\n                                                            </button>\n                                                            <button onClick={() => handleActionSelect('WORK_ACCIDENT')} className=\"p-6 bg-red-50 rounded-2xl border-2 border-red-100 hover:border-red-600 flex flex-col items-center gap-3 transition text-center\">\n                                                                <Ambulance size={32} className=\"text-red-600\" />\n                                                                <span className=\"font-bold text-red-800 leading-tight\">Accidente<br />Laboral</span>\n                                                            </button>\n                                                        </div>\n                                                    </div>\n                                                )\n                                            )}\n\n                                            {/* --- CASE C: ON BREAK --- */}\n                                            {selectedEmployee.current_status === 'LUNCH' && (\n                                                <button onClick={() => handleActionSelect('BREAK_END')} className=\"w-full p-8 bg-emerald-50 rounded-3xl border-2 border-emerald-100 hover:border-emerald-500 flex flex-col items-center gap-4 transition group\">\n                                                    <Coffee size={64} className=\"text-emerald-600 group-hover:scale-110 transition-transform\" />\n                                                    <span className=\"font-bold text-2xl text-emerald-800\">REGRESO DE COLACI√ìN</span>\n                                                </button>\n                                            )}\n\n                                            {/* --- CASE D: ON PERMISSION --- */}\n                                            {selectedEmployee.current_status === 'ON_PERMISSION' && (\n                                                <button onClick={() => handleActionSelect('PERMISSION_END')} className=\"w-full p-8 bg-blue-50 rounded-3xl border-2 border-blue-100 hover:border-blue-500 flex flex-col items-center gap-4 transition group\">\n                                                    <ArrowLeftCircle size={64} className=\"text-blue-600 group-hover:scale-110 transition-transform\" />\n                                                    <span className=\"font-bold text-2xl text-blue-800\">RETORNO DE SALIDA ESPECIAL</span>\n                                                </button>\n                                            )}\n                                        </div>\n                                    ) : (\n                                        <form onSubmit={handlePinSubmit} className=\"animate-in fade-in zoom-in-95\">\n                                            <div className=\"text-center mb-8\">\n                                                <h3 className=\"text-xl font-bold text-slate-800 mb-2\">Confirmar Acci√≥n</h3>\n                                                <span className=\"inline-block px-4 py-1 bg-slate-100 rounded-full text-slate-600 font-mono font-bold\">{actionType}</span>\n                                            </div>\n\n                                            {['MEDICAL_LEAVE', 'PERMISSION_START', 'WORK_ACCIDENT'].includes(actionType) && (\n                                                <div className=\"mb-6\">\n                                                    <label className=\"block text-sm font-bold text-slate-500 mb-2\">Observaci√≥n (Opcional)</label>\n                                                    <textarea\n                                                        className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none resize-none\"\n                                                        rows={2}\n                                                        placeholder=\"Ej: Cita dentista, Tr√°mite banco...\"\n                                                        value={observation}\n                                                        onChange={(e) => setObservation(e.target.value)}\n                                                    />\n                                                </div>\n                                            )}\n\n                                            <div className=\"mb-8\">\n                                                <label className=\"block text-center text-sm font-bold text-slate-400 mb-4\">INGRESE SU PIN DE 4 D√çGITOS</label>\n                                                <input\n                                                    type=\"password\"\n                                                    maxLength={4}\n                                                    autoFocus\n                                                    className=\"w-full text-center text-6xl tracking-[1em] font-bold py-4 border-b-4 border-slate-200 focus:border-cyan-600 focus:outline-none text-slate-800\"\n                                                    value={pin}\n                                                    onChange={(e) => setPin(e.target.value)}\n                                                />\n\n                                                {/* Biometric Option */}\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={handleBiometricLogin}\n                                                    className=\"w-full mt-6 py-4 bg-slate-800 text-white rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-slate-700 transition shadow-lg\"\n                                                >\n                                                    <span className=\"text-2xl\">üëÜ</span>\n                                                    Ingresar con Huella / Rostro\n                                                </button>\n                                            </div>\n\n                                            <div className=\"grid grid-cols-2 gap-4\">\n                                                <button type=\"button\" onClick={() => { setActionType(''); setPin(''); }} className=\"py-4 rounded-xl font-bold text-slate-500 bg-slate-100 hover:bg-slate-200 transition\">\n                                                    Cancelar\n                                                </button>\n                                                <button type=\"submit\" className=\"py-4 rounded-xl font-bold text-white bg-cyan-600 hover:bg-cyan-700 shadow-lg shadow-cyan-200 transition transform active:scale-95\">\n                                                    CONFIRMAR\n                                                </button>\n                                            </div>\n                                        </form>\n                                    )}\n                                </>\n                            )}\n                        </motion.div>\n                    )}\n                </AnimatePresence>\n            </div>\n\n            {/* Hidden Camera Elements */}\n            <div className=\"fixed bottom-4 right-4 w-32 h-24 bg-black rounded-lg overflow-hidden border-2 border-slate-700 opacity-50 hover:opacity-100 transition-opacity pointer-events-none\">\n                <video ref={videoRef} autoPlay playsInline muted className=\"w-full h-full object-cover\" />\n                <canvas ref={canvasRef} width=\"320\" height=\"240\" className=\"hidden\" />\n            </div>\n        </div>\n    );\n};\n\nexport default AccessControlPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3931, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/hr/AttendanceManager.tsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { EmployeeProfile, AttendanceLog, AttendanceStatus } from '../../../domain/types';\nimport { Clock, Calendar, Search, FileText, Download, AlertCircle, CheckCircle, Coffee, ArrowRight, Edit, Eye } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { PrinterService } from '../../../infrastructure/services/PrinterService';\n\ninterface AttendanceManagerProps {\n    viewMode?: 'LIVE' | 'HISTORY';\n}\n\nconst AttendanceManager: React.FC<AttendanceManagerProps> = ({ viewMode = 'LIVE' }) => {\n    const { employees, attendanceLogs } = usePharmaStore();\n    const [internalTab, setInternalTab] = useState<'LIVE' | 'HISTORY'>(viewMode);\n    const [searchTerm, setSearchTerm] = useState('');\n    const [dateRange, setDateRange] = useState<'TODAY' | 'WEEK' | 'MONTH'>('TODAY');\n\n    // Sync prop with internal state if it changes\n    React.useEffect(() => {\n        setInternalTab(viewMode);\n    }, [viewMode]);\n\n    const activeTab = internalTab;\n\n    // --- LIVE VIEW LOGIC ---\n    const activeEmployees = useMemo(() => employees.filter(e => e.status === 'ACTIVE'), [employees]);\n\n    const getStatusColor = (status: AttendanceStatus) => {\n        switch (status) {\n            case 'IN': return 'bg-emerald-100 text-emerald-700 border-emerald-200';\n            case 'LUNCH': return 'bg-orange-100 text-orange-700 border-orange-200';\n            case 'ON_PERMISSION': return 'bg-amber-100 text-amber-700 border-amber-200';\n            case 'OUT': return 'bg-slate-100 text-slate-500 border-slate-200';\n            default: return 'bg-slate-100 text-slate-500';\n        }\n    };\n\n    const getLastLog = (employeeId: string) => {\n        return attendanceLogs\n            .filter(l => l.employee_id === employeeId)\n            .sort((a, b) => b.timestamp - a.timestamp)[0];\n    };\n\n    // --- HISTORY LOGIC ---\n    const getFilteredLogs = () => {\n        const now = new Date();\n        let startTime = 0;\n\n        if (dateRange === 'TODAY') {\n            startTime = new Date(now.setHours(0, 0, 0, 0)).getTime();\n        } else if (dateRange === 'WEEK') {\n            const firstDay = now.getDate() - now.getDay() + 1; // Monday\n            startTime = new Date(now.setDate(firstDay)).setHours(0, 0, 0, 0);\n        } else if (dateRange === 'MONTH') {\n            startTime = new Date(now.getFullYear(), now.getMonth(), 1).getTime();\n        }\n\n        return attendanceLogs\n            .filter(l => l.timestamp >= startTime)\n            .sort((a, b) => b.timestamp - a.timestamp);\n    };\n\n    const filteredLogs = getFilteredLogs();\n\n    const handleExportPDF = () => {\n        const data = filteredLogs.map(log => {\n            const emp = employees.find(e => e.id === log.employee_id);\n            return {\n                date: new Date(log.timestamp).toLocaleDateString(),\n                time: new Date(log.timestamp).toLocaleTimeString(),\n                employeeName: emp?.name || 'Desconocido',\n                type: log.type,\n                observation: log.observation || '-'\n            };\n        });\n\n        PrinterService.printAttendanceReport(data, dateRange);\n        toast.success('Generando reporte PDF...');\n    };\n\n    return (\n        <div className=\"h-full flex flex-col bg-slate-50 overflow-hidden\">\n            {/* Header Tabs */}\n            {/* Header Tabs - Only show if we want internal navigation, but for now we keep it simple or hide it based on design. \n                The user asked for 3 Master Tabs in HRPage, so AttendanceManager might just render the content.\n                Let's hide the internal tabs if we are in a specific mode, or just keep them as sub-tabs? \n                The prompt says \"Tab 2: Monitor\", \"Tab 3: History\". So HRPage controls this. \n                We should probably hide the internal tab switcher if we are being controlled.\n            */}\n            {/* <div className=\"flex items-center justify-between p-6 pb-0 border-b border-slate-200 bg-white\"> ... </div> */}\n\n            {/* We will render the header only for actions like Export PDF, but hide the tab switcher if we assume HRPage handles it. \n               Actually, let's keep the Export button but maybe hide the tab switcher? \n               Let's just hide the whole header if we want to rely on HRPage, BUT we need the Export button for History.\n            */}\n\n            {activeTab === 'HISTORY' && (\n                <div className=\"flex justify-end p-6 pb-0 bg-white\">\n                    <button\n                        onClick={handleExportPDF}\n                        className=\"mb-4 px-4 py-2 bg-slate-800 text-white rounded-lg font-bold text-sm flex items-center gap-2 hover:bg-slate-900 transition\"\n                    >\n                        <Download size={16} />\n                        Exportar PDF\n                    </button>\n                </div>\n            )}\n\n            <div className=\"flex-1 overflow-y-auto p-6\">\n                {activeTab === 'LIVE' ? (\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n                        {activeEmployees.map(emp => {\n                            const lastLog = getLastLog(emp.id);\n                            return (\n                                <div key={emp.id} className=\"bg-white rounded-2xl p-6 shadow-sm border border-slate-200 flex flex-col gap-4\">\n                                    <div className=\"flex items-center gap-4\">\n                                        <div className={`w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold text-white ${emp.current_status === 'IN' ? 'bg-emerald-500' :\n                                            emp.current_status === 'LUNCH' ? 'bg-orange-500' :\n                                                emp.current_status === 'ON_PERMISSION' ? 'bg-amber-500' : 'bg-slate-400'\n                                            }`}>\n                                            {emp.name.charAt(0)}\n                                        </div>\n                                        <div>\n                                            <h3 className=\"font-bold text-slate-800\">{emp.name}</h3>\n                                            <p className=\"text-xs text-slate-500\">{emp.job_title?.replace(/_/g, ' ')}</p>\n                                        </div>\n                                    </div>\n\n                                    <div className={`p-3 rounded-xl border flex items-center justify-between ${getStatusColor(emp.current_status)}`}>\n                                        <span className=\"font-bold text-sm\">\n                                            {emp.current_status === 'IN' ? 'üü¢ TRABAJANDO' :\n                                                emp.current_status === 'LUNCH' ? 'üçî EN COLACI√ìN' :\n                                                    emp.current_status === 'ON_PERMISSION' ? '‚ö†Ô∏è PERMISO' : 'üî¥ FUERA'}\n                                        </span>\n                                        {lastLog && (\n                                            <span className=\"text-xs font-mono\">\n                                                {new Date(lastLog.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                                            </span>\n                                        )}\n                                    </div>\n\n                                    {emp.current_status === 'LUNCH' && lastLog && (\n                                        <div className=\"text-xs text-center text-orange-600 font-bold bg-orange-50 p-2 rounded-lg\">\n                                            Tiempo transcurrido: {Math.floor((Date.now() - lastLog.timestamp) / 1000 / 60)} min\n                                        </div>\n                                    )}\n                                </div>\n                            );\n                        })}\n                    </div>\n                ) : (\n                    <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden\">\n                        <div className=\"p-4 border-b border-slate-100 flex items-center gap-4\">\n                            <div className=\"flex bg-slate-100 p-1 rounded-lg\">\n                                <button\n                                    onClick={() => setDateRange('TODAY')}\n                                    className={`px-4 py-1.5 rounded-md text-sm font-bold transition ${dateRange === 'TODAY' ? 'bg-white shadow-sm text-slate-800' : 'text-slate-500 hover:text-slate-700'}`}\n                                >\n                                    Hoy\n                                </button>\n                                <button\n                                    onClick={() => setDateRange('WEEK')}\n                                    className={`px-4 py-1.5 rounded-md text-sm font-bold transition ${dateRange === 'WEEK' ? 'bg-white shadow-sm text-slate-800' : 'text-slate-500 hover:text-slate-700'}`}\n                                >\n                                    Esta Semana\n                                </button>\n                                <button\n                                    onClick={() => setDateRange('MONTH')}\n                                    className={`px-4 py-1.5 rounded-md text-sm font-bold transition ${dateRange === 'MONTH' ? 'bg-white shadow-sm text-slate-800' : 'text-slate-500 hover:text-slate-700'}`}\n                                >\n                                    Este Mes\n                                </button>\n                            </div>\n                        </div>\n                        <table className=\"w-full text-sm text-left\">\n                            <thead className=\"bg-slate-50 text-slate-500 font-bold border-b border-slate-200\">\n                                <tr>\n                                    <th className=\"p-4\">Fecha / Hora</th>\n                                    <th className=\"p-4\">Empleado</th>\n                                    <th className=\"p-4\">Evento</th>\n                                    <th className=\"p-4\">Evidencia</th>\n                                    <th className=\"p-4\">Observaci√≥n</th>\n                                    <th className=\"p-4 text-right\">Acciones</th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"divide-y divide-slate-100\">\n                                {filteredLogs.map(log => {\n                                    const emp = employees.find(e => e.id === log.employee_id);\n                                    return (\n                                        <tr key={log.id} className=\"hover:bg-slate-50 transition\">\n                                            <td className=\"p-4\">\n                                                <div className=\"font-bold text-slate-700\">{new Date(log.timestamp).toLocaleDateString()}</div>\n                                                <div className=\"text-xs text-slate-400\">{new Date(log.timestamp).toLocaleTimeString()}</div>\n                                            </td>\n                                            <td className=\"p-4\">\n                                                <div className=\"font-bold text-slate-700\">{emp?.name || 'Desconocido'}</div>\n                                                <div className=\"text-xs text-slate-400\">{emp?.rut}</div>\n                                            </td>\n                                            <td className=\"p-4\">\n                                                <span className={`px-2 py-1 rounded text-xs font-bold ${log.type === 'CHECK_IN' ? 'bg-emerald-100 text-emerald-700' :\n                                                    log.type === 'CHECK_OUT' ? 'bg-red-100 text-red-700' :\n                                                        log.type.includes('BREAK') ? 'bg-orange-100 text-orange-700' :\n                                                            'bg-blue-100 text-blue-700'\n                                                    }`}>\n                                                    {log.type}\n                                                </span>\n                                            </td>\n                                            <td className=\"p-4\">\n                                                {log.evidence_photo_url ? (\n                                                    <div className=\"group relative flex items-center justify-center w-8 h-8 bg-slate-100 rounded-full cursor-help\">\n                                                        <Eye size={16} className=\"text-slate-500\" />\n                                                        {/* Tooltip Image */}\n                                                        <div className=\"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 w-48 bg-white p-2 rounded-lg shadow-xl border border-slate-200 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50\">\n                                                            <img src={log.evidence_photo_url} alt=\"Evidencia\" className=\"w-full h-auto rounded\" />\n                                                            <div className=\"text-[10px] text-center mt-1 text-slate-400\">Foto Capturada</div>\n                                                        </div>\n                                                    </div>\n                                                ) : (\n                                                    <span className=\"text-xs text-slate-300\">-</span>\n                                                )}\n                                            </td>\n                                            <td className=\"p-4 text-slate-500 italic\">\n                                                {log.observation || '-'}\n                                            </td>\n                                            <td className=\"p-4 text-right\">\n                                                <button className=\"p-2 hover:bg-slate-200 rounded-lg text-slate-500 transition\">\n                                                    <Edit size={16} />\n                                                </button>\n                                            </td>\n                                        </tr>\n                                    );\n                                })}\n                                {filteredLogs.length === 0 && (\n                                    <tr>\n                                        <td colSpan={5} className=\"p-12 text-center text-slate-400\">\n                                            No hay registros para este periodo.\n                                        </td>\n                                    </tr>\n                                )}\n                            </tbody>\n                        </table>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default AttendanceManager;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4487, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/HRPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Users, UserPlus, Search, Shield, Briefcase, Clock, FileText, Edit, Activity } from 'lucide-react';\nimport { usePharmaStore } from '../store/useStore';\nimport { ROLES } from '../../domain/security/roles';\nimport { EmployeeProfile } from '../../domain/types';\nimport AttendanceManager from './hr/AttendanceManager';\nimport { EmployeeModal } from '../components/hr/EmployeeModal';\nimport { toast } from 'sonner';\n\nconst HRPage = () => {\n    const { user, employees } = usePharmaStore();\n    const [activeTab, setActiveTab] = useState<'DIRECTORY' | 'MONITOR' | 'HISTORY'>('DIRECTORY');\n    const [searchTerm, setSearchTerm] = useState('');\n    const [selectedEmployee, setSelectedEmployee] = useState<EmployeeProfile | null>(null);\n    const [isModalOpen, setIsModalOpen] = useState(false);\n\n    // --- Access Control ---\n    if (!user || user.role !== 'MANAGER') {\n        return (\n            <div className=\"flex flex-col items-center justify-center h-full text-slate-500\">\n                <Shield size={64} className=\"text-red-500 mb-4\" />\n                <h2 className=\"text-2xl font-bold text-slate-800 mb-2\">Acceso Denegado</h2>\n                <p>No tienes permisos para acceder al m√≥dulo de Recursos Humanos.</p>\n                <p className=\"text-sm mt-2\">Rol requerido: MANAGER</p>\n            </div>\n        );\n    }\n\n    const filteredEmployees = employees.filter(emp =>\n        emp.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        emp.rut.includes(searchTerm)\n    );\n\n    const handleSaveEmployee = (updatedEmployee: EmployeeProfile) => {\n        // In a real app, dispatch an action to update the store\n        // For now, we'll just log it and show a toast\n        // Mock update in local state for demo purposes if needed,\n\n        // Mock update in local state for demo purposes if needed, \n        // but ideally usePharmaStore should have an updateEmployee action.\n        // Since we don't have it exposed in the store interface yet, we'll assume it's handled or add it later.\n        // For this task, we focus on the UI structure.\n\n        toast.success('Empleado guardado exitosamente');\n        setIsModalOpen(false);\n        setSelectedEmployee(null);\n    };\n\n    const handleNewEmployee = () => {\n        setSelectedEmployee({\n            id: `EMP-${Date.now()}`,\n            rut: '',\n            name: '',\n            role: 'CASHIER',\n            access_pin: '',\n            status: 'ACTIVE',\n            current_status: 'OUT',\n            job_title: 'CAJERO_VENDEDOR',\n            allowed_modules: []\n        } as EmployeeProfile);\n        setIsModalOpen(true);\n    };\n\n    const handleEditEmployee = (emp: EmployeeProfile) => {\n        setSelectedEmployee(emp);\n        setIsModalOpen(true);\n    };\n\n    return (\n        <div className=\"h-full flex flex-col bg-slate-50 overflow-hidden\">\n            {/* Master Header & Tabs */}\n            <div className=\"bg-white border-b border-slate-200 px-8 pt-8 pb-0 shadow-sm z-10\">\n                <div className=\"flex justify-between items-center mb-8\">\n                    <div>\n                        <h1 className=\"text-3xl font-bold text-slate-800 flex items-center gap-3\">\n                            <Users className=\"text-blue-600\" size={32} />\n                            Recursos Humanos\n                        </h1>\n                        <p className=\"text-slate-500 mt-1 text-lg\">Gesti√≥n integral de personal y asistencia</p>\n                    </div>\n\n                    {activeTab === 'DIRECTORY' && (\n                        <button\n                            onClick={handleNewEmployee}\n                            className=\"bg-blue-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-blue-700 transition-colors flex items-center gap-2 shadow-lg shadow-blue-200 transform hover:scale-105 active:scale-95\"\n                        >\n                            <UserPlus size={20} />\n                            Nuevo Empleado\n                        </button>\n                    )}\n                </div>\n\n                <div className=\"flex gap-12\">\n                    <button\n                        onClick={() => setActiveTab('DIRECTORY')}\n                        className={`pb-6 px-4 font-bold text-base transition-all relative flex items-center gap-3 ${activeTab === 'DIRECTORY' ? 'text-blue-600' : 'text-slate-400 hover:text-slate-600'}`}\n                    >\n                        <Users size={24} />\n                        DIRECTORIO & CREDENCIALES\n                        {activeTab === 'DIRECTORY' && <div className=\"absolute bottom-0 left-0 w-full h-1.5 bg-blue-600 rounded-t-full\" />}\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('MONITOR')}\n                        className={`pb-6 px-4 font-bold text-base transition-all relative flex items-center gap-3 ${activeTab === 'MONITOR' ? 'text-blue-600' : 'text-slate-400 hover:text-slate-600'}`}\n                    >\n                        <Activity size={24} />\n                        MONITOR EN VIVO\n                        {activeTab === 'MONITOR' && <div className=\"absolute bottom-0 left-0 w-full h-1.5 bg-blue-600 rounded-t-full\" />}\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('HISTORY')}\n                        className={`pb-6 px-4 font-bold text-base transition-all relative flex items-center gap-3 ${activeTab === 'HISTORY' ? 'text-blue-600' : 'text-slate-400 hover:text-slate-600'}`}\n                    >\n                        <FileText size={24} />\n                        HISTORIAL Y REPORTES\n                        {activeTab === 'HISTORY' && <div className=\"absolute bottom-0 left-0 w-full h-1.5 bg-blue-600 rounded-t-full\" />}\n                    </button>\n                </div>\n            </div>\n\n            {/* Content Area */}\n            <div className=\"flex-1 overflow-hidden bg-slate-50 p-6\">\n                {activeTab === 'DIRECTORY' && (\n                    <div className=\"h-full flex flex-col max-w-7xl mx-auto\">\n                        {/* Search Bar */}\n                        <div className=\"bg-white p-4 rounded-2xl shadow-sm border border-slate-200 mb-6 flex items-center gap-4\">\n                            <Search className=\"text-slate-400\" size={20} />\n                            <input\n                                type=\"text\"\n                                placeholder=\"Buscar empleado por nombre o RUT...\"\n                                value={searchTerm}\n                                onChange={(e) => setSearchTerm(e.target.value)}\n                                className=\"flex-1 bg-transparent outline-none text-slate-700 placeholder-slate-400\"\n                            />\n                        </div>\n\n                        {/* Employee Table */}\n                        <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex-1 flex flex-col\">\n                            <div className=\"overflow-y-auto flex-1\">\n                                <table className=\"w-full text-left\">\n                                    <thead className=\"bg-slate-50 border-b border-slate-100 sticky top-0 z-10\">\n                                        <tr>\n                                            <th className=\"p-6 font-bold text-slate-500 text-sm uppercase tracking-wider\">Empleado</th>\n                                            <th className=\"p-6 font-bold text-slate-500 text-sm uppercase tracking-wider\">Cargo / Rol</th>\n                                            <th className=\"p-6 font-bold text-slate-500 text-sm uppercase tracking-wider\">Estado</th>\n                                            <th className=\"p-6 font-bold text-slate-500 text-sm uppercase tracking-wider text-right\">Acciones</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"divide-y divide-slate-100\">\n                                        {filteredEmployees.map(emp => (\n                                            <tr key={emp.id} className=\"hover:bg-slate-50 transition-colors group\">\n                                                <td className=\"p-6\">\n                                                    <div className=\"flex items-center gap-4\">\n                                                        <div className={`w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold text-white ${emp.status === 'ACTIVE' ? 'bg-blue-500' : 'bg-slate-400'}`}>\n                                                            {emp.name.charAt(0)}\n                                                        </div>\n                                                        <div>\n                                                            <div className=\"font-bold text-slate-800 text-lg\">{emp.name}</div>\n                                                            <div className=\"text-sm text-slate-400 font-mono\">{emp.rut}</div>\n                                                        </div>\n                                                    </div>\n                                                </td>\n                                                <td className=\"p-6\">\n                                                    <div className=\"font-medium text-slate-700\">{emp.job_title?.replace(/_/g, ' ')}</div>\n                                                    <div className=\"text-xs text-slate-400 bg-slate-100 px-2 py-1 rounded-full inline-block mt-1\">\n                                                        {ROLES[emp.role]}\n                                                    </div>\n                                                </td>\n                                                <td className=\"p-6\">\n                                                    <span className={`px-3 py-1 rounded-full text-xs font-bold ${emp.status === 'ACTIVE' ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-500'}`}>\n                                                        {emp.status === 'ACTIVE' ? 'ACTIVO' : 'INACTIVO'}\n                                                    </span>\n                                                </td>\n                                                <td className=\"p-6 text-right\">\n                                                    <button\n                                                        onClick={() => handleEditEmployee(emp)}\n                                                        className=\"px-4 py-2 bg-white border border-slate-200 text-slate-600 font-bold rounded-lg hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200 transition-all shadow-sm flex items-center gap-2 ml-auto\"\n                                                    >\n                                                        <Edit size={16} />\n                                                        Editar\n                                                    </button>\n                                                </td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n                {activeTab === 'MONITOR' && (\n                    <div className=\"h-full max-w-7xl mx-auto\">\n                        <AttendanceManager viewMode=\"LIVE\" />\n                    </div>\n                )}\n\n                {activeTab === 'HISTORY' && (\n                    <div className=\"h-full max-w-7xl mx-auto\">\n                        <AttendanceManager viewMode=\"HISTORY\" />\n                    </div>\n                )}\n            </div>\n\n            {/* Employee Modal */}\n            <EmployeeModal\n                isOpen={isModalOpen}\n                onClose={() => setIsModalOpen(false)}\n                employee={selectedEmployee}\n                onSave={handleSaveEmployee}\n            />\n        </div>\n    );\n};\n\nexport default HRPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5058, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/SettingsPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Settings, User, Shield, Save, Receipt, Printer, ToggleLeft, ToggleRight } from 'lucide-react';\nimport SiiSettings from './settings/SiiSettings';\nimport HardwarePage from './settings/HardwarePage';\nimport { useSettingsStore } from '../store/useSettingsStore';\n\nconst SettingsPage: React.FC = () => {\n    const [activeTab, setActiveTab] = useState<'users' | 'sii' | 'hardware'>('users');\n    const { enable_sii_integration, toggleSiiIntegration } = useSettingsStore();\n\n    return (\n        <div className=\"p-6 bg-slate-50 min-h-screen\">\n            <header className=\"mb-8 flex justify-between items-center\">\n                <div>\n                    <h1 className=\"text-3xl font-extrabold text-slate-900\">Configuraci√≥n</h1>\n                    <p className=\"text-slate-500\">Administraci√≥n del Sistema</p>\n                </div>\n\n                {/* Global SII Toggle */}\n                <div className=\"bg-white p-4 rounded-2xl shadow-sm border border-slate-200 flex items-center gap-4\">\n                    <div className=\"text-right\">\n                        <p className=\"text-sm font-bold text-slate-800\">Integraci√≥n SII</p>\n                        <p className=\"text-xs text-slate-500\">{enable_sii_integration ? 'Modo Fiscal (Boleta)' : 'Modo Control Interno'}</p>\n                    </div>\n                    <button\n                        onClick={toggleSiiIntegration}\n                        className={`relative w-14 h-8 rounded-full transition-colors duration-300 ${enable_sii_integration ? 'bg-green-500' : 'bg-slate-300'}`}\n                    >\n                        <div className={`absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-md transform transition-transform duration-300 ${enable_sii_integration ? 'translate-x-6' : 'translate-x-0'}`} />\n                    </button>\n                </div>\n            </header>\n\n            {/* Tabs */}\n            <div className=\"bg-white rounded-t-3xl shadow-sm border border-slate-200 overflow-hidden max-w-7xl\">\n                <div className=\"flex border-b border-slate-200\">\n                    <button\n                        onClick={() => setActiveTab('users')}\n                        className={`flex-1 py-4 px-6 font-bold transition-colors flex items-center justify-center gap-2 ${activeTab === 'users'\n                            ? 'bg-cyan-50 text-cyan-700 border-b-2 border-cyan-600'\n                            : 'text-slate-500 hover:bg-slate-50'\n                            }`}\n                    >\n                        <User size={20} />\n                        Gesti√≥n de Usuarios\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('sii')}\n                        className={`flex-1 py-4 px-6 font-bold transition-colors flex items-center justify-center gap-2 ${activeTab === 'sii'\n                            ? 'bg-green-50 text-green-700 border-b-2 border-green-600'\n                            : 'text-slate-500 hover:bg-slate-50'\n                            }`}\n                    >\n                        <Receipt size={20} />\n                        Conexi√≥n SII\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('hardware')}\n                        className={`flex-1 py-4 px-6 font-bold transition-colors flex items-center justify-center gap-2 ${activeTab === 'hardware'\n                            ? 'bg-purple-50 text-purple-700 border-b-2 border-purple-600'\n                            : 'text-slate-500 hover:bg-slate-50'\n                            }`}\n                    >\n                        <Printer size={20} />\n                        Hardware & Impresi√≥n\n                    </button>\n                </div>\n            </div>\n\n            {/* Tab Content */}\n            {activeTab === 'users' && (\n                <div className=\"bg-white rounded-b-3xl shadow-sm border border-t-0 border-slate-200 overflow-hidden max-w-7xl p-8\">\n                    <form onSubmit={(e) => e.preventDefault()}>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-700 mb-2\">Nombre Completo</label>\n                                <input\n                                    type=\"text\"\n                                    autoComplete=\"name\"\n                                    className=\"w-full p-3 border-2 border-slate-300 rounded-xl focus:border-cyan-600 focus:outline-none font-medium\"\n                                    placeholder=\"Ej: Juan P√©rez\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-700 mb-2\">RUT</label>\n                                <input\n                                    type=\"text\"\n                                    autoComplete=\"off\"\n                                    className=\"w-full p-3 border-2 border-slate-300 rounded-xl focus:border-cyan-600 focus:outline-none font-medium\"\n                                    placeholder=\"11.111.111-1\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-700 mb-2\">Rol</label>\n                                <select autoComplete=\"off\" className=\"w-full p-3 border-2 border-slate-300 rounded-xl focus:border-cyan-600 focus:outline-none font-medium bg-white\">\n                                    <option>Cajero/a</option>\n                                    <option>Qu√≠mico Farmac√©utico (QF)</option>\n                                    <option>Administrador</option>\n                                    <option>Bodega</option>\n                                </select>\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-700 mb-2\">PIN de Acceso (4 d√≠gitos)</label>\n                                <input\n                                    type=\"password\"\n                                    maxLength={4}\n                                    autoComplete=\"new-password\"\n                                    className=\"w-full p-3 border-2 border-slate-300 rounded-xl focus:border-cyan-600 focus:outline-none font-medium tracking-widest\"\n                                    placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                                />\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end\">\n                            <button type=\"submit\" className=\"px-8 py-3 bg-cyan-600 text-white font-bold rounded-xl hover:bg-cyan-700 transition shadow-lg flex items-center gap-2\">\n                                <Save size={20} /> Guardar Usuario\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            )}\n\n            {activeTab === 'sii' && (\n                enable_sii_integration ? (\n                    <SiiSettings />\n                ) : (\n                    <div className=\"bg-white rounded-b-3xl shadow-sm border border-t-0 border-slate-200 p-12 flex flex-col items-center text-center\">\n                        <div className=\"bg-slate-100 p-6 rounded-full mb-6\">\n                            <Receipt size={48} className=\"text-slate-400\" />\n                        </div>\n                        <h2 className=\"text-2xl font-bold text-slate-800 mb-2\">Integraci√≥n SII Desactivada</h2>\n                        <p className=\"text-slate-500 max-w-md mb-8\">\n                            El sistema est√° operando en modo \"Control Interno\". Las ventas generar√°n comprobantes no v√°lidos como boleta.\n                            Active la integraci√≥n en la parte superior para configurar certificados y folios.\n                        </p>\n                        <button\n                            onClick={toggleSiiIntegration}\n                            className=\"px-8 py-3 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition shadow-lg\"\n                        >\n                            Activar Integraci√≥n SII\n                        </button>\n                    </div>\n                )\n            )}\n            {activeTab === 'hardware' && <HardwarePage />}\n        </div>\n    );\n};\n\nexport default SettingsPage;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;AAEA,MAAM,eAAyB;;IAC3B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAA+B;IACzE,MAAM,EAAE,sBAAsB,EAAE,oBAAoB,EAAE,GAAG,IAAA,uKAAgB;IAEzE,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAO,WAAU;;kCACd,6LAAC;;0CACG,6LAAC;gCAAG,WAAU;0CAAyC;;;;;;0CACvD,6LAAC;gCAAE,WAAU;0CAAiB;;;;;;;;;;;;kCAIlC,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;wCAAE,WAAU;kDAAmC;;;;;;kDAChD,6LAAC;wCAAE,WAAU;kDAA0B,yBAAyB,yBAAyB;;;;;;;;;;;;0CAE7F,6LAAC;gCACG,SAAS;gCACT,WAAW,CAAC,8DAA8D,EAAE,yBAAyB,iBAAiB,gBAAgB;0CAEtI,cAAA,6LAAC;oCAAI,WAAW,CAAC,0GAA0G,EAAE,yBAAyB,kBAAkB,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;0BAMrM,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BACG,SAAS,IAAM,aAAa;4BAC5B,WAAW,CAAC,oFAAoF,EAAE,cAAc,UAC1G,wDACA,oCACA;;8CAEN,6LAAC,6MAAI;oCAAC,MAAM;;;;;;gCAAM;;;;;;;sCAGtB,6LAAC;4BACG,SAAS,IAAM,aAAa;4BAC5B,WAAW,CAAC,oFAAoF,EAAE,cAAc,QAC1G,2DACA,oCACA;;8CAEN,6LAAC,sNAAO;oCAAC,MAAM;;;;;;gCAAM;;;;;;;sCAGzB,6LAAC;4BACG,SAAS,IAAM,aAAa;4BAC5B,WAAW,CAAC,oFAAoF,EAAE,cAAc,aAC1G,8DACA,oCACA;;8CAEN,6LAAC,sNAAO;oCAAC,MAAM;;;;;;gCAAM;;;;;;;;;;;;;;;;;;YAOhC,cAAc,yBACX,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAK,UAAU,CAAC,IAAM,EAAE,cAAc;;sCACnC,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;;sDACG,6LAAC;4CAAM,WAAU;sDAA8C;;;;;;sDAC/D,6LAAC;4CACG,MAAK;4CACL,cAAa;4CACb,WAAU;4CACV,aAAY;;;;;;;;;;;;8CAGpB,6LAAC;;sDACG,6LAAC;4CAAM,WAAU;sDAA8C;;;;;;sDAC/D,6LAAC;4CACG,MAAK;4CACL,cAAa;4CACb,WAAU;4CACV,aAAY;;;;;;;;;;;;8CAGpB,6LAAC;;sDACG,6LAAC;4CAAM,WAAU;sDAA8C;;;;;;sDAC/D,6LAAC;4CAAO,cAAa;4CAAM,WAAU;;8DACjC,6LAAC;8DAAO;;;;;;8DACR,6LAAC;8DAAO;;;;;;8DACR,6LAAC;8DAAO;;;;;;8DACR,6LAAC;8DAAO;;;;;;;;;;;;;;;;;;8CAGhB,6LAAC;;sDACG,6LAAC;4CAAM,WAAU;sDAA8C;;;;;;sDAC/D,6LAAC;4CACG,MAAK;4CACL,WAAW;4CACX,cAAa;4CACb,WAAU;4CACV,aAAY;;;;;;;;;;;;;;;;;;sCAKxB,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAO,MAAK;gCAAS,WAAU;;kDAC5B,6LAAC,6MAAI;wCAAC,MAAM;;;;;;oCAAM;;;;;;;;;;;;;;;;;;;;;;;YAOrC,cAAc,SAAS,CACpB,uCACI,6LAAC,sKAAW;;;;yEAEZ,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;kCACX,cAAA,6LAAC,sNAAO;4BAAC,MAAM;4BAAI,WAAU;;;;;;;;;;;kCAEjC,6LAAC;wBAAG,WAAU;kCAAyC;;;;;;kCACvD,6LAAC;wBAAE,WAAU;kCAA+B;;;;;;kCAI5C,6LAAC;wBACG,SAAS;wBACT,WAAU;kCACb;;;;;;;;;;;wDAKb;YACC,cAAc,4BAAc,6LAAC,uKAAY;;;;;;;;;;;AAGtD;GA7IM;;QAEuD,uKAAgB;;;KAFvE;uCA+IS"}},
    {"offset": {"line": 5501, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/ClientsPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { usePharmaStore } from '../store/useStore';\nimport { Search, User, MessageCircle, Star, Calendar } from 'lucide-react';\n\nconst ClientsPage: React.FC = () => {\n    const { customers } = usePharmaStore();\n    const [searchTerm, setSearchTerm] = useState('');\n\n    const filteredCustomers = customers.filter(c =>\n        c.fullName.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        c.rut.includes(searchTerm) ||\n        (c.phone && c.phone.includes(searchTerm))\n    );\n\n    const openWhatsApp = (phone?: string) => {\n        if (!phone) return;\n        const cleanPhone = phone.replace(/[^0-9]/g, '');\n        window.open(`https://wa.me/${cleanPhone}`, '_blank');\n    };\n\n    return (\n        <div className=\"p-6 bg-slate-50 min-h-screen\">\n            <header className=\"mb-8 flex justify-between items-center\">\n                <div>\n                    <h1 className=\"text-3xl font-extrabold text-slate-900\">Directorio de Clientes</h1>\n                    <p className=\"text-slate-500\">CRM & Fidelizaci√≥n</p>\n                </div>\n                <div className=\"bg-white p-4 rounded-2xl shadow-sm border border-slate-200 flex gap-4\">\n                    <div className=\"text-center\">\n                        <p className=\"text-xs font-bold text-slate-400 uppercase\">Total Clientes</p>\n                        <p className=\"text-2xl font-extrabold text-slate-900\">{customers.length}</p>\n                    </div>\n                    <div className=\"w-px bg-slate-200\" />\n                    <div className=\"text-center\">\n                        <p className=\"text-xs font-bold text-slate-400 uppercase\">Nuevos (Mes)</p>\n                        <p className=\"text-2xl font-extrabold text-emerald-600\">\n                            {customers.filter(c => new Date(c.lastVisit).getMonth() === new Date().getMonth()).length}\n                        </p>\n                    </div>\n                </div>\n            </header>\n\n            <div className=\"bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden\">\n                <div className=\"p-6 border-b border-slate-100\">\n                    <div className=\"relative max-w-md\">\n                        <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\" size={20} />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Buscar por RUT, Nombre o Tel√©fono...\"\n                            className=\"w-full pl-12 pr-4 py-3 bg-slate-50 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none transition-colors font-medium\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                    </div>\n                </div>\n\n                <div className=\"overflow-x-auto\">\n                    <table className=\"w-full text-left\">\n                        <thead className=\"bg-slate-50 text-slate-500 font-bold text-sm\">\n                            <tr>\n                                <th className=\"p-6\">Cliente</th>\n                                <th className=\"p-6\">Contacto</th>\n                                <th className=\"p-6\">Puntos</th>\n                                <th className=\"p-6\">Origen</th>\n                                <th className=\"p-6\">√öltima Visita</th>\n                                <th className=\"p-6\">Acciones</th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"divide-y divide-slate-100\">\n                            {filteredCustomers.map(customer => (\n                                <tr key={customer.id} className=\"hover:bg-slate-50 transition\">\n                                    <td className=\"p-6\">\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-white font-bold\">\n                                                {customer.fullName.charAt(0)}\n                                            </div>\n                                            <div>\n                                                <p className=\"font-bold text-slate-800\">{customer.fullName}</p>\n                                                <p className=\"text-xs text-slate-500 font-mono\">{customer.rut}</p>\n                                            </div>\n                                        </div>\n                                    </td>\n                                    <td className=\"p-6 text-slate-600\">\n                                        {customer.phone || '-'}\n                                    </td>\n                                    <td className=\"p-6\">\n                                        <div className=\"flex items-center gap-1 text-amber-600 font-bold\">\n                                            <Star size={16} fill=\"currentColor\" />\n                                            {customer.totalPoints}\n                                        </div>\n                                    </td>\n                                    <td className=\"p-6\">\n                                        <span className={`px-3 py-1 rounded-full text-xs font-bold border ${customer.registrationSource === 'KIOSK' ? 'bg-purple-50 text-purple-600 border-purple-200' :\n                                                customer.registrationSource === 'POS' ? 'bg-blue-50 text-blue-600 border-blue-200' :\n                                                    'bg-slate-100 text-slate-600 border-slate-200'\n                                            }`}>\n                                            {customer.registrationSource}\n                                        </span>\n                                    </td>\n                                    <td className=\"p-6 text-slate-500 text-sm\">\n                                        <div className=\"flex items-center gap-2\">\n                                            <Calendar size={14} />\n                                            {new Date(customer.lastVisit).toLocaleDateString()}\n                                        </div>\n                                    </td>\n                                    <td className=\"p-6\">\n                                        {customer.phone && (\n                                            <button\n                                                onClick={() => openWhatsApp(customer.phone)}\n                                                className=\"p-2 bg-emerald-100 text-emerald-600 rounded-lg hover:bg-emerald-200 transition\"\n                                                title=\"Abrir WhatsApp\"\n                                            >\n                                                <MessageCircle size={20} />\n                                            </button>\n                                        )}\n                                    </td>\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default ClientsPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5934, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/InventoryPage.tsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport { usePharmaStore } from '../store/useStore';\nimport { Search, Filter, Plus, ArrowRightLeft, Package, AlertTriangle, Snowflake, Lock, Pill, Trash2, Edit, FileSpreadsheet } from 'lucide-react';\nimport StockEntryModal from '../components/inventory/StockEntryModal';\nimport StockTransferModal from '../components/inventory/StockTransferModal';\nimport InventoryEditModal from '../components/inventory/InventoryEditModal';\nimport BulkImportModal from '../components/inventory/BulkImportModal';\nimport { hasPermission } from '../../domain/security/roles';\n\nconst InventoryPage: React.FC = () => {\n    const { inventory, user } = usePharmaStore();\n    const [searchTerm, setSearchTerm] = useState('');\n    const [activeTab, setActiveTab] = useState<'MEDS' | 'RETAIL' | 'CONTROLLED'>('MEDS');\n    const [isEntryModalOpen, setIsEntryModalOpen] = useState(false);\n    const [isTransferModalOpen, setIsTransferModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [isImportModalOpen, setIsImportModalOpen] = useState(false);\n    const [editingItem, setEditingItem] = useState<any>(null);\n\n    // Permissions\n    const canManageInventory = hasPermission(user, 'MANAGE_INVENTORY');\n    const canDelete = user?.role === 'MANAGER' || user?.role === 'ADMIN';\n\n    // Smart Filters\n    const [filters, setFilters] = useState({\n        coldChain: false,\n        expiring: false,\n        critical: false\n    });\n\n    const filteredInventory = useMemo(() => {\n        return inventory.filter(item => {\n            // 1. Text Search\n            const matchesSearch =\n                item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                item.sku.includes(searchTerm) ||\n                item.dci.toLowerCase().includes(searchTerm.toLowerCase());\n\n            if (!matchesSearch) return false;\n\n            // 2. Tab Filter\n            if (activeTab === 'MEDS' && item.category !== 'MEDICAMENTO') return false;\n            if (activeTab === 'RETAIL' && item.category === 'MEDICAMENTO') return false;\n            if (activeTab === 'CONTROLLED' && !['R', 'RR', 'RCH'].includes(item.condition)) return false;\n\n            // 3. Smart Filters\n            if (filters.expiring) {\n                const monthsUntilExpiry = (item.expiry_date - Date.now()) / (1000 * 60 * 60 * 24 * 30);\n                if (monthsUntilExpiry > 6) return false;\n            }\n\n            if (filters.critical) {\n                if (item.stock_actual > item.stock_min) return false;\n            }\n\n            return true;\n        });\n    }, [inventory, searchTerm, activeTab, filters]);\n\n    const getStockStatus = (item: any) => {\n        if (item.stock_actual <= 0) return 'bg-red-100 text-red-700 border-red-200';\n        if (item.stock_actual <= item.stock_min) return 'bg-amber-100 text-amber-700 border-amber-200';\n        return 'bg-emerald-100 text-emerald-700 border-emerald-200';\n    };\n\n    return (\n        <div className=\"p-6 bg-slate-50 min-h-screen\">\n            {/* Header */}\n            <header className=\"mb-8 flex justify-between items-end\">\n                <div>\n                    <h1 className=\"text-3xl font-extrabold text-slate-900 flex items-center gap-3\">\n                        <Package className=\"text-cyan-600\" /> Maestro de Inventario\n                    </h1>\n                    <p className=\"text-slate-500 mt-1\">WMS & Control de Stock</p>\n                </div>\n                <div className=\"flex gap-3\">\n                    <button\n                        onClick={() => setIsTransferModalOpen(true)}\n                        className=\"px-6 py-3 bg-white text-slate-700 font-bold rounded-xl border border-slate-200 hover:bg-slate-50 transition flex items-center gap-2\"\n                    >\n                        <ArrowRightLeft size={18} /> Transferir\n                    </button>\n                    {canManageInventory && (\n                        <>\n                            <button\n                                onClick={() => setIsImportModalOpen(true)}\n                                className=\"px-6 py-3 bg-white text-green-700 font-bold rounded-xl border border-green-200 hover:bg-green-50 transition flex items-center gap-2\"\n                            >\n                                <FileSpreadsheet size={18} /> Importar Excel\n                            </button>\n                            <button\n                                onClick={() => setIsEntryModalOpen(true)}\n                                className=\"px-6 py-3 bg-cyan-600 text-white font-bold rounded-xl hover:bg-cyan-700 transition shadow-lg shadow-cyan-200 flex items-center gap-2\"\n                            >\n                                <Plus size={18} /> Nuevo Producto / Ingreso\n                            </button>\n                        </>\n                    )}\n                </div>\n            </header>\n\n            {/* Tabs & Filters */}\n            <div className=\"bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden mb-6\">\n                <div className=\"border-b border-slate-100 flex\">\n                    <button\n                        onClick={() => setActiveTab('MEDS')}\n                        className={`flex-1 py-4 text-sm font-bold border-b-2 transition-colors ${activeTab === 'MEDS' ? 'border-cyan-500 text-cyan-700 bg-cyan-50' : 'border-transparent text-slate-500 hover:text-slate-700'}`}\n                    >\n                        üíä MEDICAMENTOS\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('RETAIL')}\n                        className={`flex-1 py-4 text-sm font-bold border-b-2 transition-colors ${activeTab === 'RETAIL' ? 'border-pink-500 text-pink-700 bg-pink-50' : 'border-transparent text-slate-500 hover:text-slate-700'}`}\n                    >\n                        üõçÔ∏è RETAIL\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('CONTROLLED')}\n                        className={`flex-1 py-4 text-sm font-bold border-b-2 transition-colors ${activeTab === 'CONTROLLED' ? 'border-purple-500 text-purple-700 bg-purple-50' : 'border-transparent text-slate-500 hover:text-slate-700'}`}\n                    >\n                        üîí CONTROLADOS\n                    </button>\n                </div>\n\n                <div className=\"p-4 flex gap-4 items-center bg-slate-50/50\">\n                    <div className=\"relative flex-1\">\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Buscar por SKU, Nombre, DCI...\"\n                            className=\"w-full pl-10 pr-4 py-2 bg-white border border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                    </div>\n                    <div className=\"flex gap-2\">\n                        <button\n                            onClick={() => setFilters(f => ({ ...f, expiring: !f.expiring }))}\n                            className={`px-3 py-2 rounded-lg text-xs font-bold border flex items-center gap-2 transition ${filters.expiring ? 'bg-amber-100 text-amber-700 border-amber-200' : 'bg-white text-slate-500 border-slate-200'}`}\n                        >\n                            <AlertTriangle size={14} /> Por Vencer\n                        </button>\n                        <button\n                            onClick={() => setFilters(f => ({ ...f, critical: !f.critical }))}\n                            className={`px-3 py-2 rounded-lg text-xs font-bold border flex items-center gap-2 transition ${filters.critical ? 'bg-red-100 text-red-700 border-red-200' : 'bg-white text-slate-500 border-slate-200'}`}\n                        >\n                            <Filter size={14} /> Stock Cr√≠tico\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n            {/* Data Grid */}\n            <div className=\"bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden\">\n                <table className=\"w-full text-left\">\n                    <thead className=\"bg-slate-50 text-slate-500 font-bold text-xs uppercase tracking-wider\">\n                        <tr>\n                            <th className=\"p-4\">Producto</th>\n                            <th className=\"p-4\">Detalle</th>\n                            <th className=\"p-4\">Atributos</th>\n                            <th className=\"p-4\">Stock</th>\n                            <th className=\"p-4 text-right\">Precio</th>\n                            <th className=\"p-4 text-center\">Acciones</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-slate-100 text-sm\">\n                        {filteredInventory.map(item => (\n                            <tr key={item.id} className=\"hover:bg-slate-50 transition group\">\n                                <td className=\"p-4\">\n                                    <div className=\"font-bold text-slate-800 text-lg\">{item.name}</div>\n                                    <div className=\"text-sm text-slate-500 font-bold\">{item.dci}</div>\n                                    <div className=\"text-xs text-slate-400 font-mono mt-1\">{item.sku}</div>\n                                </td>\n                                <td className=\"p-4\">\n                                    <div className=\"text-sm font-bold text-slate-700\">{item.laboratory}</div>\n                                    <div className=\"text-xs text-slate-500 font-mono\">{item.isp_register || 'SIN REGISTRO'}</div>\n                                    <div className=\"text-xs text-slate-400 mt-1\">{item.format} x{item.unit_count}</div>\n                                </td>\n                                <td className=\"p-4\">\n                                    <div className=\"flex gap-1 flex-wrap\">\n                                        {item.bioequivalent && <span title=\"Bioequivalente\" className=\"px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg text-xs font-bold border border-emerald-200\">BIO</span>}\n                                        {item.storage_condition === 'REFRIGERADO' && <span title=\"Cadena de Fr√≠o\" className=\"px-2 py-1 bg-cyan-100 text-cyan-700 rounded-lg text-xs font-bold border border-cyan-200\">FRIO</span>}\n                                        {['R', 'RR', 'RCH'].includes(item.condition) && <span title=\"Receta Retenida\" className=\"px-2 py-1 bg-purple-100 text-purple-700 rounded-lg text-xs font-bold border border-purple-200\">RET</span>}\n                                        {item.is_generic && <span title=\"Gen√©rico\" className=\"px-2 py-1 bg-slate-100 text-slate-600 rounded-lg text-xs font-bold border border-slate-200\">GEN</span>}\n                                    </div>\n                                </td>\n                                <td className=\"p-4\">\n                                    <div className=\"flex flex-col items-start\">\n                                        <span className={`text-lg font-bold ${item.stock_actual <= item.stock_min ? 'text-red-600' : 'text-slate-800'}`}>\n                                            {item.stock_actual} un.\n                                        </span>\n                                        <span className={`text-xs font-bold ${item.stock_actual <= item.stock_min ? 'text-red-500' : 'text-slate-400'}`}>\n                                            Min: {item.stock_min}\n                                        </span>\n                                        <span className={`text-xs mt-1 px-1.5 py-0.5 rounded ${new Date(item.expiry_date).getTime() - Date.now() < 1000 * 60 * 60 * 24 * 90 ? 'bg-red-100 text-red-700' : 'bg-slate-100 text-slate-500'}`}>\n                                            Vence: {new Date(item.expiry_date).toLocaleDateString()}\n                                        </span>\n                                    </div>\n                                </td>\n                                <td className=\"p-4 text-right\">\n                                    <div className=\"flex flex-col items-end\">\n                                        <span className=\"font-bold text-slate-800 text-lg\">${(item.price_sell_box || item.price).toLocaleString()}</span>\n                                        <span className=\"text-xs font-bold text-slate-400\">\n                                            (${item.price_sell_unit ? item.price_sell_unit.toLocaleString() : Math.round((item.price_sell_box || item.price) / (item.units_per_box || item.unit_count || 1)).toLocaleString()} / un)\n                                        </span>\n                                        {/* Security: Only Managers see Cost */}\n                                        {(user?.role === 'MANAGER' || user?.role === 'ADMIN') && (\n                                            <span className=\"text-[10px] font-mono text-slate-300 mt-1\">\n                                                Costo: ${(item.cost_net || item.cost_price).toLocaleString()}\n                                            </span>\n                                        )}\n                                    </div>\n                                </td>\n                                <td className=\"p-4\">\n                                    <div className=\"flex items-center justify-center gap-2\">\n                                        {canManageInventory && (\n                                            <button\n                                                onClick={() => { setEditingItem(item); setIsEditModalOpen(true); }}\n                                                className=\"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\n                                            >\n                                                <Edit size={16} />\n                                            </button>\n                                        )}\n                                        {canDelete && (\n                                            <button className=\"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors\">\n                                                <Trash2 size={16} />\n                                            </button>\n                                        )}\n                                    </div>\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n                {filteredInventory.length === 0 && (\n                    <div className=\"p-12 text-center text-slate-400\">\n                        <Package size={48} className=\"mx-auto mb-4 opacity-50\" />\n                        <p>No se encontraron productos con los filtros actuales.</p>\n                    </div>\n                )}\n            </div>\n\n            {/* Modals */}\n            <StockEntryModal isOpen={isEntryModalOpen} onClose={() => setIsEntryModalOpen(false)} />\n            <StockTransferModal isOpen={isTransferModalOpen} onClose={() => setIsTransferModalOpen(false)} />\n            <InventoryEditModal isOpen={isEditModalOpen} onClose={() => { setIsEditModalOpen(false); setEditingItem(null); }} product={editingItem} />\n            <BulkImportModal isOpen={isImportModalOpen} onClose={() => setIsImportModalOpen(false)} />\n        </div>\n    );\n};\n\nexport default InventoryPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6720, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/AttendanceKioskPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { usePharmaStore } from '../store/useStore';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Lock, User, Clock, Fingerprint, LogOut, CheckCircle, AlertTriangle, Coffee, ArrowRight } from 'lucide-react';\nimport { WebAuthnService } from '../../infrastructure/biometrics/WebAuthnService';\nimport { EmployeeProfile, AttendanceStatus } from '../../domain/types';\n\nconst AttendanceKioskPage: React.FC = () => {\n    const { employees, registerAttendance, user } = usePharmaStore();\n    const [isLocked, setIsLocked] = useState(true);\n    const [selectedEmployee, setSelectedEmployee] = useState<EmployeeProfile | null>(null);\n    const [authMethod, setAuthMethod] = useState<'PIN' | 'BIOMETRIC' | null>(null);\n    const [pin, setPin] = useState('');\n    const [message, setMessage] = useState<{ text: string, type: 'success' | 'error' } | null>(null);\n\n    // --- Activation Logic ---\n    const handleUnlock = () => {\n        const password = prompt(\"Ingrese contrase√±a de GERENTE para activar el Kiosco:\");\n        if (password === 'admin123') { // Hardcoded for demo\n            setIsLocked(false);\n        } else {\n            alert(\"Contrase√±a incorrecta\");\n        }\n    };\n\n    // --- Authentication Logic ---\n    const handlePinSubmit = () => {\n        if (!selectedEmployee) return;\n        if (pin === selectedEmployee.access_pin) {\n            handleAttendanceAction();\n        } else {\n            setMessage({ text: 'PIN Incorrecto', type: 'error' });\n            setPin('');\n        }\n    };\n\n    const handleBiometricAuth = async () => {\n        if (!selectedEmployee) return;\n        setMessage({ text: 'Coloque su dedo en el sensor...', type: 'success' });\n\n        try {\n            const credential = await WebAuthnService.authenticateCredential(selectedEmployee.biometric_credentials || []);\n            if (credential) {\n                handleAttendanceAction();\n            } else {\n                setMessage({ text: 'Autenticaci√≥n fallida', type: 'error' });\n            }\n        } catch (error) {\n            setMessage({ text: 'Error de autenticaci√≥n biom√©trica', type: 'error' });\n        }\n    };\n\n    const handleAttendanceAction = () => {\n        if (!selectedEmployee) return;\n\n        let action: 'CHECK_IN' | 'CHECK_OUT' | 'LUNCH_START' | 'LUNCH_END' = 'CHECK_IN';\n        const status = selectedEmployee.current_status || 'OUT';\n\n        // Determine next logical action\n        if (status === 'OUT') action = 'CHECK_IN';\n        if (status === 'IN') {\n            // Ask user preference in a real app, here we toggle for simplicity or show options\n            // For this MVP, if IN, we show options in the UI before this function is called, \n            // BUT since we are inside the auth flow, let's assume we need to know what they want to do.\n            // Let's simplify: If IN, default to CHECK_OUT, but we should probably have selected the action BEFORE auth.\n            // REFACTOR: Let's select action AFTER auth for security, or select action THEN auth.\n            // Standard Kiosk: Select User -> Auth -> Select Action (if multiple available) or Auto-Action.\n        }\n\n        // Since we need to support multiple actions from IN state (Lunch vs Out), \n        // we will show an Action Selection screen AFTER successful auth.\n        setAuthMethod(null); // Close auth modal\n        // We need a new state for \"Authenticated Employee\"\n    };\n\n    // Refactored Flow:\n    // 1. Select Employee\n    // 2. Authenticate (PIN/Bio)\n    // 3. Show Actions based on current status\n\n    const [authenticatedEmployee, setAuthenticatedEmployee] = useState<EmployeeProfile | null>(null);\n\n    const onAuthSuccess = () => {\n        setAuthenticatedEmployee(selectedEmployee);\n        setSelectedEmployee(null);\n        setAuthMethod(null);\n        setPin('');\n        setMessage(null);\n    };\n\n    const processAction = (type: 'CHECK_IN' | 'CHECK_OUT' | 'LUNCH_START' | 'LUNCH_END') => {\n        if (!authenticatedEmployee) return;\n\n        // Map UI actions to Domain Types\n        let attendanceType: any = type;\n        if (type === 'LUNCH_START') attendanceType = 'BREAK_START';\n        if (type === 'LUNCH_END') attendanceType = 'BREAK_END';\n\n        registerAttendance(authenticatedEmployee.id, attendanceType);\n\n        setMessage({ text: `Marcaje registrado: ${type}`, type: 'success' });\n\n        setTimeout(() => {\n            setAuthenticatedEmployee(null);\n            setMessage(null);\n        }, 3000);\n    };\n\n    // --- Renders ---\n\n    if (isLocked) {\n        return (\n            <div className=\"min-h-screen bg-slate-900 flex flex-col items-center justify-center text-white p-4\">\n                <Lock size={64} className=\"mb-6 text-slate-500\" />\n                <h1 className=\"text-3xl font-bold mb-2\">Terminal Bloqueado</h1>\n                <p className=\"text-slate-400 mb-8 text-center max-w-md\">\n                    Este dispositivo no est√° activo como Kiosco de Asistencia.\n                    Se requiere autorizaci√≥n de un Gerente para activarlo.\n                </p>\n                <button\n                    onClick={handleUnlock}\n                    className=\"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-xl font-bold transition-all\"\n                >\n                    Activar Terminal\n                </button>\n            </div>\n        );\n    }\n\n    if (authenticatedEmployee) {\n        return (\n            <div className=\"min-h-screen bg-slate-50 flex flex-col items-center justify-center p-4\">\n                <div className=\"bg-white p-8 rounded-3xl shadow-xl max-w-lg w-full text-center\">\n                    <div className=\"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-600 font-bold text-3xl\">\n                        {authenticatedEmployee.name.charAt(0)}\n                    </div>\n                    <h2 className=\"text-2xl font-bold text-slate-800 mb-1\">Hola, {authenticatedEmployee.name}</h2>\n                    <p className=\"text-slate-500 mb-8\">Selecciona tu marcaje</p>\n\n                    <div className=\"grid gap-4\">\n                        {authenticatedEmployee.current_status === 'OUT' && (\n                            <button\n                                onClick={() => processAction('CHECK_IN')}\n                                className=\"bg-green-500 hover:bg-green-600 text-white p-6 rounded-2xl font-bold text-xl flex items-center justify-center gap-3 transition-all\"\n                            >\n                                <LogOut className=\"rotate-180\" /> ENTRADA\n                            </button>\n                        )}\n\n                        {(authenticatedEmployee.current_status === 'IN' || authenticatedEmployee.current_status === 'LUNCH') && (\n                            <>\n                                {authenticatedEmployee.current_status === 'IN' && (\n                                    <button\n                                        onClick={() => processAction('LUNCH_START')}\n                                        className=\"bg-amber-500 hover:bg-amber-600 text-white p-6 rounded-2xl font-bold text-xl flex items-center justify-center gap-3 transition-all\"\n                                    >\n                                        <Coffee /> SALIDA A COLACI√ìN\n                                    </button>\n                                )}\n\n                                {authenticatedEmployee.current_status === 'LUNCH' && (\n                                    <button\n                                        onClick={() => processAction('LUNCH_END')}\n                                        className=\"bg-blue-500 hover:bg-blue-600 text-white p-6 rounded-2xl font-bold text-xl flex items-center justify-center gap-3 transition-all\"\n                                    >\n                                        <ArrowRight /> VUELTA DE COLACI√ìN\n                                    </button>\n                                )}\n\n                                {authenticatedEmployee.current_status === 'IN' && (\n                                    <button\n                                        onClick={() => processAction('CHECK_OUT')}\n                                        className=\"bg-red-500 hover:bg-red-600 text-white p-6 rounded-2xl font-bold text-xl flex items-center justify-center gap-3 transition-all\"\n                                    >\n                                        <LogOut /> FIN DE JORNADA\n                                    </button>\n                                )}\n                            </>\n                        )}\n                    </div>\n\n                    <button\n                        onClick={() => setAuthenticatedEmployee(null)}\n                        className=\"mt-8 text-slate-400 hover:text-slate-600 font-medium\"\n                    >\n                        Cancelar\n                    </button>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"min-h-screen bg-slate-100 flex flex-col\">\n            {/* Header */}\n            <div className=\"bg-white p-6 shadow-sm flex justify-between items-center\">\n                <div className=\"flex items-center gap-3\">\n                    <Clock className=\"text-blue-600\" size={32} />\n                    <div>\n                        <h1 className=\"text-xl font-bold text-slate-800\">Control de Asistencia</h1>\n                        <p className=\"text-sm text-slate-500\">{new Date().toLocaleDateString()} - {new Date().toLocaleTimeString()}</p>\n                    </div>\n                </div>\n                <button onClick={() => setIsLocked(true)} className=\"text-slate-400 hover:text-red-500\">\n                    <Lock size={20} />\n                </button>\n            </div>\n\n            {/* Employee Grid */}\n            <div className=\"flex-1 p-6 overflow-y-auto\">\n                <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\">\n                    {employees.map(emp => (\n                        <motion.button\n                            key={emp.id}\n                            whileHover={{ scale: 1.02 }}\n                            whileTap={{ scale: 0.98 }}\n                            onClick={() => { setSelectedEmployee(emp); setAuthMethod('BIOMETRIC'); }}\n                            className=\"bg-white p-6 rounded-2xl shadow-sm hover:shadow-md transition-all flex flex-col items-center text-center relative overflow-hidden\"\n                        >\n                            {/* Status Indicator */}\n                            <div className={`absolute top-4 right-4 w-4 h-4 rounded-full ${emp.current_status === 'IN' ? 'bg-green-500 animate-pulse' :\n                                emp.current_status === 'LUNCH' ? 'bg-amber-500' : 'bg-slate-300'\n                                }`} />\n\n                            <div className=\"w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-4 text-slate-500 font-bold text-2xl\">\n                                {emp.name.charAt(0)}\n                            </div>\n                            <h3 className=\"font-bold text-slate-800 text-lg\">{emp.name}</h3>\n                            <p className=\"text-sm text-slate-500\">{emp.role}</p>\n                            <span className={`mt-3 px-3 py-1 rounded-full text-xs font-bold ${emp.current_status === 'IN' ? 'bg-green-100 text-green-700' :\n                                emp.current_status === 'LUNCH' ? 'bg-amber-100 text-amber-700' : 'bg-slate-100 text-slate-500'\n                                }`}>\n                                {emp.current_status === 'IN' ? 'TRABAJANDO' :\n                                    emp.current_status === 'LUNCH' ? 'EN COLACI√ìN' : 'FUERA'}\n                            </span>\n                        </motion.button>\n                    ))}\n                </div>\n            </div>\n\n            {/* Auth Modal */}\n            <AnimatePresence>\n                {selectedEmployee && authMethod && (\n                    <motion.div\n                        initial={{ opacity: 0 }}\n                        animate={{ opacity: 1 }}\n                        exit={{ opacity: 0 }}\n                        className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\"\n                    >\n                        <motion.div\n                            initial={{ scale: 0.9 }}\n                            animate={{ scale: 1 }}\n                            exit={{ scale: 0.9 }}\n                            className=\"bg-white rounded-3xl p-8 max-w-md w-full relative\"\n                        >\n                            <button\n                                onClick={() => { setSelectedEmployee(null); setAuthMethod(null); setPin(''); setMessage(null); }}\n                                className=\"absolute top-4 right-4 text-slate-400 hover:text-slate-600\"\n                            >\n                                <LogOut size={24} />\n                            </button>\n\n                            <div className=\"text-center mb-8\">\n                                <div className=\"w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-600 font-bold text-2xl\">\n                                    {selectedEmployee.name.charAt(0)}\n                                </div>\n                                <h3 className=\"text-xl font-bold text-slate-800\">Hola, {selectedEmployee.name}</h3>\n                                <p className=\"text-slate-500\">Verifica tu identidad para continuar</p>\n                            </div>\n\n                            {message && (\n                                <div className={`mb-6 p-4 rounded-xl text-center font-bold ${message.type === 'success' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\n                                    }`}>\n                                    {message.text}\n                                </div>\n                            )}\n\n                            {authMethod === 'BIOMETRIC' ? (\n                                <div className=\"space-y-6\">\n                                    <button\n                                        onClick={handleBiometricAuth}\n                                        className=\"w-full py-8 border-2 border-dashed border-blue-300 bg-blue-50 rounded-2xl flex flex-col items-center gap-3 hover:bg-blue-100 transition-colors group\"\n                                    >\n                                        <Fingerprint size={48} className=\"text-blue-500 group-hover:scale-110 transition-transform\" />\n                                        <span className=\"font-bold text-blue-700\">Tocar Sensor de Huella</span>\n                                    </button>\n\n                                    <div className=\"relative\">\n                                        <div className=\"absolute inset-0 flex items-center\"><div className=\"w-full border-t border-slate-200\"></div></div>\n                                        <div className=\"relative flex justify-center text-sm\"><span className=\"px-2 bg-white text-slate-500\">O usa tu PIN</span></div>\n                                    </div>\n\n                                    <button\n                                        onClick={() => setAuthMethod('PIN')}\n                                        className=\"w-full py-3 text-slate-600 font-bold hover:bg-slate-50 rounded-xl transition-colors\"\n                                    >\n                                        Ingresar PIN Manualmente\n                                    </button>\n                                </div>\n                            ) : (\n                                <div className=\"space-y-6\">\n                                    <div>\n                                        <label className=\"block text-sm font-bold text-slate-700 mb-2\">Ingresa tu PIN de 4 d√≠gitos</label>\n                                        <input\n                                            type=\"password\"\n                                            maxLength={4}\n                                            value={pin}\n                                            onChange={(e) => setPin(e.target.value)}\n                                            className=\"w-full text-center text-4xl tracking-widest font-bold py-4 border-2 border-slate-200 rounded-xl focus:border-blue-500 outline-none\"\n                                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                                            autoFocus\n                                        />\n                                    </div>\n                                    <button\n                                        onClick={() => {\n                                            if (pin === selectedEmployee.access_pin) {\n                                                onAuthSuccess();\n                                            } else {\n                                                setMessage({ text: 'PIN Incorrecto', type: 'error' });\n                                                setPin('');\n                                            }\n                                        }}\n                                        className=\"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold shadow-lg shadow-blue-200 transition-all\"\n                                    >\n                                        Confirmar PIN\n                                    </button>\n                                    <button\n                                        onClick={() => setAuthMethod('BIOMETRIC')}\n                                        className=\"w-full py-3 text-slate-600 font-bold hover:bg-slate-50 rounded-xl transition-colors\"\n                                    >\n                                        Volver a Huella Digital\n                                    </button>\n                                </div>\n                            )}\n                        </motion.div>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n};\n\nexport default AttendanceKioskPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7439, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/WarehouseOps.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { usePharmaStore } from '../store/useStore';\nimport { useLocationStore } from '../store/useLocationStore';\nimport { Package, Truck, ArrowRight, CheckCircle, AlertTriangle, Search, Filter, FileText, Camera, MapPin, Clock, Download, X, Calendar, ArrowUp, ArrowDown, Edit2 } from 'lucide-react';\nimport { Shipment } from '../../domain/types';\nimport UnifiedReception from '../components/warehouse/UnifiedReception';\nimport DispatchWizard from '../components/warehouse/DispatchWizard';\nimport DocumentViewerModal from '../components/warehouse/DocumentViewerModal';\nimport ScanReceptionModal from '../components/warehouse/ScanReceptionModal';\nimport { toast } from 'sonner';\n\nexport const WarehouseOps = () => {\n    const { shipments } = usePharmaStore();\n    const { currentLocation } = useLocationStore();\n    const [activeTab, setActiveTab] = useState<'INBOUND' | 'OUTBOUND' | 'TRANSIT' | 'REVERSE'>('INBOUND');\n    const [searchTerm, setSearchTerm] = useState('');\n\n    // Modal States\n    const [selectedShipment, setSelectedShipment] = useState<Shipment | null>(null);\n    const [isReceptionModalOpen, setIsReceptionModalOpen] = useState(false);\n    const [isScanReceptionOpen, setIsScanReceptionOpen] = useState(false);\n    const [isDispatchModalOpen, setIsDispatchModalOpen] = useState(false);\n    const [isDocViewerOpen, setIsDocViewerOpen] = useState(false);\n\n    // Advanced Filters State\n    const [showFilterPanel, setShowFilterPanel] = useState(false);\n    const [dateRange, setDateRange] = useState({ start: '', end: '' });\n    const [sortOrder, setSortOrder] = useState<'newest' | 'oldest'>('newest');\n\n    const isWarehouse = currentLocation?.type === 'WAREHOUSE';\n    const currentLocationId = currentLocation?.id || 'SUCURSAL_CENTRO';\n\n    // Clear all filters\n    const handleClearFilters = () => {\n        setDateRange({ start: '', end: '' });\n        setSortOrder('newest');\n        setSearchTerm('');\n        toast.success('Filtros limpiados');\n    };\n\n    // Filter Logic - LOCATION-AWARE + DATE RANGE + SORTING\n    const filteredShipments = shipments\n        .filter(s => {\n            // 1. Text Search Filter\n            const matchesSearch =\n                s.transport_data.tracking_number.includes(searchTerm) ||\n                s.origin_location_id.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                s.items.some(i => i.sku.includes(searchTerm));\n\n            if (!matchesSearch) return false;\n\n            // 2. Date Range Filter\n            let matchesDate = true;\n            const itemDate = new Date(s.created_at).getTime();\n\n            if (dateRange.start) {\n                const startDate = new Date(dateRange.start).getTime();\n                matchesDate = matchesDate && itemDate >= startDate;\n            }\n\n            if (dateRange.end) {\n                const endDate = new Date(dateRange.end);\n                endDate.setHours(23, 59, 59, 999); // Include entire end day\n                matchesDate = matchesDate && itemDate <= endDate.getTime();\n            }\n\n            if (!matchesDate) return false;\n\n            // 3. Location-based Filter (WAREHOUSE vs STORE logic)\n            if (isWarehouse) {\n                if (activeTab === 'INBOUND') return false;\n                if (activeTab === 'OUTBOUND') return s.origin_location_id === currentLocationId;\n                if (activeTab === 'TRANSIT') return s.status === 'IN_TRANSIT' && s.origin_location_id === currentLocationId;\n                if (activeTab === 'REVERSE') return s.type === 'RETURN' && s.destination_location_id === currentLocationId;\n            } else {\n                if (activeTab === 'INBOUND') return s.status === 'IN_TRANSIT' && s.destination_location_id === currentLocationId;\n                if (activeTab === 'OUTBOUND') return s.origin_location_id === currentLocationId;\n                if (activeTab === 'TRANSIT') return s.status === 'IN_TRANSIT' && s.origin_location_id === currentLocationId;\n                if (activeTab === 'REVERSE') return s.type === 'RETURN' && s.origin_location_id === currentLocationId;\n            }\n\n            return false;\n        })\n        .sort((a, b) => {\n            // 4. Chronological Sorting\n            const dateA = new Date(a.created_at).getTime();\n            const dateB = new Date(b.created_at).getTime();\n            return sortOrder === 'newest' ? dateB - dateA : dateA - dateB;\n        });\n\n    const handleReceiveClick = (shipment: Shipment) => {\n        setSelectedShipment(shipment);\n        setIsReceptionModalOpen(true);\n    };\n\n    const handleViewDocs = (shipment: Shipment) => {\n        setSelectedShipment(shipment);\n        setIsDocViewerOpen(true);\n    };\n\n    const handleEditShipment = (shipment: Shipment) => {\n        // For now, just a toast as requested in \"Entregable\" logic for Edit button\n        // Real implementation would open a modal to edit transport data\n        toast.info(`Editando env√≠o OT: ${shipment.transport_data.tracking_number}`, {\n            description: 'Funcionalidad de edici√≥n de transporte en desarrollo'\n        });\n    };\n\n    const handlePrintReport = async () => {\n        try {\n            const { default: jsPDF } = await import('jspdf');\n            const { default: autoTable } = await import('jspdf-autotable');\n\n            const doc = new jsPDF();\n\n            // Header\n            doc.setFontSize(18);\n            doc.setFont('helvetica', 'bold');\n            doc.text('Informe de Movimientos de Bodega', 14, 20);\n\n            doc.setFontSize(10);\n            doc.setFont('helvetica', 'normal');\n            doc.text(`Fecha: ${new Date().toLocaleDateString('es-CL')}`, 14, 28);\n            doc.text(`Hora: ${new Date().toLocaleTimeString('es-CL')}`, 14, 33);\n\n            // Prepare table data from ALL shipments (not just filtered) for the day\n            const todayStart = new Date();\n            todayStart.setHours(0, 0, 0, 0);\n\n            const dailyShipments = shipments.filter(s => s.created_at >= todayStart.getTime());\n\n            const tableData = dailyShipments.map(s => [\n                new Date(s.created_at).toLocaleTimeString('es-CL'),\n                s.type === 'INBOUND_PROVIDER' ? 'Entrada' : s.type === 'INTERNAL_TRANSFER' ? 'Transferencia' : 'Devoluci√≥n',\n                `${s.origin_location_id} ‚Üí ${s.destination_location_id}`,\n                s.status.replace('_', ' '),\n                s.transport_data.package_count.toString(),\n                `$${s.valuation.toLocaleString('es-CL')}`\n            ]);\n\n            // Add table\n            autoTable(doc, {\n                startY: 40,\n                head: [['Hora', 'Tipo', 'Ruta', 'Estado', 'Bultos', 'Valorizaci√≥n']],\n                body: tableData,\n                theme: 'grid',\n                headStyles: { fillColor: [59, 130, 246], textColor: 255, fontStyle: 'bold' },\n                styles: { fontSize: 9, cellPadding: 3 },\n            });\n\n            // Footer\n            const pageCount = doc.internal.pages.length - 1;\n            doc.setFontSize(8);\n            doc.text(`Total de registros hoy: ${dailyShipments.length}`, 14, doc.internal.pageSize.height - 10);\n            doc.text(`P√°gina 1 de ${pageCount}`, doc.internal.pageSize.width - 40, doc.internal.pageSize.height - 10);\n\n            // Save\n            doc.save(`informe-bodega-${new Date().toISOString().split('T')[0]}.pdf`);\n            toast.success('Reporte PDF generado exitosamente');\n        } catch (error) {\n            console.error('Error generating PDF:', error);\n            toast.error('Error al generar el reporte PDF');\n        }\n    };\n\n    return (\n        <div className=\"p-6 space-y-6 h-[calc(100vh-80px)] overflow-y-auto\">\n            <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-2xl font-bold text-gray-800 flex items-center gap-2\">\n                    <Package className=\"w-8 h-8 text-blue-600\" />\n                    Operaciones Log√≠sticas (WMS)\n                </h1>\n                <div className=\"flex gap-2\">\n                    <button\n                        onClick={() => setIsScanReceptionOpen(true)}\n                        className=\"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2 font-bold text-sm shadow-lg shadow-cyan-200\"\n                    >\n                        <Camera className=\"w-4 h-4\" />\n                        Recepci√≥n Esc√°ner\n                    </button>\n                    <button\n                        onClick={handlePrintReport}\n                        className=\"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 flex items-center gap-2 font-bold text-sm\"\n                    >\n                        <FileText className=\"w-4 h-4\" />\n                        Reportes\n                    </button>\n                    <button\n                        onClick={() => setIsDispatchModalOpen(true)}\n                        className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 font-bold text-sm shadow-lg shadow-blue-200\"\n                    >\n                        <Truck className=\"w-4 h-4\" />\n                        Nuevo Despacho\n                    </button>\n                </div>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"flex gap-4 border-b border-gray-200\">\n                <button\n                    onClick={() => setActiveTab('INBOUND')}\n                    className={`pb-3 px-4 font-bold text-sm flex items-center gap-2 transition-colors ${activeTab === 'INBOUND' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n                >\n                    <ArrowRight className=\"w-4 h-4 rotate-90\" />\n                    Recepci√≥n (Inbound)\n                    {shipments.filter(s => s.status === 'IN_TRANSIT' && s.destination_location_id === currentLocationId).length > 0 && (\n                        <span className=\"bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full\">\n                            {shipments.filter(s => s.status === 'IN_TRANSIT' && s.destination_location_id === currentLocationId).length}\n                        </span>\n                    )}\n                </button>\n                <button\n                    onClick={() => setActiveTab('OUTBOUND')}\n                    className={`pb-3 px-4 font-bold text-sm flex items-center gap-2 transition-colors ${activeTab === 'OUTBOUND' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n                >\n                    <ArrowRight className=\"w-4 h-4 -rotate-90\" />\n                    Despacho (Outbound)\n                </button>\n                <button\n                    onClick={() => setActiveTab('TRANSIT')}\n                    className={`pb-3 px-4 font-bold text-sm flex items-center gap-2 transition-colors ${activeTab === 'TRANSIT' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n                >\n                    <Truck className=\"w-4 h-4\" />\n                    En Tr√°nsito\n                </button>\n                <button\n                    onClick={() => setActiveTab('REVERSE')}\n                    className={`pb-3 px-4 font-bold text-sm flex items-center gap-2 transition-colors ${activeTab === 'REVERSE' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n                >\n                    <AlertTriangle className=\"w-4 h-4\" />\n                    Log√≠stica Inversa\n                </button>\n            </div>\n\n            {/* Search & Filter Bar */}\n            <div className=\"space-y-2\">\n                <div className=\"flex gap-4 bg-white p-4 rounded-xl shadow-sm border border-gray-100\">\n                    <div className=\"relative flex-1\">\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5\" />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Buscar por OT, Proveedor o SKU...\"\n                            className=\"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-medium text-sm\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                    </div>\n                    <button\n                        onClick={() => setShowFilterPanel(!showFilterPanel)}\n                        className={`px-4 py-2 border rounded-lg flex items-center gap-2 font-bold text-sm transition-all ${showFilterPanel\n                            ? 'bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-200'\n                            : 'border-gray-200 hover:bg-gray-50 text-gray-600'\n                            }`}\n                    >\n                        <Filter className=\"w-4 h-4\" />\n                        Filtros\n                        {(dateRange.start || dateRange.end) && (\n                            <span className=\"bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full\">\n                                {[dateRange.start, dateRange.end].filter(Boolean).length}\n                            </span>\n                        )}\n                    </button>\n                </div>\n\n                {/* Advanced Filter Panel */}\n                {showFilterPanel && (\n                    <div className=\"bg-white p-4 rounded-xl shadow-lg border border-slate-200 space-y-4\">\n                        <div className=\"flex items-center justify-between\">\n                            <h3 className=\"font-bold text-gray-900 flex items-center gap-2\">\n                                <Filter className=\"w-4 h-4 text-blue-600\" />\n                                Filtros Avanzados\n                            </h3>\n                            <button\n                                onClick={() => setShowFilterPanel(false)}\n                                className=\"text-gray-400 hover:text-gray-600\"\n                            >\n                                <X className=\"w-5 h-5\" />\n                            </button>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                            {/* Date Range */}\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    <Calendar className=\"w-4 h-4 inline mr-1\" />\n                                    Desde\n                                </label>\n                                <input\n                                    type=\"date\"\n                                    value={dateRange.start}\n                                    onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    <Calendar className=\"w-4 h-4 inline mr-1\" />\n                                    Hasta\n                                </label>\n                                <input\n                                    type=\"date\"\n                                    value={dateRange.end}\n                                    onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm\"\n                                />\n                            </div>\n\n                            {/* Sort Order */}\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    <Clock className=\"w-4 h-4 inline mr-1\" />\n                                    Ordenar por Fecha\n                                </label>\n                                <div className=\"flex gap-2\">\n                                    <button\n                                        onClick={() => setSortOrder('newest')}\n                                        className={`flex-1 px-3 py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-1 transition-all ${sortOrder === 'newest'\n                                            ? 'bg-blue-600 text-white shadow-md'\n                                            : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                                            }`}\n                                    >\n                                        <ArrowDown className=\"w-4 h-4\" />\n                                        Recientes\n                                    </button>\n                                    <button\n                                        onClick={() => setSortOrder('oldest')}\n                                        className={`flex-1 px-3 py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-1 transition-all ${sortOrder === 'oldest'\n                                            ? 'bg-blue-600 text-white shadow-md'\n                                            : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                                            }`}\n                                    >\n                                        <ArrowUp className=\"w-4 h-4\" />\n                                        Antiguos\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Action Buttons */}\n                        <div className=\"flex justify-between items-center pt-2 border-t border-gray-200\">\n                            <div className=\"text-xs text-gray-600\">\n                                {filteredShipments.length} resultado(s) encontrado(s)\n                            </div>\n                            <div className=\"flex gap-2\">\n                                <button\n                                    onClick={handleClearFilters}\n                                    className=\"px-4 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\"\n                                >\n                                    Limpiar Filtros\n                                </button>\n                                <button\n                                    onClick={() => setShowFilterPanel(false)}\n                                    className=\"px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n                                >\n                                    Aplicar\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </div>\n\n            {/* Content Area */}\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 min-h-[400px] p-6\">\n                {activeTab === 'TRANSIT' && (\n                    <div className=\"mb-6 bg-blue-50 border border-blue-100 p-4 rounded-xl flex items-center justify-between\">\n                        <div className=\"flex items-center gap-3\">\n                            <div className=\"bg-blue-100 p-2 rounded-lg\">\n                                <Truck className=\"text-blue-600\" size={24} />\n                            </div>\n                            <div>\n                                <p className=\"text-xs font-bold text-blue-600 uppercase\">Valorizaci√≥n en Ruta</p>\n                                <p className=\"text-2xl font-extrabold text-blue-900\">\n                                    ${filteredShipments.reduce((sum, s) => sum + s.valuation, 0).toLocaleString()}\n                                </p>\n                            </div>\n                        </div>\n                        <div className=\"text-right\">\n                            <p className=\"text-xs font-bold text-blue-400 uppercase\">Env√≠os Activos</p>\n                            <p className=\"text-xl font-bold text-blue-800\">{filteredShipments.length}</p>\n                        </div>\n                    </div>\n                )}\n\n                {filteredShipments.length === 0 ? (\n                    <div className=\"text-center py-12 text-gray-400\">\n                        <Package className=\"w-16 h-16 mx-auto mb-4 opacity-20\" />\n                        <h3 className=\"text-lg font-bold text-gray-500\">No hay registros encontrados</h3>\n                        <p className=\"text-sm\">Intente ajustar los filtros o cree una nueva operaci√≥n.</p>\n                    </div>\n                ) : (\n                    <div className=\"grid gap-4\">\n                        {filteredShipments.map(shipment => (\n                            <div key={shipment.id} className=\"border border-gray-200 rounded-xl p-5 hover:shadow-md transition-all bg-white group\">\n                                <div className=\"flex justify-between items-start mb-4\">\n                                    <div className=\"flex items-start gap-4\">\n                                        <div className={`p-3 rounded-xl ${shipment.type === 'INBOUND_PROVIDER' ? 'bg-purple-100 text-purple-600' : 'bg-blue-100 text-blue-600'}`}>\n                                            {shipment.type === 'INBOUND_PROVIDER' ? <Package size={24} /> : <Truck size={24} />}\n                                        </div>\n                                        <div>\n                                            <div className=\"flex items-center gap-2 mb-1\">\n                                                <span className=\"font-bold text-lg text-gray-800\">OT: {shipment.transport_data.tracking_number}</span>\n                                                <span className={`px-2 py-0.5 text-[10px] font-bold rounded-full uppercase tracking-wide\n                                                    ${shipment.status === 'IN_TRANSIT' ? 'bg-amber-100 text-amber-700' :\n                                                        shipment.status === 'DELIVERED' ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-600'}`}>\n                                                    {shipment.status.replace('_', ' ')}\n                                                </span>\n                                            </div>\n                                            <div className=\"flex items-center gap-4 text-sm text-gray-500\">\n                                                <div className=\"flex items-center gap-1\">\n                                                    <MapPin size={14} />\n                                                    <span>{shipment.origin_location_id}</span>\n                                                    <ArrowRight size={14} className=\"mx-1\" />\n                                                    <span className=\"font-bold text-gray-700\">{shipment.destination_location_id}</span>\n                                                </div>\n                                                <div className=\"flex items-center gap-1\">\n                                                    <Clock size={14} />\n                                                    <span>{new Date(shipment.created_at).toLocaleDateString()}</span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div className=\"text-right\">\n                                        <p className=\"text-xs font-bold text-gray-400 uppercase\">Transporte</p>\n                                        <div className=\"flex items-center justify-end gap-2\">\n                                            <p className=\"font-bold text-gray-700\">{shipment.transport_data.carrier}</p>\n                                            {activeTab === 'TRANSIT' && (\n                                                <button\n                                                    onClick={() => handleEditShipment(shipment)}\n                                                    className=\"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors\"\n                                                    title=\"Editar Transporte\"\n                                                >\n                                                    <Edit2 size={12} />\n                                                </button>\n                                            )}\n                                        </div>\n                                        <p className=\"text-xs text-gray-500\">{shipment.transport_data.package_count} Bultos</p>\n                                    </div>\n                                </div>\n\n                                <div className=\"bg-gray-50 rounded-lg p-3 mb-4 flex items-center gap-4 overflow-x-auto\">\n                                    {shipment.items.slice(0, 5).map((item, idx) => (\n                                        <div key={idx} className=\"flex-shrink-0 bg-white border border-gray-200 px-3 py-1.5 rounded-md shadow-sm\">\n                                            <p className=\"text-xs font-bold text-gray-700\">{item.name}</p>\n                                            <p className=\"text-[10px] text-gray-400\">Cant: {item.quantity}</p>\n                                        </div>\n                                    ))}\n                                    {shipment.items.length > 5 && (\n                                        <span className=\"text-xs font-bold text-gray-400\">+{shipment.items.length - 5} m√°s...</span>\n                                    )}\n                                </div>\n\n                                <div className=\"flex justify-end gap-3 pt-2 border-t border-gray-100\">\n                                    <button\n                                        onClick={() => handleViewDocs(shipment)}\n                                        className=\"px-4 py-2 text-sm font-bold text-gray-500 hover:bg-gray-50 rounded-lg transition-colors flex items-center gap-2\"\n                                    >\n                                        <FileText size={16} /> Ver Documentos\n                                    </button>\n                                    {activeTab === 'INBOUND' && shipment.status === 'IN_TRANSIT' && (\n                                        <button\n                                            onClick={() => handleReceiveClick(shipment)}\n                                            className=\"px-4 py-2 text-sm font-bold bg-emerald-600 text-white hover:bg-emerald-700 rounded-lg shadow-md shadow-emerald-100 flex items-center gap-2 transition-all transform hover:scale-105\"\n                                        >\n                                            <CheckCircle size={16} />\n                                            Recepcionar Carga\n                                        </button>\n                                    )}\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n\n            {/* Modals */}\n            {selectedShipment && (\n                <UnifiedReception\n                    isOpen={isReceptionModalOpen}\n                    onClose={() => { setIsReceptionModalOpen(false); setSelectedShipment(null); }}\n                    shipment={selectedShipment}\n                />\n            )}\n\n            {selectedShipment && (\n                <DocumentViewerModal\n                    isOpen={isDocViewerOpen}\n                    onClose={() => { setIsDocViewerOpen(false); setSelectedShipment(null); }}\n                    shipment={selectedShipment}\n                />\n            )}\n\n            <ScanReceptionModal\n                isOpen={isScanReceptionOpen}\n                onClose={() => setIsScanReceptionOpen(false)}\n            />\n\n            <DispatchWizard\n                isOpen={isDispatchModalOpen}\n                onClose={() => setIsDispatchModalOpen(false)}\n            />\n        </div>\n    );\n};\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8641, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/SuppliersPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { usePharmaStore } from '../store/useStore';\nimport { Search, Plus, Filter, Building2, Phone, Mail, CreditCard, Star, ChevronRight } from 'lucide-react';\nimport { Link } from 'react-router-dom';\nimport AddSupplierModal from '../components/suppliers/AddSupplierModal';\nimport { toast } from 'sonner';\n\nexport const SuppliersPage = () => {\n    const { suppliers, addSupplier } = usePharmaStore();\n    const [searchTerm, setSearchTerm] = useState('');\n    const [categoryFilter, setCategoryFilter] = useState<string>('ALL');\n    const [isAddModalOpen, setIsAddModalOpen] = useState(false);\n\n    const filteredSuppliers = suppliers.filter(supplier => {\n        const matchesSearch =\n            supplier.business_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n            supplier.fantasy_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n            supplier.rut.includes(searchTerm);\n\n        const matchesCategory = categoryFilter === 'ALL' || supplier.categories.includes(categoryFilter as any);\n\n        return matchesSearch && matchesCategory;\n    });\n\n    const handleSaveSupplier = (supplierData: any) => {\n        addSupplier(supplierData);\n        toast.success(`‚úÖ Proveedor ${supplierData.fantasy_name} registrado exitosamente`);\n    };\n\n    return (\n        <div className=\"p-6 space-y-6 bg-slate-50 min-h-screen\">\n            {/* Header */}\n            <div className=\"flex justify-between items-center\">\n                <div>\n                    <h1 className=\"text-2xl font-bold text-slate-800\">Directorio de Proveedores</h1>\n                    <p className=\"text-slate-500\">Gesti√≥n 360¬∞ de laboratorios y distribuidores</p>\n                </div>\n                <button\n                    onClick={() => setIsAddModalOpen(true)}\n                    className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors shadow-sm\"\n                >\n                    <Plus size={20} />\n                    Nuevo Proveedor\n                </button>\n            </div>\n\n            {/* Add Supplier Modal */}\n            <AddSupplierModal\n                isOpen={isAddModalOpen}\n                onClose={() => setIsAddModalOpen(false)}\n                onSave={handleSaveSupplier}\n            />\n\n            {/* Filters */}\n            <div className=\"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex flex-col md:flex-row gap-4 items-center\">\n                <div className=\"relative flex-1 w-full\">\n                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={20} />\n                    <input\n                        type=\"text\"\n                        placeholder=\"Buscar por nombre, RUT o fantas√≠a...\"\n                        className=\"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all\"\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                    />\n                </div>\n                <div className=\"flex gap-2 w-full md:w-auto overflow-x-auto\">\n                    {['ALL', 'MEDICAMENTOS', 'INSUMOS', 'RETAIL'].map(cat => (\n                        <button\n                            key={cat}\n                            onClick={() => setCategoryFilter(cat)}\n                            className={`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-colors ${categoryFilter === cat\n                                ? 'bg-blue-100 text-blue-700 border border-blue-200'\n                                : 'bg-white text-slate-600 border border-slate-200 hover:bg-slate-50'\n                                }`}\n                        >\n                            {cat === 'ALL' ? 'Todos' : cat}\n                        </button>\n                    ))}\n                </div>\n            </div>\n\n            {/* Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {filteredSuppliers.map(supplier => (\n                    <Link\n                        to={`/suppliers/${supplier.id}`}\n                        key={supplier.id}\n                        className=\"group bg-white rounded-xl shadow-sm border border-slate-200 hover:shadow-md hover:border-blue-300 transition-all duration-200 overflow-hidden flex flex-col\"\n                    >\n                        <div className=\"p-5 flex-1\">\n                            <div className=\"flex justify-between items-start mb-4\">\n                                <div className=\"flex items-center gap-3\">\n                                    <div className=\"w-12 h-12 bg-slate-100 rounded-lg flex items-center justify-center text-slate-400\">\n                                        {supplier.logo_url ? (\n                                            <img src={supplier.logo_url} alt={supplier.fantasy_name} className=\"w-full h-full object-contain rounded-lg\" />\n                                        ) : (\n                                            <Building2 size={24} />\n                                        )}\n                                    </div>\n                                    <div>\n                                        <h3 className=\"font-bold text-slate-800 group-hover:text-blue-600 transition-colors\">{supplier.fantasy_name}</h3>\n                                        <p className=\"text-xs text-slate-500\">{supplier.business_name}</p>\n                                    </div>\n                                </div>\n                                <div className=\"flex items-center gap-1 bg-yellow-50 px-2 py-1 rounded text-yellow-700 text-xs font-bold\">\n                                    <Star size={12} className=\"fill-yellow-500 text-yellow-500\" />\n                                    {supplier.rating}.0\n                                </div>\n                            </div>\n\n                            <div className=\"space-y-2 text-sm text-slate-600\">\n                                <div className=\"flex items-center gap-2\">\n                                    <CreditCard size={16} className=\"text-slate-400\" />\n                                    <span>{supplier.rut}</span>\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                    <Mail size={16} className=\"text-slate-400\" />\n                                    <span className=\"truncate\">{supplier.contact_email}</span>\n                                </div>\n                                <div className=\"flex flex-wrap gap-2 mt-3\">\n                                    {supplier.categories.map(cat => (\n                                        <span key={cat} className=\"px-2 py-0.5 bg-slate-100 text-slate-600 text-xs rounded-full border border-slate-200\">\n                                            {cat}\n                                        </span>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"bg-slate-50 px-5 py-3 border-t border-slate-100 flex justify-between items-center\">\n                            <div className=\"text-xs text-slate-500\">\n                                <span className=\"block font-medium text-slate-700\">Condici√≥n Pago</span>\n                                {supplier.payment_terms.replace('_', ' ')}\n                            </div>\n                            <div className=\"flex items-center gap-1 text-blue-600 text-sm font-medium\">\n                                Ver Perfil <ChevronRight size={16} />\n                            </div>\n                        </div>\n                    </Link>\n                ))}\n            </div>\n        </div>\n    );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9050, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/SupplierProfile.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport { usePharmaStore } from '../store/useStore';\nimport {\n    ArrowLeft, Building2, Mail, Phone, Globe, MapPin,\n    FileText, CreditCard, History, Package, AlertCircle, CheckCircle, Clock\n} from 'lucide-react';\n\nexport const SupplierProfile = () => {\n    const { id } = useParams();\n    const { suppliers, purchaseOrders, supplierDocuments } = usePharmaStore();\n    const [activeTab, setActiveTab] = useState<'PROFILE' | 'HISTORY' | 'ACCOUNT' | 'PRODUCTS'>('PROFILE');\n\n    const supplier = suppliers.find(s => s.id === id);\n\n    if (!supplier) {\n        return (\n            <div className=\"p-10 text-center\">\n                <h2 className=\"text-xl font-bold text-gray-800\">Proveedor no encontrado</h2>\n                <Link to=\"/suppliers\" className=\"text-blue-600 hover:underline mt-2 block\">Volver al directorio</Link>\n            </div>\n        );\n    }\n\n    // --- Mock Data Helpers ---\n    const supplierOrders = purchaseOrders.filter(po => po.supplier_id === id);\n    const supplierDocs = supplierDocuments.filter(d => d.supplier_id === id);\n\n    // Calculate Debt\n    const totalDebt = supplierDocs\n        .filter(d => d.type === 'FACTURA' && d.status === 'PENDING')\n        .reduce((sum, d) => sum + d.amount, 0);\n\n    return (\n        <div className=\"min-h-screen bg-slate-50\">\n            {/* Header / Hero */}\n            <div className=\"bg-white border-b border-slate-200 shadow-sm\">\n                <div className=\"max-w-7xl mx-auto px-6 py-6\">\n                    <Link to=\"/suppliers\" className=\"inline-flex items-center text-slate-500 hover:text-slate-800 mb-4 transition-colors\">\n                        <ArrowLeft size={16} className=\"mr-1\" /> Volver al Directorio\n                    </Link>\n\n                    <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\n                        <div className=\"flex items-center gap-4\">\n                            <div className=\"w-16 h-16 bg-slate-100 rounded-xl flex items-center justify-center border border-slate-200\">\n                                {supplier.logo_url ? (\n                                    <img src={supplier.logo_url} alt={supplier.fantasy_name} className=\"w-full h-full object-contain rounded-xl\" />\n                                ) : (\n                                    <Building2 size={32} className=\"text-slate-400\" />\n                                )}\n                            </div>\n                            <div>\n                                <h1 className=\"text-2xl font-bold text-slate-900\">{supplier.fantasy_name}</h1>\n                                <div className=\"flex items-center gap-2 text-slate-500 text-sm\">\n                                    <span>{supplier.business_name}</span>\n                                    <span className=\"w-1 h-1 bg-slate-300 rounded-full\"></span>\n                                    <span>{supplier.rut}</span>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"flex gap-3\">\n                            <div className=\"text-right px-4 py-2 bg-red-50 border border-red-100 rounded-lg\">\n                                <p className=\"text-xs text-red-600 font-semibold uppercase\">Deuda Actual</p>\n                                <p className=\"text-xl font-bold text-red-700\">${totalDebt.toLocaleString()}</p>\n                            </div>\n                            <div className=\"text-right px-4 py-2 bg-blue-50 border border-blue-100 rounded-lg\">\n                                <p className=\"text-xs text-blue-600 font-semibold uppercase\">Lead Time</p>\n                                <p className=\"text-xl font-bold text-blue-700\">{supplier.lead_time_days} D√≠as</p>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Tabs */}\n                    <div className=\"flex gap-6 mt-8 border-b border-slate-200\">\n                        {[\n                            { id: 'PROFILE', label: 'Perfil & Contacto', icon: Building2 },\n                            { id: 'HISTORY', label: 'Historial Pedidos', icon: History },\n                            { id: 'ACCOUNT', label: 'Cuenta Corriente', icon: CreditCard },\n                            { id: 'PRODUCTS', label: 'Productos', icon: Package },\n                        ].map(tab => (\n                            <button\n                                key={tab.id}\n                                onClick={() => setActiveTab(tab.id as any)}\n                                className={`pb-3 px-2 flex items-center gap-2 font-medium text-sm transition-colors relative ${activeTab === tab.id\n                                    ? 'text-blue-600'\n                                    : 'text-slate-500 hover:text-slate-700'\n                                    }`}\n                            >\n                                <tab.icon size={18} />\n                                {tab.label}\n                                {activeTab === tab.id && (\n                                    <span className=\"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 rounded-t-full\"></span>\n                                )}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n            </div>\n\n            {/* Content */}\n            <div className=\"max-w-7xl mx-auto px-6 py-8\">\n                {activeTab === 'PROFILE' && (\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n                        {/* Main Info */}\n                        <div className=\"lg:col-span-2 space-y-6\">\n                            <div className=\"bg-white p-6 rounded-xl shadow-sm border border-slate-200\">\n                                <h3 className=\"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2\">\n                                    <Building2 size={20} className=\"text-blue-600\" />\n                                    Informaci√≥n Comercial\n                                </h3>\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    <div>\n                                        <label className=\"block text-xs font-semibold text-slate-500 uppercase mb-1\">Raz√≥n Social</label>\n                                        <p className=\"text-slate-800 font-medium\">{supplier.business_name}</p>\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-semibold text-slate-500 uppercase mb-1\">RUT</label>\n                                        <p className=\"text-slate-800 font-medium\">{supplier.rut}</p>\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-semibold text-slate-500 uppercase mb-1\">Sitio Web</label>\n                                        <a href={supplier.website} target=\"_blank\" rel=\"noreferrer\" className=\"text-blue-600 hover:underline flex items-center gap-1\">\n                                            {supplier.website || 'No registrado'} <Globe size={14} />\n                                        </a>\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-semibold text-slate-500 uppercase mb-1\">Condici√≥n de Pago</label>\n                                        <span className=\"inline-block px-2 py-1 bg-slate-100 rounded text-slate-700 text-sm font-medium\">\n                                            {supplier.payment_terms.replace('_', ' ')}\n                                        </span>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div className=\"bg-white p-6 rounded-xl shadow-sm border border-slate-200\">\n                                <h3 className=\"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2\">\n                                    <CreditCard size={20} className=\"text-blue-600\" />\n                                    Datos Bancarios\n                                </h3>\n                                {supplier.bank_account ? (\n                                    <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200\">\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            <div>\n                                                <p className=\"text-xs text-slate-500\">Banco</p>\n                                                <p className=\"font-medium text-slate-800\">{supplier.bank_account.bank}</p>\n                                            </div>\n                                            <div>\n                                                <p className=\"text-xs text-slate-500\">Tipo Cuenta</p>\n                                                <p className=\"font-medium text-slate-800\">{supplier.bank_account.account_type}</p>\n                                            </div>\n                                            <div>\n                                                <p className=\"text-xs text-slate-500\">N√∫mero</p>\n                                                <p className=\"font-mono font-medium text-slate-800\">{supplier.bank_account.account_number}</p>\n                                            </div>\n                                            <div>\n                                                <p className=\"text-xs text-slate-500\">Email Notificaci√≥n</p>\n                                                <p className=\"font-medium text-slate-800\">{supplier.bank_account.email_notification}</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                ) : (\n                                    <div className=\"text-slate-500 italic\">No hay datos bancarios registrados.</div>\n                                )}\n                            </div>\n                        </div>\n\n                        {/* Contacts Sidebar */}\n                        <div className=\"space-y-6\">\n                            <div className=\"bg-white p-6 rounded-xl shadow-sm border border-slate-200\">\n                                <h3 className=\"text-lg font-bold text-slate-800 mb-4\">Contactos</h3>\n                                <div className=\"space-y-4\">\n                                    {supplier.contacts.map((contact, idx) => (\n                                        <div key={idx} className=\"pb-4 border-b border-slate-100 last:border-0 last:pb-0\">\n                                            <div className=\"flex justify-between items-start\">\n                                                <p className=\"font-bold text-slate-800\">{contact.name}</p>\n                                                {contact.is_primary && (\n                                                    <span className=\"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] font-bold rounded-full\">PRINCIPAL</span>\n                                                )}\n                                            </div>\n                                            <p className=\"text-xs text-slate-500 mb-2\">{contact.role}</p>\n                                            <div className=\"space-y-1\">\n                                                <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n                                                    <Mail size={14} /> <a href={`mailto:${contact.email}`} className=\"hover:text-blue-600\">{contact.email}</a>\n                                                </div>\n                                                <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n                                                    <Phone size={14} /> <span>{contact.phone}</span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    ))}\n                                    {supplier.contacts.length === 0 && (\n                                        <p className=\"text-slate-500 text-sm\">No hay contactos registrados.</p>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n                {activeTab === 'HISTORY' && (\n                    <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden\">\n                        <table className=\"w-full text-left text-sm\">\n                            <thead className=\"bg-slate-50 text-slate-500 font-medium border-b border-slate-200\">\n                                <tr>\n                                    <th className=\"px-6 py-4\">ID Orden</th>\n                                    <th className=\"px-6 py-4\">Fecha</th>\n                                    <th className=\"px-6 py-4\">Estado</th>\n                                    <th className=\"px-6 py-4 text-right\">Monto</th>\n                                    <th className=\"px-6 py-4 text-center\">Acciones</th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"divide-y divide-slate-100\">\n                                {supplierOrders.length > 0 ? supplierOrders.map(po => (\n                                    <tr key={po.id} className=\"hover:bg-slate-50\">\n                                        <td className=\"px-6 py-4 font-medium text-slate-900\">{po.id}</td>\n                                        <td className=\"px-6 py-4 text-slate-600\">{new Date(po.created_at).toLocaleDateString()}</td>\n                                        <td className=\"px-6 py-4\">\n                                            <span className={`px-2 py-1 rounded-full text-xs font-bold ${po.status === 'COMPLETED' ? 'bg-green-100 text-green-700' :\n                                                po.status === 'SENT' ? 'bg-yellow-100 text-yellow-700' :\n                                                    'bg-slate-100 text-slate-700'\n                                                }`}>\n                                                {po.status}\n                                            </span>\n                                        </td>\n                                        <td className=\"px-6 py-4 text-right font-medium text-slate-900\">\n                                            ${po.total_estimated.toLocaleString()}\n                                        </td>\n                                        <td className=\"px-6 py-4 text-center\">\n                                            <button className=\"text-blue-600 hover:text-blue-800 font-medium text-xs\">Ver Detalle</button>\n                                        </td>\n                                    </tr>\n                                )) : (\n                                    <tr>\n                                        <td colSpan={5} className=\"px-6 py-12 text-center text-slate-500\">\n                                            No hay √≥rdenes de compra registradas.\n                                        </td>\n                                    </tr>\n                                )}\n                            </tbody>\n                        </table>\n                    </div>\n                )}\n\n                {activeTab === 'ACCOUNT' && (\n                    <div className=\"space-y-6\">\n                        <div className=\"flex justify-end\">\n                            <button className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 text-sm font-medium\">\n                                <PlusIcon /> Nueva Factura / NC\n                            </button>\n                        </div>\n                        <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden\">\n                            <div className=\"p-8 text-center text-slate-500\">\n                                <FileText size={48} className=\"mx-auto mb-4 text-slate-300\" />\n                                <p>M√≥dulo de Cuenta Corriente en construcci√≥n.</p>\n                                <p className=\"text-sm mt-2\">Aqu√≠ se mostrar√°n Facturas y Notas de Cr√©dito.</p>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n                {activeTab === 'PRODUCTS' && (\n                    <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center text-slate-500\">\n                        <Package size={48} className=\"mx-auto mb-4 text-slate-300\" />\n                        <p>Cat√°logo de productos del proveedor.</p>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nconst PlusIcon = () => (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>\n);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10129, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/NetworkPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useLocationStore } from '../store/useLocationStore';\nimport { usePharmaStore } from '../store/useStore';\nimport { MapPin, Warehouse, Store, Plus, Tablet, QrCode, Settings, CheckCircle, XCircle, Users, Shield, ArrowRightLeft, UserPlus, Monitor } from 'lucide-react';\nimport { Location, EmployeeProfile } from '../../domain/types';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst NetworkPage = () => {\n    const { locations, kiosks, currentLocation, addLocation, switchLocation, generatePairingCode } = useLocationStore();\n    const { employees, user } = usePharmaStore(); // Need employees for Team Mgmt\n    const [activeTab, setActiveTab] = useState<'BRANCHES' | 'TEAMS' | 'DEVICES' | 'MANAGERS'>('BRANCHES');\n\n    // Wizard State\n    const [isWizardOpen, setIsWizardOpen] = useState(false);\n    const [newLocation, setNewLocation] = useState<Partial<Location>>({ type: 'STORE', name: '', address: '' });\n    const [pairingCode, setPairingCode] = useState<string | null>(null);\n\n    // Manager Promotion State\n    const [promotionTarget, setPromotionTarget] = useState<EmployeeProfile | null>(null);\n    const [managerPin, setManagerPin] = useState('');\n\n    const handleCreateLocation = () => {\n        if (!newLocation.name || !newLocation.address) return;\n\n        const location: Location = {\n            id: `LOC-${Date.now()}`,\n            type: newLocation.type as any,\n            name: newLocation.name!,\n            address: newLocation.address!,\n            associated_kiosks: []\n        };\n\n        addLocation(location);\n        setIsWizardOpen(false);\n        setNewLocation({ type: 'STORE', name: '', address: '' });\n    };\n\n    const handleGenerateCode = (kioskId: string) => {\n        const code = generatePairingCode(kioskId);\n        setPairingCode(code);\n    };\n\n    // --- RENDERERS ---\n\n    const renderBranches = () => (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 overflow-y-auto pb-20\">\n            {locations.map(location => (\n                <div key={location.id} className=\"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden group hover:shadow-md transition-all\">\n                    <div className=\"p-6 border-b border-slate-100 flex justify-between items-start\">\n                        <div className=\"flex items-start gap-3\">\n                            <div className={`p-3 rounded-xl ${location.type === 'WAREHOUSE' ? 'bg-orange-100 text-orange-600' : 'bg-blue-100 text-blue-600'}`}>\n                                {location.type === 'WAREHOUSE' ? <Warehouse size={24} /> : <Store size={24} />}\n                            </div>\n                            <div>\n                                <h3 className=\"font-bold text-slate-800 text-lg\">{location.name}</h3>\n                                <p className=\"text-xs text-slate-500 font-medium\">{location.type === 'HQ' ? 'Casa Matriz' : location.type === 'WAREHOUSE' ? 'Bodega' : 'Sucursal'}</p>\n                            </div>\n                        </div>\n                        <button className=\"text-slate-300 hover:text-slate-600 transition-colors\">\n                            <Settings size={18} />\n                        </button>\n                    </div>\n\n                    {/* KPIs */}\n                    <div className=\"grid grid-cols-3 gap-2 p-4 border-b border-slate-100 bg-slate-50/50\">\n                        <div className=\"text-center\">\n                            <p className=\"text-xs text-slate-400 font-bold\">VENTAS</p>\n                            <p className=\"text-sm font-bold text-slate-700\">$1.2M</p>\n                        </div>\n                        <div className=\"text-center border-l border-slate-200\">\n                            <p className=\"text-xs text-slate-400 font-bold\">PERSONAL</p>\n                            <p className=\"text-sm font-bold text-slate-700\">\n                                {employees.filter(e => e.assigned_location_id === location.id || (!e.assigned_location_id && e.base_location_id === location.id)).length}\n                            </p>\n                        </div>\n                        <div className=\"text-center border-l border-slate-200\">\n                            <p className=\"text-xs text-slate-400 font-bold\">ALERTAS</p>\n                            <p className=\"text-sm font-bold text-red-500\">3</p>\n                        </div>\n                    </div>\n\n                    <div className=\"p-6 space-y-4\">\n                        <div>\n                            <p className=\"text-xs font-bold text-slate-400 uppercase mb-1\">Direcci√≥n</p>\n                            <p className=\"text-sm text-slate-600 flex items-center gap-1\">\n                                <MapPin size={14} /> {location.address}\n                            </p>\n                        </div>\n                    </div>\n\n                    <div className=\"bg-slate-50 p-4 border-t border-slate-100 flex justify-between items-center\">\n                        <span className=\"text-xs font-bold text-slate-500\">ID: {location.id}</span>\n                        {currentLocation?.id === location.id && (\n                            <span className=\"flex items-center gap-1 text-xs font-bold text-emerald-600 bg-emerald-100 px-2 py-1 rounded-full\">\n                                <CheckCircle size={12} /> Contexto Activo\n                            </span>\n                        )}\n                    </div>\n                </div>\n            ))}\n        </div>\n    );\n\n    const renderTeams = () => (\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 h-full\">\n            {/* Source: Available / Other Locations */}\n            <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 flex flex-col\">\n                <h3 className=\"font-bold text-slate-800 mb-4 flex items-center gap-2\">\n                    <Users className=\"text-slate-400\" /> Personal Disponible (Global)\n                </h3>\n                <div className=\"flex-1 overflow-y-auto space-y-3\">\n                    {employees.map(emp => (\n                        <div key={emp.id} className=\"flex justify-between items-center p-3 bg-slate-50 rounded-xl border border-slate-100 hover:border-cyan-200 transition-colors group\">\n                            <div className=\"flex items-center gap-3\">\n                                <div className=\"w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center font-bold text-slate-500\">\n                                    {emp.name.charAt(0)}\n                                </div>\n                                <div>\n                                    <p className=\"font-bold text-slate-700\">{emp.name}</p>\n                                    <p className=\"text-xs text-slate-500\">{emp.job_title}</p>\n                                </div>\n                            </div>\n                            <div className=\"text-right\">\n                                <p className=\"text-xs font-bold text-slate-400\">{emp.assigned_location_id || 'Sin Asignar'}</p>\n                                <button className=\"text-xs text-cyan-600 font-bold opacity-0 group-hover:opacity-100 transition-opacity\">\n                                    Mover a {currentLocation?.name}\n                                </button>\n                            </div>\n                        </div>\n                    ))}\n                </div>\n            </div>\n\n            {/* Target: Current Location */}\n            <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 flex flex-col border-l-4 border-l-cyan-500\">\n                <h3 className=\"font-bold text-slate-800 mb-4 flex items-center gap-2\">\n                    <MapPin className=\"text-cyan-600\" /> En {currentLocation?.name}\n                </h3>\n                <div className=\"flex-1 overflow-y-auto space-y-3\">\n                    {employees.filter(e => e.assigned_location_id === currentLocation?.id).length > 0 ? (\n                        employees.filter(e => e.assigned_location_id === currentLocation?.id).map(emp => (\n                            <div key={emp.id} className=\"flex justify-between items-center p-3 bg-cyan-50 rounded-xl border border-cyan-100\">\n                                <div className=\"flex items-center gap-3\">\n                                    <div className=\"w-10 h-10 rounded-full bg-cyan-200 flex items-center justify-center font-bold text-cyan-700\">\n                                        {emp.name.charAt(0)}\n                                    </div>\n                                    <div>\n                                        <p className=\"font-bold text-slate-700\">{emp.name}</p>\n                                        <p className=\"text-xs text-slate-500\">{emp.job_title}</p>\n                                    </div>\n                                </div>\n                                <button className=\"p-2 text-slate-400 hover:text-red-500 transition-colors\">\n                                    <ArrowRightLeft size={16} />\n                                </button>\n                            </div>\n                        ))\n                    ) : (\n                        <div className=\"text-center py-10 text-slate-400\">\n                            <p>No hay personal asignado hoy.</p>\n                            <p className=\"text-xs\">Arrastra o selecciona personal de la izquierda.</p>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n\n    const renderDevices = () => (\n        <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 p-6\">\n            <div className=\"flex justify-between items-center mb-6\">\n                <h3 className=\"font-bold text-slate-800 flex items-center gap-2\">\n                    <Monitor className=\"text-slate-400\" /> Kioscos & Dispositivos\n                </h3>\n                <button className=\"text-sm font-bold text-cyan-600 hover:bg-cyan-50 px-3 py-1 rounded-lg transition\">\n                    + Vincular Nuevo\n                </button>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {kiosks.map(kiosk => (\n                    <div key={kiosk.id} className=\"border border-slate-200 rounded-xl p-4 hover:shadow-md transition-shadow\">\n                        <div className=\"flex justify-between items-start mb-4\">\n                            <div className=\"p-2 bg-slate-100 rounded-lg\">\n                                {kiosk.type === 'QUEUE' ? <Tablet size={20} className=\"text-slate-600\" /> : <Users size={20} className=\"text-slate-600\" />}\n                            </div>\n                            <span className={`px-2 py-0.5 rounded-full text-xs font-bold ${kiosk.status === 'ACTIVE' ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-100 text-slate-500'}`}>\n                                {kiosk.status}\n                            </span>\n                        </div>\n                        <h4 className=\"font-bold text-slate-800\">{kiosk.id}</h4>\n                        <p className=\"text-xs text-slate-500 mb-4\">{kiosk.type === 'QUEUE' ? 'Totem de Filas' : 'Reloj Control'}</p>\n\n                        <div className=\"flex items-center justify-between text-xs text-slate-400 bg-slate-50 p-2 rounded-lg\">\n                            <span>Ubicaci√≥n:</span>\n                            <span className=\"font-bold text-slate-600\">{locations.find(l => l.id === kiosk.location_id)?.name || 'Desconocida'}</span>\n                        </div>\n\n                        <button\n                            onClick={() => handleGenerateCode(kiosk.id)}\n                            className=\"w-full mt-4 py-2 border border-cyan-200 text-cyan-600 font-bold rounded-lg hover:bg-cyan-50 transition flex items-center justify-center gap-2\"\n                        >\n                            <QrCode size={16} /> Generar C√≥digo\n                        </button>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n\n    const renderManagers = () => (\n        <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 p-6\">\n            <div className=\"flex justify-between items-center mb-6\">\n                <h3 className=\"font-bold text-slate-800 flex items-center gap-2\">\n                    <Shield className=\"text-slate-400\" /> Gesti√≥n de Gerentes (Socios)\n                </h3>\n            </div>\n\n            <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-left\">\n                    <thead>\n                        <tr className=\"border-b border-slate-100 text-xs font-bold text-slate-400 uppercase\">\n                            <th className=\"pb-3 pl-4\">Empleado</th>\n                            <th className=\"pb-3\">Rol Actual</th>\n                            <th className=\"pb-3\">Sucursal Base</th>\n                            <th className=\"pb-3 text-right pr-4\">Acciones</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-slate-50\">\n                        {employees.map(emp => (\n                            <tr key={emp.id} className=\"group hover:bg-slate-50 transition-colors\">\n                                <td className=\"py-3 pl-4\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center font-bold text-slate-500 text-xs\">\n                                            {emp.name.charAt(0)}\n                                        </div>\n                                        <div>\n                                            <p className=\"font-bold text-slate-700 text-sm\">{emp.name}</p>\n                                            <p className=\"text-xs text-slate-400\">{emp.rut}</p>\n                                        </div>\n                                    </div>\n                                </td>\n                                <td className=\"py-3\">\n                                    <span className={`px-2 py-1 rounded-full text-xs font-bold ${emp.role === 'MANAGER' ? 'bg-purple-100 text-purple-600' : 'bg-slate-100 text-slate-500'}`}>\n                                        {emp.role}\n                                    </span>\n                                </td>\n                                <td className=\"py-3 text-sm text-slate-600\">\n                                    {locations.find(l => l.id === emp.base_location_id)?.name || '-'}\n                                </td>\n                                <td className=\"py-3 text-right pr-4\">\n                                    {emp.role !== 'MANAGER' && (\n                                        <button\n                                            onClick={() => setPromotionTarget(emp)}\n                                            className=\"text-xs font-bold text-cyan-600 hover:bg-cyan-50 px-3 py-1 rounded-lg transition\"\n                                        >\n                                            Ascender a Socio\n                                        </button>\n                                    )}\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n\n    return (\n        <div className=\"h-full flex flex-col bg-slate-50 p-6 overflow-hidden\">\n            <header className=\"flex justify-between items-center mb-6\">\n                <div>\n                    <h1 className=\"text-2xl font-bold text-slate-800 flex items-center gap-2\">\n                        <MapPin className=\"text-cyan-600\" />\n                        Gesti√≥n de Red\n                    </h1>\n                    <p className=\"text-slate-500\">Administra sucursales, bodegas y puntos de atenci√≥n.</p>\n                </div>\n                <button\n                    onClick={() => setIsWizardOpen(true)}\n                    className=\"bg-cyan-600 text-white px-4 py-2 rounded-xl font-bold hover:bg-cyan-700 transition-colors flex items-center gap-2 shadow-lg shadow-cyan-200\"\n                >\n                    <Plus size={20} />\n                    Nueva Sucursal\n                </button>\n            </header>\n\n            {/* Current Context Banner */}\n            <div className=\"bg-slate-800 text-white p-4 rounded-xl mb-6 flex justify-between items-center shadow-lg\">\n                <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-white/10 rounded-lg\">\n                        {currentLocation?.type === 'WAREHOUSE' ? <Warehouse size={24} /> : <Store size={24} />}\n                    </div>\n                    <div>\n                        <p className=\"text-xs text-slate-400 uppercase tracking-wider font-bold\">Ubicaci√≥n Actual (Contexto)</p>\n                        <h2 className=\"text-xl font-bold\">{currentLocation?.name}</h2>\n                    </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                    <span className=\"text-xs text-slate-400\">Cambiar vista:</span>\n                    <select\n                        className=\"bg-slate-700 border border-slate-600 rounded-lg px-3 py-1 text-sm font-bold focus:outline-none focus:border-cyan-500\"\n                        value={currentLocation?.id}\n                        onChange={(e) => switchLocation(e.target.value)}\n                    >\n                        {locations.map(loc => (\n                            <option key={loc.id} value={loc.id}>{loc.name}</option>\n                        ))}\n                    </select>\n                </div>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"flex gap-2 mb-6 border-b border-slate-200\">\n                <button\n                    onClick={() => setActiveTab('BRANCHES')}\n                    className={`px-4 py-2 font-bold text-sm border-b-2 transition-colors ${activeTab === 'BRANCHES' ? 'border-cyan-600 text-cyan-700' : 'border-transparent text-slate-400 hover:text-slate-600'}`}\n                >\n                    Sucursales\n                </button>\n                <button\n                    onClick={() => setActiveTab('TEAMS')}\n                    className={`px-4 py-2 font-bold text-sm border-b-2 transition-colors ${activeTab === 'TEAMS' ? 'border-cyan-600 text-cyan-700' : 'border-transparent text-slate-400 hover:text-slate-600'}`}\n                >\n                    Equipos\n                </button>\n                <button\n                    onClick={() => setActiveTab('DEVICES')}\n                    className={`px-4 py-2 font-bold text-sm border-b-2 transition-colors ${activeTab === 'DEVICES' ? 'border-cyan-600 text-cyan-700' : 'border-transparent text-slate-400 hover:text-slate-600'}`}\n                >\n                    Dispositivos\n                </button>\n                <button\n                    onClick={() => setActiveTab('MANAGERS')}\n                    className={`px-4 py-2 font-bold text-sm border-b-2 transition-colors ${activeTab === 'MANAGERS' ? 'border-cyan-600 text-cyan-700' : 'border-transparent text-slate-400 hover:text-slate-600'}`}\n                >\n                    Gerentes\n                </button>\n            </div>\n\n            {/* Content Area */}\n            <div className=\"flex-1 overflow-hidden\">\n                {activeTab === 'BRANCHES' && renderBranches()}\n                {activeTab === 'TEAMS' && renderTeams()}\n                {activeTab === 'DEVICES' && renderDevices()}\n                {activeTab === 'MANAGERS' && renderManagers()}\n            </div>\n\n            {/* New Location Wizard Modal */}\n            {isWizardOpen && (\n                <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n                    <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md p-6 animate-in fade-in zoom-in duration-200\">\n                        <h3 className=\"text-xl font-bold text-slate-800 mb-4\">Nueva Ubicaci√≥n</h3>\n\n                        <div className=\"space-y-4\">\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-600 mb-1\">Tipo</label>\n                                <div className=\"grid grid-cols-2 gap-2\">\n                                    <button\n                                        onClick={() => setNewLocation({ ...newLocation, type: 'STORE' })}\n                                        className={`p-3 rounded-xl border-2 font-bold text-sm transition-all ${newLocation.type === 'STORE' ? 'border-cyan-500 bg-cyan-50 text-cyan-700' : 'border-slate-200 text-slate-400'}`}\n                                    >\n                                        Sucursal\n                                    </button>\n                                    <button\n                                        onClick={() => setNewLocation({ ...newLocation, type: 'WAREHOUSE' })}\n                                        className={`p-3 rounded-xl border-2 font-bold text-sm transition-all ${newLocation.type === 'WAREHOUSE' ? 'border-orange-500 bg-orange-50 text-orange-700' : 'border-slate-200 text-slate-400'}`}\n                                    >\n                                        Bodega\n                                    </button>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-600 mb-1\">Nombre</label>\n                                <input\n                                    type=\"text\"\n                                    className=\"w-full p-3 border-2 border-slate-200 rounded-xl font-medium\"\n                                    placeholder=\"Ej: Sucursal Norte\"\n                                    value={newLocation.name}\n                                    onChange={(e) => setNewLocation({ ...newLocation, name: e.target.value })}\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-600 mb-1\">Direcci√≥n</label>\n                                <input\n                                    type=\"text\"\n                                    className=\"w-full p-3 border-2 border-slate-200 rounded-xl font-medium\"\n                                    placeholder=\"Ej: Av. Matta 550\"\n                                    value={newLocation.address}\n                                    onChange={(e) => setNewLocation({ ...newLocation, address: e.target.value })}\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-3 mt-6\">\n                                <button\n                                    onClick={() => setIsWizardOpen(false)}\n                                    className=\"py-3 rounded-xl font-bold text-slate-500 hover:bg-slate-100\"\n                                >\n                                    Cancelar\n                                </button>\n                                <button\n                                    onClick={handleCreateLocation}\n                                    className=\"py-3 rounded-xl font-bold bg-cyan-600 text-white hover:bg-cyan-700\"\n                                >\n                                    Crear Ubicaci√≥n\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* Pairing Code Modal */}\n            {pairingCode && (\n                <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n                    <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-sm p-8 text-center animate-in fade-in zoom-in duration-200\">\n                        <QrCode size={48} className=\"mx-auto text-slate-800 mb-4\" />\n                        <h3 className=\"text-xl font-bold text-slate-800 mb-2\">C√≥digo de Vinculaci√≥n</h3>\n                        <p className=\"text-sm text-slate-500 mb-6\">Ingresa este c√≥digo en la Tablet para asignarla a esta sucursal.</p>\n\n                        <div className=\"bg-slate-100 p-4 rounded-2xl mb-6\">\n                            <span className=\"text-4xl font-mono font-bold text-slate-900 tracking-widest\">{pairingCode}</span>\n                        </div>\n\n                        <button\n                            onClick={() => setPairingCode(null)}\n                            className=\"w-full py-3 rounded-xl font-bold bg-slate-900 text-white hover:bg-slate-800\"\n                        >\n                            Listo\n                        </button>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default NetworkPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11517, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/pages/PriceCheckPage.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Search, ScanBarcode, X, Clock, Info, AlertTriangle } from 'lucide-react';\nimport { usePharmaStore } from '../store/useStore';\nimport { useBarcodeScanner } from '../hooks/useBarcodeScanner';\nimport { InventoryBatch } from '../../domain/types';\nimport { formatProductLabel, calculatePricePerUnit } from '../../domain/logic/productDisplay';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst PriceCheckPage: React.FC = () => {\n    const { inventory } = usePharmaStore();\n    const [searchTerm, setSearchTerm] = useState('');\n    const [selectedProduct, setSelectedProduct] = useState<InventoryBatch | null>(null);\n    const [alternatives, setAlternatives] = useState<InventoryBatch[]>([]);\n    const [isIdle, setIsIdle] = useState(false);\n    const inactivityTimerRef = useRef<NodeJS.Timeout | null>(null);\n\n    // Reset timer on interaction\n    const resetTimer = () => {\n        if (inactivityTimerRef.current) clearTimeout(inactivityTimerRef.current);\n        setIsIdle(false);\n        inactivityTimerRef.current = setTimeout(() => {\n            handleTimeout();\n        }, 15000); // 15 seconds timeout\n    };\n\n    const handleTimeout = () => {\n        setSearchTerm('');\n        setSelectedProduct(null);\n        setIsIdle(true);\n    };\n\n    useEffect(() => {\n        resetTimer();\n        window.addEventListener('mousemove', resetTimer);\n        window.addEventListener('touchstart', resetTimer);\n        window.addEventListener('keydown', resetTimer);\n        return () => {\n            if (inactivityTimerRef.current) clearTimeout(inactivityTimerRef.current);\n            window.removeEventListener('mousemove', resetTimer);\n            window.removeEventListener('touchstart', resetTimer);\n            window.removeEventListener('keydown', resetTimer);\n        };\n    }, []);\n\n    // Barcode Scanner\n    useBarcodeScanner({\n        onScan: (sku) => {\n            const product = inventory.find(p => p.sku === sku || p.id === sku);\n            if (product) {\n                setSelectedProduct(product);\n                // Find alternatives with same DCI\n                const alts = inventory.filter(p =>\n                    p.id !== product.id &&\n                    p.dci && product.dci &&\n                    p.dci.toLowerCase() === product.dci.toLowerCase() &&\n                    p.stock_actual > 0\n                ).sort((a, b) => a.price - b.price);\n                setAlternatives(alts);\n                resetTimer();\n            }\n        }\n    });\n\n    // Search Logic\n    const filteredProducts = inventory.filter(item => {\n        if (!searchTerm) return false;\n        const term = searchTerm.toLowerCase();\n        return (\n            item.name.toLowerCase().includes(term) ||\n            item.dci.toLowerCase().includes(term) ||\n            (item.laboratory && item.laboratory.toLowerCase().includes(term)) ||\n            (item.brand && item.brand.toLowerCase().includes(term))\n        );\n    }).slice(0, 6); // Limit results\n\n    return (\n        <div className=\"min-h-screen bg-slate-900 text-white overflow-hidden flex flex-col relative\">\n\n            {/* Background Elements */}\n            <div className=\"absolute top-0 left-0 w-full h-full overflow-hidden z-0 opacity-20 pointer-events-none\">\n                <div className=\"absolute -top-20 -left-20 w-96 h-96 bg-cyan-500 rounded-full blur-3xl mix-blend-screen animate-pulse\" />\n                <div className=\"absolute top-1/2 right-0 w-80 h-80 bg-purple-500 rounded-full blur-3xl mix-blend-screen animate-pulse delay-1000\" />\n            </div>\n\n            {/* Header */}\n            <header className=\"relative z-10 p-8 flex justify-between items-center\">\n                <div>\n                    <h1 className=\"text-4xl font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500\">\n                        Consultor de Precios\n                    </h1>\n                    <p className=\"text-slate-400 text-lg\">Escanee un producto o busque manualmente</p>\n                </div>\n                <div className=\"bg-slate-800/50 p-4 rounded-2xl border border-slate-700 flex items-center gap-3\">\n                    <ScanBarcode size={32} className=\"text-cyan-400 animate-pulse\" />\n                    <span className=\"font-bold text-sm text-slate-300\">Lector Activo</span>\n                </div>\n            </header>\n\n            {/* Main Content */}\n            <main className=\"relative z-10 flex-1 flex flex-col items-center justify-start p-8 max-w-5xl mx-auto w-full\">\n\n                {/* Search Bar */}\n                <div className=\"w-full relative mb-12\">\n                    <Search className=\"absolute left-6 top-1/2 -translate-y-1/2 text-slate-400\" size={32} />\n                    <input\n                        type=\"text\"\n                        placeholder=\"¬øQu√© busca? (Ej: Paracetamol, Bago...)\"\n                        className=\"w-full pl-20 pr-6 py-8 bg-slate-800/80 border-2 border-slate-700 rounded-3xl text-3xl font-bold text-white placeholder:text-slate-500 focus:border-cyan-500 focus:outline-none focus:ring-4 focus:ring-cyan-500/20 transition-all shadow-2xl\"\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        autoFocus\n                    />\n                </div>\n\n                {/* Search Results Grid */}\n                {!selectedProduct && searchTerm && (\n                    <div className=\"w-full grid grid-cols-2 gap-6 animate-in fade-in slide-in-from-bottom-4\">\n                        {filteredProducts.map(product => (\n                            <div\n                                key={product.id}\n                                onClick={() => setSelectedProduct(product)}\n                                className=\"bg-slate-800/60 border border-slate-700 p-6 rounded-2xl cursor-pointer hover:bg-slate-700/80 hover:border-cyan-500/50 transition-all group\"\n                            >\n                                <h3 className=\"text-2xl font-bold text-slate-100 mb-2 group-hover:text-cyan-400\">{product.name}</h3>\n                                <p className=\"text-slate-400 text-lg mb-4\">{product.dci} - {product.laboratory}</p>\n                                <div className=\"flex justify-between items-end\">\n                                    <span className=\"text-3xl font-extrabold text-white\">${product.price.toLocaleString()}</span>\n                                    <span className=\"text-sm bg-slate-700 px-3 py-1 rounded-lg text-slate-300\">Ver Detalle</span>\n                                </div>\n                            </div>\n                        ))}\n                        {filteredProducts.length === 0 && (\n                            <div className=\"col-span-2 text-center py-12 text-slate-500\">\n                                <p className=\"text-xl\">No se encontraron productos</p>\n                            </div>\n                        )}\n                    </div>\n                )}\n\n                {/* Idle State / Call to Action */}\n                {!selectedProduct && !searchTerm && (\n                    <div className=\"flex-1 flex flex-col items-center justify-center opacity-50\">\n                        <ScanBarcode size={120} className=\"text-slate-600 mb-8\" />\n                        <p className=\"text-2xl font-bold text-slate-500\">Acerque el c√≥digo de barras al lector</p>\n                    </div>\n                )}\n            </main>\n\n            {/* Product Detail Modal (Full Screen) */}\n            <AnimatePresence>\n                {selectedProduct && (\n                    <motion.div\n                        initial={{ opacity: 0, scale: 0.95 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        exit={{ opacity: 0, scale: 0.95 }}\n                        className=\"fixed inset-0 z-50 bg-slate-900/95 backdrop-blur-xl flex items-center justify-center p-8\"\n                    >\n                        <div className=\"bg-white text-slate-900 w-full max-w-4xl rounded-[3rem] overflow-hidden shadow-2xl relative\">\n\n                            {/* Close Button */}\n                            <button\n                                onClick={() => setSelectedProduct(null)}\n                                className=\"absolute top-8 right-8 bg-slate-100 hover:bg-slate-200 p-4 rounded-full transition-colors z-10\"\n                            >\n                                <X size={32} className=\"text-slate-600\" />\n                            </button>\n\n                            <div className=\"flex flex-col md:flex-row h-full\">\n                                {/* Left: Main Info & Price */}\n                                <div className=\"w-full md:w-5/12 bg-slate-50 p-12 flex flex-col justify-center items-center border-r border-slate-100 relative overflow-hidden\">\n                                    <div className=\"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-cyan-500 to-blue-500\" />\n\n                                    <div className=\"mb-8 text-center\">\n                                        <span className=\"inline-block px-4 py-2 bg-slate-200 rounded-full text-sm font-bold text-slate-600 mb-4\">\n                                            {selectedProduct.sku}\n                                        </span>\n                                        <h2 className=\"text-3xl font-extrabold text-slate-800 leading-tight mb-2\">\n                                            {selectedProduct.name}\n                                        </h2>\n                                        <p className=\"text-xl text-slate-500 font-medium\">\n                                            {selectedProduct.format} x{selectedProduct.unit_count}\n                                        </p>\n                                    </div>\n\n                                    <div className=\"bg-white p-8 rounded-3xl shadow-xl border border-slate-100 w-full text-center transform scale-110\">\n                                        <p className=\"text-sm font-bold text-slate-400 uppercase tracking-widest mb-2\">Precio Venta</p>\n                                        <p className=\"text-6xl font-black text-slate-900 tracking-tight\">\n                                            ${selectedProduct.price.toLocaleString()}\n                                        </p>\n                                    </div>\n\n                                    {/* Timer Indicator */}\n                                    <div className=\"mt-12 flex items-center gap-2 text-slate-400 text-sm font-medium animate-pulse\">\n                                        <Clock size={16} />\n                                        <span>Cerrando en 15s...</span>\n                                    </div>\n                                </div>\n\n                                {/* Right: Technical Details (Seremi) */}\n                                <div className=\"w-full md:w-7/12 p-12 bg-white\">\n                                    <h3 className=\"text-2xl font-bold text-slate-800 mb-8 flex items-center gap-3\">\n                                        <Info className=\"text-cyan-600\" />\n                                        Ficha T√©cnica\n                                    </h3>\n\n                                    <div className=\"space-y-6\">\n                                        <div className=\"grid grid-cols-2 gap-8\">\n                                            <div>\n                                                <p className=\"text-sm font-bold text-slate-400 mb-1\">Principio Activo (DCI)</p>\n                                                <p className=\"text-xl font-bold text-slate-800\">{selectedProduct.dci}</p>\n                                            </div>\n                                            <div>\n                                                <p className=\"text-sm font-bold text-slate-400 mb-1\">Concentraci√≥n</p>\n                                                <p className=\"text-xl font-bold text-slate-800\">{selectedProduct.concentration}</p>\n                                            </div>\n                                        </div>\n\n                                        <div className=\"h-px bg-slate-100\" />\n\n                                        <div className=\"grid grid-cols-2 gap-8\">\n                                            <div>\n                                                <p className=\"text-sm font-bold text-slate-400 mb-1\">Laboratorio</p>\n                                                <p className=\"text-lg font-bold text-slate-700\">{selectedProduct.laboratory}</p>\n                                            </div>\n                                            <div>\n                                                <p className=\"text-sm font-bold text-slate-400 mb-1\">Bioequivalencia</p>\n                                                <span className={`inline-flex items-center px-3 py-1 rounded-lg text-sm font-bold ${selectedProduct.bioequivalent_status === 'BIOEQUIVALENTE' ? 'bg-yellow-100 text-yellow-700' : 'bg-slate-100 text-slate-500'}`}>\n                                                    {selectedProduct.bioequivalent_status === 'BIOEQUIVALENTE' ? 'BIOEQUIVALENTE' : 'NO APLICA'}\n                                                </span>\n                                            </div>\n                                        </div>\n\n                                        <div className=\"h-px bg-slate-100\" />\n\n                                        <div className=\"grid grid-cols-2 gap-8\">\n                                            <div>\n                                                <p className=\"text-sm font-bold text-slate-400 mb-1\">Precio por Unidad</p>\n                                                <p className=\"text-lg font-bold text-slate-700\">\n                                                    ${Math.round(calculatePricePerUnit(selectedProduct)).toLocaleString()} / un\n                                                </p>\n                                            </div>\n                                            <div>\n                                                <p className=\"text-sm font-bold text-slate-400 mb-1\">Condici√≥n de Venta</p>\n                                                <div className=\"flex items-center gap-2\">\n                                                    {selectedProduct.condition === 'VD' ? (\n                                                        <span className=\"text-emerald-600 font-bold\">Venta Directa</span>\n                                                    ) : (\n                                                        <span className=\"flex items-center gap-1 text-purple-600 font-bold\">\n                                                            <AlertTriangle size={16} /> Receta {selectedProduct.condition}\n                                                        </span>\n                                                    )}\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"mt-8\">\n                                        <h4 className=\"text-lg font-bold text-slate-800 mb-4\">Alternativas Disponibles ({selectedProduct.dci})</h4>\n                                        <div className=\"space-y-3 max-h-[200px] overflow-y-auto pr-2\">\n                                            {alternatives.length > 0 ? (\n                                                alternatives.map(alt => (\n                                                    <div key={alt.id} className=\"flex justify-between items-center p-3 bg-slate-50 rounded-xl border border-slate-100\">\n                                                        <div>\n                                                            <p className=\"font-bold text-slate-700\">{alt.name}</p>\n                                                            <div className=\"flex gap-2 text-xs mt-1\">\n                                                                <span className=\"text-slate-500\">{alt.laboratory}</span>\n                                                                {alt.bioequivalent_status === 'BIOEQUIVALENTE' && (\n                                                                    <span className=\"text-emerald-600 font-bold bg-emerald-50 px-2 rounded-full\">BIO</span>\n                                                                )}\n                                                            </div>\n                                                        </div>\n                                                        <p className=\"font-bold text-slate-900 text-lg\">${alt.price.toLocaleString()}</p>\n                                                    </div>\n                                                ))\n                                            ) : (\n                                                <p className=\"text-slate-400 text-sm italic\">No se encontraron otras alternativas disponibles.</p>\n                                            )}\n                                        </div>\n                                    </div>\n\n                                    <div className=\"mt-8 bg-slate-50 p-4 rounded-xl border border-slate-100\">\n                                        <p className=\"text-xs text-slate-400 text-center leading-relaxed\">\n                                            La informaci√≥n mostrada cumple con el Decreto Supremo 466.\n                                            Consulte siempre a su Qu√≠mico Farmac√©utico. Visite ispch.cl\n                                        </p>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n};\n\nexport default PriceCheckPage;\n"],"names":[],"mappings":"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"}}]
}