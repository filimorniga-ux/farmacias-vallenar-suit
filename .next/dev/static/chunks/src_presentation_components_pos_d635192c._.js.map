{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/PrescriptionModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { FileText, Stethoscope, CheckSquare, AlertTriangle } from 'lucide-react';\n\ninterface PrescriptionModalProps {\n    isOpen: boolean;\n    onConfirm: (data: { folio: string, doctorRut: string }) => void;\n    onCancel: () => void;\n    itemName: string;\n}\n\nconst PrescriptionModal: React.FC<PrescriptionModalProps> = ({ isOpen, onConfirm, onCancel, itemName }) => {\n    const [folio, setFolio] = useState('');\n    const [doctorRut, setDoctorRut] = useState('');\n    const [isArchived, setIsArchived] = useState(false);\n\n    if (!isOpen) return null;\n\n    const isValid = folio.length > 0 && doctorRut.length > 8 && isArchived;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200\">\n                <div className=\"bg-amber-50 p-6 border-b border-amber-100\">\n                    <h3 className=\"text-xl font-bold text-amber-800 flex items-center gap-2\">\n                        <AlertTriangle className=\"text-amber-600\" /> Receta Retenida\n                    </h3>\n                    <p className=\"text-sm text-amber-700 mt-1\">\n                        La venta de <strong>{itemName}</strong> requiere receta retenida.\n                    </p>\n                </div>\n\n                <div className=\"p-6 space-y-4\">\n                    <div>\n                        <label className=\"block text-sm font-bold text-slate-700 mb-1 flex items-center gap-2\">\n                            <FileText size={16} /> Folio Receta\n                        </label>\n                        <input\n                            type=\"text\"\n                            className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-amber-500 focus:outline-none\"\n                            placeholder=\"Ej: A-123456\"\n                            value={folio}\n                            onChange={(e) => setFolio(e.target.value)}\n                        />\n                    </div>\n\n                    <div>\n                        <label className=\"block text-sm font-bold text-slate-700 mb-1 flex items-center gap-2\">\n                            <Stethoscope size={16} /> RUT Médico Prescriptor\n                        </label>\n                        <input\n                            type=\"text\"\n                            className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-amber-500 focus:outline-none\"\n                            placeholder=\"Ej: 11.222.333-4\"\n                            value={doctorRut}\n                            onChange={(e) => setDoctorRut(e.target.value)}\n                        />\n                    </div>\n\n                    <div className=\"bg-slate-50 p-4 rounded-xl border border-slate-200\">\n                        <label className=\"flex items-center gap-3 cursor-pointer\">\n                            <div className={`w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${isArchived ? 'bg-amber-500 border-amber-500 text-white' : 'border-slate-300 bg-white'}`}>\n                                {isArchived && <CheckSquare size={16} />}\n                            </div>\n                            <input\n                                type=\"checkbox\"\n                                className=\"hidden\"\n                                checked={isArchived}\n                                onChange={(e) => setIsArchived(e.target.checked)}\n                            />\n                            <span className=\"text-sm font-bold text-slate-700\">Receta Física Archivada</span>\n                        </label>\n                        <p className=\"text-xs text-slate-400 mt-2 ml-9\">\n                            Declaro haber recibido y archivado la receta física correspondiente.\n                        </p>\n                    </div>\n\n                    <div className=\"flex flex-col gap-3 pt-4\">\n                        <div className=\"flex gap-3\">\n                            <button\n                                onClick={onCancel}\n                                className=\"flex-1 py-3 text-slate-500 font-bold hover:bg-slate-100 rounded-xl transition\"\n                            >\n                                Cancelar\n                            </button>\n                            <button\n                                onClick={() => isValid && onConfirm({ folio, doctorRut })}\n                                disabled={!isValid}\n                                className=\"flex-1 py-3 bg-amber-600 text-white font-bold rounded-xl hover:bg-amber-700 transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-amber-200\"\n                            >\n                                Confirmar\n                            </button>\n                        </div>\n                        <button\n                            onClick={() => onConfirm({ folio: 'PENDIENTE_VALIDACION', doctorRut: 'VALIDACION_MANUAL' })}\n                            className=\"w-full py-2 text-xs font-bold text-slate-400 hover:text-slate-600 transition uppercase tracking-wider\"\n                        >\n                            Omitir / Validar Manualmente\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default PrescriptionModal;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;AAAA;;;;;AASA,MAAM,oBAAsD,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE,QAAQ,EAAE;;IAClG,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAE7C,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,UAAU,MAAM,MAAM,GAAG,KAAK,UAAU,MAAM,GAAG,KAAK;IAE5D,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAG,WAAU;;8CACV,6LAAC,4OAAa;oCAAC,WAAU;;;;;;gCAAmB;;;;;;;sCAEhD,6LAAC;4BAAE,WAAU;;gCAA8B;8CAC3B,6LAAC;8CAAQ;;;;;;gCAAkB;;;;;;;;;;;;;8BAI/C,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;;sDACb,6LAAC,6NAAQ;4CAAC,MAAM;;;;;;wCAAM;;;;;;;8CAE1B,6LAAC;oCACG,MAAK;oCACL,WAAU;oCACV,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;sCAIhD,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;;sDACb,6LAAC,kOAAW;4CAAC,MAAM;;;;;;wCAAM;;;;;;;8CAE7B,6LAAC;oCACG,MAAK;oCACL,WAAU;oCACV,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;sCAIpD,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAM,WAAU;;sDACb,6LAAC;4CAAI,WAAW,CAAC,4EAA4E,EAAE,aAAa,6CAA6C,6BAA6B;sDACjL,4BAAc,6LAAC,6OAAW;gDAAC,MAAM;;;;;;;;;;;sDAEtC,6LAAC;4CACG,MAAK;4CACL,WAAU;4CACV,SAAS;4CACT,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,OAAO;;;;;;sDAEnD,6LAAC;4CAAK,WAAU;sDAAmC;;;;;;;;;;;;8CAEvD,6LAAC;oCAAE,WAAU;8CAAmC;;;;;;;;;;;;sCAKpD,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CACG,SAAS;4CACT,WAAU;sDACb;;;;;;sDAGD,6LAAC;4CACG,SAAS,IAAM,WAAW,UAAU;oDAAE;oDAAO;gDAAU;4CACvD,UAAU,CAAC;4CACX,WAAU;sDACb;;;;;;;;;;;;8CAIL,6LAAC;oCACG,SAAS,IAAM,UAAU;4CAAE,OAAO;4CAAwB,WAAW;wCAAoB;oCACzF,WAAU;8CACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQzB;GA7FM;KAAA;uCA+FS"}},
    {"offset": {"line": 289, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/ManualItemModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { PlusCircle, DollarSign, Package } from 'lucide-react';\n\ninterface ManualItemModalProps {\n    isOpen: boolean;\n    onConfirm: (data: { description: string, price: number, quantity: number }) => void;\n    onClose: () => void;\n}\n\nconst ManualItemModal: React.FC<ManualItemModalProps> = ({ isOpen, onConfirm, onClose }) => {\n    const [description, setDescription] = useState('');\n    const [price, setPrice] = useState('');\n    const [quantity, setQuantity] = useState('1');\n\n    if (!isOpen) return null;\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (description && price) {\n            onConfirm({\n                description,\n                price: parseInt(price),\n                quantity: parseInt(quantity)\n            });\n            // Reset\n            setDescription('');\n            setPrice('');\n            setQuantity('1');\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-sm overflow-hidden animate-in fade-in zoom-in duration-200\">\n                <div className=\"bg-slate-900 p-4 border-b border-slate-800 text-white\">\n                    <h3 className=\"text-lg font-bold flex items-center gap-2\">\n                        <PlusCircle className=\"text-cyan-400\" /> Ítem Manual / Vario\n                    </h3>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                    <div>\n                        <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Descripción</label>\n                        <input\n                            type=\"text\"\n                            autoFocus\n                            className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                            placeholder=\"Ej: Servicio Inyectable\"\n                            value={description}\n                            onChange={(e) => setDescription(e.target.value)}\n                        />\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Precio Unit.</label>\n                            <div className=\"relative\">\n                                <DollarSign size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" />\n                                <input\n                                    type=\"number\"\n                                    className=\"w-full pl-8 pr-3 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                                    placeholder=\"0\"\n                                    value={price}\n                                    onChange={(e) => setPrice(e.target.value)}\n                                />\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Cantidad</label>\n                            <div className=\"relative\">\n                                <Package size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" />\n                                <input\n                                    type=\"number\"\n                                    className=\"w-full pl-8 pr-3 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                                    value={quantity}\n                                    onChange={(e) => setQuantity(e.target.value)}\n                                />\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex gap-3 pt-4\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"flex-1 py-3 text-slate-500 font-bold hover:bg-slate-100 rounded-xl transition\"\n                        >\n                            Cancelar\n                        </button>\n                        <button\n                            type=\"submit\"\n                            className=\"flex-1 py-3 bg-cyan-600 text-white font-bold rounded-xl hover:bg-cyan-700 transition shadow-lg shadow-cyan-200\"\n                        >\n                            Agregar\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n};\n\nexport default ManualItemModal;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;;;;;AAQA,MAAM,kBAAkD,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE;;IACnF,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,eAAe,CAAC;QAClB,EAAE,cAAc;QAChB,IAAI,eAAe,OAAO;YACtB,UAAU;gBACN;gBACA,OAAO,SAAS;gBAChB,UAAU,SAAS;YACvB;YACA,QAAQ;YACR,eAAe;YACf,SAAS;YACT,YAAY;QAChB;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC;wBAAG,WAAU;;0CACV,6LAAC,mOAAU;gCAAC,WAAU;;;;;;4BAAkB;;;;;;;;;;;;8BAIhD,6LAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACpC,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;8CAAwD;;;;;;8CACzE,6LAAC;oCACG,MAAK;oCACL,SAAS;oCACT,WAAU;oCACV,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;sCAItD,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;;sDACG,6LAAC;4CAAM,WAAU;sDAAwD;;;;;;sDACzE,6LAAC;4CAAI,WAAU;;8DACX,6LAAC,mOAAU;oDAAC,MAAM;oDAAI,WAAU;;;;;;8DAChC,6LAAC;oDACG,MAAK;oDACL,WAAU;oDACV,aAAY;oDACZ,OAAO;oDACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;;;;;;;8CAIpD,6LAAC;;sDACG,6LAAC;4CAAM,WAAU;sDAAwD;;;;;;sDACzE,6LAAC;4CAAI,WAAU;;8DACX,6LAAC,sNAAO;oDAAC,MAAM;oDAAI,WAAU;;;;;;8DAC7B,6LAAC;oDACG,MAAK;oDACL,WAAU;oDACV,OAAO;oDACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;;;;;;;;;;;;;sCAM3D,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCACG,MAAK;oCACL,SAAS;oCACT,WAAU;8CACb;;;;;;8CAGD,6LAAC;oCACG,MAAK;oCACL,WAAU;8CACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQzB;GA3FM;KAAA;uCA6FS"}},
    {"offset": {"line": 537, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/CashControlModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { useCashSession } from '../../hooks/useCashSession';\nimport { X, DollarSign, TrendingDown, TrendingUp, ChevronDown, ChevronRight, AlertTriangle, CheckCircle, Lock, Plus } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { CashMovementReason } from '../../../domain/types';\n\ninterface CashControlModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst CashControlModal: React.FC<CashControlModalProps> = ({ isOpen, onClose }) => {\n    const { currentShift, openShift, closeShift, registerCashMovement } = usePharmaStore();\n    const metrics = useCashSession();\n\n    const [activeTab, setActiveTab] = useState<'MOVEMENTS' | 'CLOSING'>('MOVEMENTS');\n\n    // Movement State\n    const [movementType, setMovementType] = useState<'IN' | 'OUT'>('OUT');\n    const [amount, setAmount] = useState('');\n    const [reason, setReason] = useState<CashMovementReason>('SUPPLIES');\n    const [description, setDescription] = useState('');\n\n    // Closing State\n    const [closingAmount, setClosingAmount] = useState('');\n    const [expandedSection, setExpandedSection] = useState<string | null>(null);\n\n    // Opening State (if shift is closed)\n    const [openingAmount, setOpeningAmount] = useState('');\n\n    if (!isOpen) return null;\n\n    // 1. OPENING SHIFT VIEW\n    if (!currentShift || currentShift.status === 'CLOSED') {\n        return (\n            <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n                <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md p-8 text-center\">\n                    <div className=\"w-20 h-20 bg-cyan-100 rounded-full flex items-center justify-center mx-auto mb-6 text-cyan-600\">\n                        <Lock size={40} />\n                    </div>\n                    <h2 className=\"text-2xl font-bold text-slate-800 mb-2\">Apertura de Caja</h2>\n                    <p className=\"text-slate-500 mb-8\">Ingrese el monto base para iniciar el turno.</p>\n\n                    <div className=\"mb-6\">\n                        <label className=\"block text-left text-xs font-bold text-slate-500 uppercase mb-2\">Monto Base</label>\n                        <div className=\"relative\">\n                            <DollarSign className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\" />\n                            <input\n                                type=\"number\"\n                                className=\"w-full pl-10 p-4 bg-slate-50 border border-slate-200 rounded-xl text-2xl font-bold text-slate-800 focus:border-cyan-500 outline-none\"\n                                placeholder=\"0\"\n                                value={openingAmount}\n                                onChange={e => setOpeningAmount(e.target.value)}\n                                autoFocus\n                            />\n                        </div>\n                    </div>\n\n                    <div className=\"flex gap-3\">\n                        <button onClick={onClose} className=\"flex-1 py-3 text-slate-500 font-bold hover:bg-slate-50 rounded-xl\">Cancelar</button>\n                        <button\n                            onClick={() => {\n                                const val = parseInt(openingAmount);\n                                if (val >= 0) {\n                                    openShift(val, 'CURRENT_USER'); // TODO: Get user\n                                    toast.success('Caja abierta exitosamente');\n                                }\n                            }}\n                            className=\"flex-1 py-3 bg-cyan-600 text-white font-bold rounded-xl hover:bg-cyan-700 shadow-lg shadow-cyan-200\"\n                        >\n                            Abrir Caja\n                        </button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    if (!metrics) return null;\n\n    const handleRegisterMovement = () => {\n        const val = parseInt(amount);\n        if (isNaN(val) || val <= 0) {\n            toast.error('Ingrese un monto válido');\n            return;\n        }\n        if (!description) {\n            toast.error('Ingrese una descripción');\n            return;\n        }\n\n        registerCashMovement({\n            type: movementType,\n            amount: val,\n            reason: reason,\n            description: description,\n            is_cash: true\n        });\n\n        toast.success('Movimiento registrado');\n        setAmount('');\n        setDescription('');\n    };\n\n    const handleCloseShift = () => {\n        const val = parseInt(closingAmount);\n        if (isNaN(val) || val < 0) return;\n\n        closeShift(val, 'CURRENT_USER');\n        toast.success('Turno cerrado correctamente');\n        onClose();\n    };\n\n    const toggleSection = (id: string) => {\n        setExpandedSection(expandedSection === id ? null : id);\n    };\n\n    const difference = (parseInt(closingAmount) || 0) - metrics.expectedCash;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-5xl h-[85vh] flex flex-col overflow-hidden\">\n\n                {/* HEADER */}\n                <div className=\"bg-slate-900 p-6 flex justify-between items-center text-white shrink-0\">\n                    <div className=\"flex items-center gap-4\">\n                        <div className=\"p-3 bg-cyan-500/20 rounded-xl\">\n                            <DollarSign className=\"text-cyan-400\" size={28} />\n                        </div>\n                        <div>\n                            <h2 className=\"text-xl font-bold\">Control de Caja</h2>\n                            <p className=\"text-slate-400 text-sm\">Turno #{currentShift.shiftNumber} • Iniciado {new Date(currentShift.start_time).toLocaleTimeString()}</p>\n                        </div>\n                    </div>\n                    <button onClick={onClose} className=\"text-slate-400 hover:text-white p-2 hover:bg-white/10 rounded-full transition\"><X /></button>\n                </div>\n\n                {/* TABS */}\n                <div className=\"flex border-b border-slate-200 shrink-0\">\n                    <button\n                        onClick={() => setActiveTab('MOVEMENTS')}\n                        className={`flex-1 py-4 font-bold text-sm border-b-2 transition ${activeTab === 'MOVEMENTS' ? 'border-cyan-500 text-cyan-700 bg-cyan-50/50' : 'border-transparent text-slate-500 hover:bg-slate-50'}`}\n                    >\n                        1. MOVIMIENTOS\n                    </button>\n                    <button\n                        onClick={() => setActiveTab('CLOSING')}\n                        className={`flex-1 py-4 font-bold text-sm border-b-2 transition ${activeTab === 'CLOSING' ? 'border-cyan-500 text-cyan-700 bg-cyan-50/50' : 'border-transparent text-slate-500 hover:bg-slate-50'}`}\n                    >\n                        2. ARQUEO Y CIERRE\n                    </button>\n                </div>\n\n                {/* CONTENT */}\n                <div className=\"flex-1 overflow-y-auto bg-slate-50 p-6\">\n\n                    {/* TAB 1: MOVEMENTS */}\n                    {activeTab === 'MOVEMENTS' && (\n                        <div className=\"max-w-2xl mx-auto\">\n                            <div className=\"bg-white rounded-2xl shadow-sm border border-slate-200 p-1\">\n                                <div className=\"grid grid-cols-2 gap-1 mb-6 p-1 bg-slate-100 rounded-xl\">\n                                    <button\n                                        onClick={() => { setMovementType('OUT'); setReason('SUPPLIES'); }}\n                                        className={`py-3 rounded-lg font-bold text-sm flex items-center justify-center gap-2 transition ${movementType === 'OUT' ? 'bg-white text-red-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}\n                                    >\n                                        <TrendingDown size={18} /> Registrar SALIDA\n                                    </button>\n                                    <button\n                                        onClick={() => { setMovementType('IN'); setReason('OTHER_INCOME'); }}\n                                        className={`py-3 rounded-lg font-bold text-sm flex items-center justify-center gap-2 transition ${movementType === 'IN' ? 'bg-white text-green-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}\n                                    >\n                                        <TrendingUp size={18} /> Registrar INGRESO\n                                    </button>\n                                </div>\n\n                                <div className=\"px-6 pb-6 space-y-4\">\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-slate-500 uppercase mb-2\">Monto</label>\n                                        <div className=\"relative\">\n                                            <DollarSign className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\" />\n                                            <input\n                                                type=\"number\"\n                                                className=\"w-full pl-10 p-4 bg-slate-50 border border-slate-200 rounded-xl text-2xl font-bold text-slate-800 focus:border-cyan-500 outline-none\"\n                                                placeholder=\"0\"\n                                                value={amount}\n                                                onChange={e => setAmount(e.target.value)}\n                                            />\n                                        </div>\n                                    </div>\n\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-slate-500 uppercase mb-2\">Motivo</label>\n                                        <select\n                                            className=\"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl font-bold text-slate-700 focus:border-cyan-500 outline-none\"\n                                            value={reason}\n                                            onChange={(e) => setReason(e.target.value as CashMovementReason)}\n                                        >\n                                            {movementType === 'OUT' ? (\n                                                <>\n                                                    <option value=\"SUPPLIES\">Insumos / Compras</option>\n                                                    <option value=\"SERVICES\">Pago Servicios</option>\n                                                    <option value=\"WITHDRAWAL\">Retiro de Utilidades</option>\n                                                    <option value=\"SALARY_ADVANCE\">Adelanto Sueldo</option>\n                                                    <option value=\"OTHER\">Otro Egreso</option>\n                                                </>\n                                            ) : (\n                                                <>\n                                                    <option value=\"OTHER_INCOME\">Ingreso Extra / Aporte</option>\n                                                    <option value=\"INITIAL_FUND\">Ajuste Fondo Inicial</option>\n                                                </>\n                                            )}\n                                        </select>\n                                    </div>\n\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-slate-500 uppercase mb-2\">Descripción</label>\n                                        <textarea\n                                            className=\"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-700 focus:border-cyan-500 outline-none resize-none h-24\"\n                                            placeholder={movementType === 'OUT' ? \"Ej: Compra de confort, pago de luz...\" : \"Ej: Aporte de sencillo, devolución...\"}\n                                            value={description}\n                                            onChange={e => setDescription(e.target.value)}\n                                        />\n                                    </div>\n\n                                    <button\n                                        onClick={handleRegisterMovement}\n                                        className={`w-full py-4 font-bold text-white rounded-xl shadow-lg transition flex items-center justify-center gap-2 ${movementType === 'OUT' ? 'bg-red-500 hover:bg-red-600 shadow-red-200' : 'bg-green-500 hover:bg-green-600 shadow-green-200'}`}\n                                    >\n                                        {movementType === 'OUT' ? <TrendingDown /> : <TrendingUp />}\n                                        {movementType === 'OUT' ? 'Confirmar Egreso' : 'Confirmar Ingreso'}\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n\n                    {/* TAB 2: CLOSING & ARQUEO */}\n                    {activeTab === 'CLOSING' && (\n                        <div className=\"flex gap-6 h-full\">\n                            {/* LEFT: DETAILS (ACCORDIONS) */}\n                            <div className=\"flex-1 space-y-4 overflow-y-auto pr-2 custom-scrollbar\">\n                                <h3 className=\"font-bold text-slate-800 mb-4\">Detalle de Operaciones</h3>\n\n                                {/* 1. CASH SALES */}\n                                <div className=\"bg-white rounded-xl border border-slate-200 overflow-hidden\">\n                                    <button\n                                        onClick={() => toggleSection('CASH')}\n                                        className=\"w-full p-4 flex justify-between items-center hover:bg-slate-50 transition\"\n                                    >\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"p-2 bg-green-100 text-green-600 rounded-lg\"><DollarSign size={20} /></div>\n                                            <div className=\"text-left\">\n                                                <div className=\"font-bold text-slate-800\">Ventas Efectivo</div>\n                                                <div className=\"text-xs text-slate-500\">{metrics.cashSales.count} transacciones</div>\n                                            </div>\n                                        </div>\n                                        <div className=\"flex items-center gap-4\">\n                                            <span className=\"font-bold text-slate-800\">${metrics.cashSales.total.toLocaleString()}</span>\n                                            {expandedSection === 'CASH' ? <ChevronDown size={18} className=\"text-slate-400\" /> : <ChevronRight size={18} className=\"text-slate-400\" />}\n                                        </div>\n                                    </button>\n                                    {expandedSection === 'CASH' && (\n                                        <div className=\"bg-slate-50 border-t border-slate-100 p-2 space-y-1 max-h-60 overflow-y-auto\">\n                                            {metrics.cashSales.items.map((sale, index) => (\n                                                <div key={`${sale.id}-${index}`} className=\"flex justify-between text-sm p-2 hover:bg-white rounded-lg\">\n                                                    <span className=\"text-slate-500\">{new Date(sale.timestamp).toLocaleTimeString()}</span>\n                                                    <span className=\"font-medium text-slate-700\">${sale.total.toLocaleString()}</span>\n                                                </div>\n                                            ))}\n                                        </div>\n                                    )}\n                                </div>\n\n                                {/* 2. CARD SALES */}\n                                <div className=\"bg-white rounded-xl border border-slate-200 overflow-hidden\">\n                                    <button\n                                        onClick={() => toggleSection('CARD')}\n                                        className=\"w-full p-4 flex justify-between items-center hover:bg-slate-50 transition\"\n                                    >\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"p-2 bg-blue-100 text-blue-600 rounded-lg\"><DollarSign size={20} /></div>\n                                            <div className=\"text-left\">\n                                                <div className=\"font-bold text-slate-800\">Ventas Tarjeta</div>\n                                                <div className=\"text-xs text-slate-500\">{metrics.cardSales.count} transacciones</div>\n                                            </div>\n                                        </div>\n                                        <div className=\"flex items-center gap-4\">\n                                            <span className=\"font-bold text-slate-800\">${metrics.cardSales.total.toLocaleString()}</span>\n                                            {expandedSection === 'CARD' ? <ChevronDown size={18} className=\"text-slate-400\" /> : <ChevronRight size={18} className=\"text-slate-400\" />}\n                                        </div>\n                                    </button>\n                                    {expandedSection === 'CARD' && (\n                                        <div className=\"bg-slate-50 border-t border-slate-100 p-2 space-y-1 max-h-60 overflow-y-auto\">\n                                            {metrics.cardSales.items.map((sale, index) => (\n                                                <div key={`${sale.id}-${index}`} className=\"flex justify-between text-sm p-2 hover:bg-white rounded-lg\">\n                                                    <span className=\"text-slate-500\">{new Date(sale.timestamp).toLocaleTimeString()}</span>\n                                                    <span className=\"font-medium text-slate-700\">${sale.total.toLocaleString()}</span>\n                                                </div>\n                                            ))}\n                                        </div>\n                                    )}\n                                </div>\n\n                                {/* 3. TRANSFERS */}\n                                <div className=\"bg-white rounded-xl border border-slate-200 overflow-hidden\">\n                                    <button\n                                        onClick={() => toggleSection('TRANSFER')}\n                                        className=\"w-full p-4 flex justify-between items-center hover:bg-slate-50 transition\"\n                                    >\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"p-2 bg-purple-100 text-purple-600 rounded-lg\"><DollarSign size={20} /></div>\n                                            <div className=\"text-left\">\n                                                <div className=\"font-bold text-slate-800\">Transferencias</div>\n                                                <div className=\"text-xs text-slate-500\">{metrics.transferSales.count} transacciones</div>\n                                            </div>\n                                        </div>\n                                        <div className=\"flex items-center gap-4\">\n                                            <span className=\"font-bold text-slate-800\">${metrics.transferSales.total.toLocaleString()}</span>\n                                            {expandedSection === 'TRANSFER' ? <ChevronDown size={18} className=\"text-slate-400\" /> : <ChevronRight size={18} className=\"text-slate-400\" />}\n                                        </div>\n                                    </button>\n                                    {expandedSection === 'TRANSFER' && (\n                                        <div className=\"bg-slate-50 border-t border-slate-100 p-2 space-y-1 max-h-60 overflow-y-auto\">\n                                            {metrics.transferSales.items.map((sale, index) => (\n                                                <div key={`${sale.id}-${index}`} className=\"flex justify-between text-sm p-2 hover:bg-white rounded-lg\">\n                                                    <span className=\"text-slate-500\">{new Date(sale.timestamp).toLocaleTimeString()}</span>\n                                                    <span className=\"font-medium text-slate-700\">${sale.total.toLocaleString()}</span>\n                                                </div>\n                                            ))}\n                                        </div>\n                                    )}\n                                </div>\n                            </div>\n\n                            {/* RIGHT: CASH FLOW & CLOSING */}\n                            <div className=\"w-1/3 flex flex-col\">\n                                <div className=\"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm mb-4 flex-1\">\n                                    <h3 className=\"font-bold text-slate-800 mb-4\">Flujo de Efectivo</h3>\n\n                                    <div className=\"space-y-3 text-sm\">\n                                        <div className=\"flex justify-between text-slate-600\">\n                                            <span>(+) Base Inicial</span>\n                                            <span className=\"font-medium\">${metrics.initialFund.toLocaleString()}</span>\n                                        </div>\n                                        <div className=\"flex justify-between text-slate-600\">\n                                            <span>(+) Ventas Efectivo</span>\n                                            <span className=\"font-medium\">${metrics.cashSales.total.toLocaleString()}</span>\n                                        </div>\n                                        <div className=\"flex justify-between text-green-600\">\n                                            <span>(+) Otros Ingresos</span>\n                                            <span className=\"font-bold\">${metrics.otherIncomes.total.toLocaleString()}</span>\n                                        </div>\n                                        <div className=\"flex justify-between text-red-500\">\n                                            <span>(-) Gastos / Salidas</span>\n                                            <span className=\"font-bold\">-${metrics.expenses.total.toLocaleString()}</span>\n                                        </div>\n\n                                        <div className=\"pt-3 border-t-2 border-slate-100 mt-2\">\n                                            <div className=\"flex justify-between items-center\">\n                                                <span className=\"font-bold text-slate-800\">DEBE HABER EN CAJA</span>\n                                                <span className=\"text-xl font-bold text-slate-900\">${metrics.expectedCash.toLocaleString()}</span>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"mt-8\">\n                                        <label className=\"block text-xs font-bold text-slate-500 uppercase mb-2\">Conteo Físico Real</label>\n                                        <div className=\"relative\">\n                                            <DollarSign className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\" />\n                                            <input\n                                                type=\"number\"\n                                                className={`w-full pl-10 p-4 border-2 rounded-xl text-2xl font-bold outline-none transition ${closingAmount && difference === 0 ? 'border-green-500 bg-green-50 text-green-700' :\n                                                    closingAmount && difference !== 0 ? 'border-red-500 bg-red-50 text-red-700' :\n                                                        'border-slate-200 bg-slate-50 text-slate-800 focus:border-cyan-500'\n                                                    }`}\n                                                placeholder=\"0\"\n                                                value={closingAmount}\n                                                onChange={e => setClosingAmount(e.target.value)}\n                                            />\n                                        </div>\n\n                                        {closingAmount && (\n                                            <div className={`mt-4 p-4 rounded-xl flex items-center gap-3 ${difference === 0 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>\n                                                {difference === 0 ? <CheckCircle size={24} /> : <AlertTriangle size={24} />}\n                                                <div>\n                                                    <div className=\"font-bold\">{difference === 0 ? 'Cuadratura Perfecta' : 'Diferencia Detectada'}</div>\n                                                    <div className=\"text-sm\">{difference > 0 ? `Sobra $${difference.toLocaleString()}` : difference < 0 ? `Falta $${Math.abs(difference).toLocaleString()}` : 'Todo en orden'}</div>\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n\n                                <button\n                                    onClick={handleCloseShift}\n                                    disabled={!closingAmount}\n                                    className=\"w-full py-4 bg-slate-900 text-white font-bold rounded-xl hover:bg-slate-800 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg\"\n                                >\n                                    Cerrar Turno\n                                </button>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CashControlModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1860, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/CashOutModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { X, DollarSign, AlertTriangle, Lock } from 'lucide-react';\nimport { PrinterService } from '../../../domain/services/PrinterService';\nimport { toast } from 'sonner';\n\ninterface CashOutModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst CashOutModal: React.FC<CashOutModalProps> = ({ isOpen, onClose }) => {\n    const { registerCashMovement, employees, currentShift, printerConfig } = usePharmaStore();\n\n    const [amount, setAmount] = useState('');\n    const [description, setDescription] = useState('');\n    const [type, setType] = useState<'GASTO' | 'RETIRO' | 'ADELANTO'>('GASTO');\n    const [pin, setPin] = useState('');\n    const [error, setError] = useState('');\n\n    if (!isOpen) return null;\n\n    const handleSave = () => {\n        if (!amount || !description || !pin) {\n            setError('Todos los campos son obligatorios');\n            return;\n        }\n\n        // Validate PIN (Manager/Admin only)\n        const supervisor = employees.find(e => (e.role === 'MANAGER' || e.role === 'ADMIN') && e.access_pin === pin);\n\n        if (!supervisor) {\n            setError('PIN no autorizado o incorrecto');\n            return;\n        }\n\n        if (!currentShift) {\n            setError('No hay turno de caja abierto');\n            return;\n        }\n\n        // Register Movement\n        const movement = {\n            type: 'OUT' as const,\n            amount: Number(amount),\n            description: `[${type}] ${description} (Auth: ${supervisor.name})`,\n            reason: (type === 'RETIRO' || type === 'ADELANTO' ? 'WITHDRAWAL' : 'SUPPLIES') as any,\n            is_cash: true\n        };\n\n        registerCashMovement(movement);\n\n        // ...\n\n        // Auto-Print\n        PrinterService.printVoucher({\n            ...movement,\n            id: `MOV-${Date.now()}`,\n            timestamp: Date.now(),\n            shift_id: currentShift.id,\n            user_id: supervisor.id\n        }, printerConfig);\n\n        toast.success('Retiro registrado y cajón abierto.');\n        onClose();\n\n        // Reset form\n        setAmount('');\n        setDescription('');\n        setPin('');\n        setError('');\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200\">\n                <div className=\"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50\">\n                    <h3 className=\"text-xl font-bold text-slate-800 flex items-center gap-2\">\n                        <DollarSign className=\"text-red-500\" /> Retiro de Caja\n                    </h3>\n                    <button onClick={onClose}><X className=\"text-slate-400 hover:text-slate-600\" /></button>\n                </div>\n\n                <div className=\"p-6 space-y-4\">\n                    {/* Type Selector */}\n                    <div className=\"grid grid-cols-3 gap-2\">\n                        {(['GASTO', 'RETIRO', 'ADELANTO'] as const).map((t) => (\n                            <button\n                                key={t}\n                                onClick={() => setType(t)}\n                                className={`py-2 px-1 rounded-xl text-xs font-bold border-2 transition-all ${type === t\n                                    ? 'border-red-500 bg-red-50 text-red-700'\n                                    : 'border-slate-100 text-slate-400 hover:bg-slate-50'\n                                    }`}\n                            >\n                                {t}\n                            </button>\n                        ))}\n                    </div>\n\n                    {/* Amount */}\n                    <div>\n                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">Monto a Retirar</label>\n                        <div className=\"relative\">\n                            <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold\">$</span>\n                            <input\n                                type=\"number\"\n                                className=\"w-full pl-8 pr-4 py-3 border-2 border-slate-200 rounded-xl font-bold text-xl focus:border-red-500 focus:outline-none\"\n                                placeholder=\"0\"\n                                value={amount}\n                                onChange={(e) => setAmount(e.target.value)}\n                            />\n                        </div>\n                    </div>\n\n                    {/* Description */}\n                    <div>\n                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">Motivo / Descripción</label>\n                        <textarea\n                            className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-red-500 focus:outline-none text-sm\"\n                            rows={2}\n                            placeholder=\"Ej: Compra de artículos de aseo...\"\n                            value={description}\n                            onChange={(e) => setDescription(e.target.value)}\n                        />\n                    </div>\n\n                    {/* Security PIN */}\n                    <div className=\"bg-red-50 p-4 rounded-xl border border-red-100\">\n                        <div className=\"flex items-center gap-2 mb-2 text-red-800 font-bold text-xs uppercase tracking-wider\">\n                            <Lock size={12} /> Autorización Requerida\n                        </div>\n                        <input\n                            type=\"password\"\n                            maxLength={4}\n                            className=\"w-full p-3 border-2 border-red-200 rounded-xl font-bold text-center tracking-[1em] focus:border-red-500 focus:outline-none bg-white\"\n                            placeholder=\"••••\"\n                            value={pin}\n                            onChange={(e) => {\n                                setPin(e.target.value);\n                                setError('');\n                            }}\n                        />\n                        <p className=\"text-[10px] text-red-600/70 text-center mt-2\">PIN de Gerente o Administrador</p>\n                    </div>\n\n                    {error && (\n                        <div className=\"flex items-center gap-2 text-red-600 text-xs font-bold bg-red-50 p-3 rounded-lg\">\n                            <AlertTriangle size={16} /> {error}\n                        </div>\n                    )}\n\n                    <button\n                        onClick={handleSave}\n                        className=\"w-full py-4 bg-red-600 text-white rounded-xl font-bold hover:bg-red-700 transition-colors shadow-lg shadow-red-200\"\n                    >\n                        Confirmar Retiro\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CashOutModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2179, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/QuickFractionModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { X, Scissors, Calculator } from 'lucide-react';\nimport { InventoryBatch, Customer } from '../../../domain/types';\nimport { usePharmaStore } from '../../store/useStore';\n\ninterface QuickFractionModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    product: InventoryBatch | null;\n    onConfirm: (quantity: number, price: number) => void;\n}\n\nconst QuickFractionModal: React.FC<QuickFractionModalProps> = ({ isOpen, onClose, product, onConfirm }) => {\n    const [quantity, setQuantity] = useState<string>('');\n    const inputRef = useRef<HTMLInputElement>(null);\n    const { currentCustomer } = usePharmaStore();\n\n    useEffect(() => {\n        if (isOpen) {\n            setQuantity('');\n            setTimeout(() => {\n                inputRef.current?.focus();\n            }, 100);\n        }\n    }, [isOpen]);\n\n    if (!isOpen || !product) return null;\n\n    const qty = parseInt(quantity) || 0;\n    const unitPrice = product.fractional_price || Math.ceil(product.price / (product.units_per_box || 1));\n    const totalPrice = qty * unitPrice;\n\n    const handleConfirm = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (qty > 0) {\n            onConfirm(qty, totalPrice);\n            onClose();\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200\">\n                {/* Header */}\n                <div className=\"bg-gradient-to-r from-blue-600 to-cyan-600 p-6 text-white flex justify-between items-center\">\n                    <div className=\"flex items-center gap-3\">\n                        <div className=\"bg-white/20 p-2 rounded-xl\">\n                            <Scissors size={24} />\n                        </div>\n                        <div>\n                            <h3 className=\"text-xl font-bold\">Venta Fraccionada</h3>\n                            <p className=\"text-blue-100 text-sm font-medium\">Art. 19 A - Venta por Unidad</p>\n                        </div>\n                    </div>\n                    <button onClick={onClose} className=\"text-white/80 hover:text-white hover:bg-white/10 p-2 rounded-full transition\">\n                        <X size={24} />\n                    </button>\n                </div>\n\n                <div className=\"p-8\">\n                    {/* Product Info */}\n                    <div className=\"mb-8 text-center\">\n                        <h4 className=\"text-lg font-bold text-slate-800 mb-1\">{product.name}</h4>\n                        <p className=\"text-slate-500 text-sm mb-4\">{product.dci} - {product.laboratory}</p>\n                        <div className=\"inline-flex items-center gap-2 bg-blue-50 text-blue-700 px-4 py-2 rounded-full font-bold text-sm\">\n                            <span>Precio Unitario: ${unitPrice.toLocaleString()}</span>\n                        </div>\n                    </div>\n\n                    <form onSubmit={handleConfirm}>\n                        <div className=\"mb-8\">\n                            <label className=\"block text-center text-sm font-bold text-slate-500 mb-3 uppercase tracking-wider\">\n                                ¿Cuántas unidades?\n                            </label>\n                            <div className=\"relative max-w-[200px] mx-auto\">\n                                <input\n                                    ref={inputRef}\n                                    type=\"number\"\n                                    min=\"1\"\n                                    className=\"w-full text-center text-5xl font-black text-slate-800 border-b-4 border-blue-500 focus:outline-none focus:border-cyan-400 py-2 bg-transparent placeholder-slate-200\"\n                                    placeholder=\"0\"\n                                    value={quantity}\n                                    onChange={(e) => setQuantity(e.target.value)}\n                                />\n                            </div>\n                        </div>\n\n                        {/* Calculation Preview */}\n                        <div className=\"bg-slate-50 rounded-2xl p-6 mb-8 flex items-center justify-between border border-slate-100\">\n                            <div className=\"flex items-center gap-3 text-slate-400\">\n                                <Calculator size={20} />\n                                <span className=\"font-medium text-lg\">{qty} x ${unitPrice.toLocaleString()}</span>\n                            </div>\n                            <div className=\"text-right\">\n                                <p className=\"text-xs font-bold text-slate-400 uppercase mb-1\">Total a Cobrar</p>\n                                <p className=\"text-3xl font-black text-slate-900\">${totalPrice.toLocaleString()}</p>\n                            </div>\n                        </div>\n\n                        {/* Customer Info (Read Only) */}\n                        {currentCustomer ? (\n                            <div className=\"mb-6 bg-emerald-50 border border-emerald-100 p-3 rounded-xl flex items-center gap-3 text-emerald-700 text-sm font-bold\">\n                                <div className=\"w-2 h-2 rounded-full bg-emerald-500\" />\n                                Cliente: {currentCustomer.fullName}\n                            </div>\n                        ) : (\n                            <div className=\"mb-6 bg-slate-50 border border-slate-100 p-3 rounded-xl text-center text-slate-400 text-xs\">\n                                Sin cliente asignado (Venta Genérica)\n                            </div>\n                        )}\n\n                        <button\n                            type=\"submit\"\n                            disabled={qty <= 0}\n                            className=\"w-full py-4 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 transition shadow-lg shadow-blue-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-lg\"\n                        >\n                            <Scissors size={20} />\n                            Agregar al Carrito\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default QuickFractionModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2538, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/CustomerSelectModal.tsx"],"sourcesContent":["import React, { useState, useMemo, useEffect, useRef } from 'react';\nimport { X, Search, UserPlus, Check, User } from 'lucide-react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { Customer } from '../../../domain/types';\nimport { toast } from 'sonner';\n\ninterface CustomerSelectModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst CustomerSelectModal: React.FC<CustomerSelectModalProps> = ({ isOpen, onClose }) => {\n    const { customers, setCustomer, addCustomer } = usePharmaStore();\n    const [searchTerm, setSearchTerm] = useState('');\n    const [isRegistering, setIsRegistering] = useState(false);\n\n    // New Customer Form State\n    const [newRut, setNewRut] = useState('');\n    const [newName, setNewName] = useState('');\n    const [newPhone, setNewPhone] = useState('');\n\n    const searchInputRef = useRef<HTMLInputElement>(null);\n\n    useEffect(() => {\n        if (isOpen) {\n            setTimeout(() => searchInputRef.current?.focus(), 100);\n            setSearchTerm('');\n            setIsRegistering(false);\n            setNewRut('');\n            setNewName('');\n            setNewPhone('');\n        }\n    }, [isOpen]);\n\n    const filteredCustomers = useMemo(() => {\n        if (!searchTerm) return [];\n        const term = searchTerm.toLowerCase();\n        return customers.filter(c =>\n            c.fullName.toLowerCase().includes(term) ||\n            c.rut.includes(term)\n        ).slice(0, 5);\n    }, [customers, searchTerm]);\n\n    const handleSelect = (customer: Customer) => {\n        setCustomer(customer);\n        toast.success(`Cliente asignado: ${customer.fullName}`);\n        onClose();\n    };\n\n    const handleQuickRegister = () => {\n        if (!newRut || !newName) {\n            toast.error('RUT y Nombre son obligatorios');\n            return;\n        }\n\n        // Basic RUT validation could go here\n\n        addCustomer({\n            rut: newRut,\n            fullName: newName,\n            phone: newPhone,\n            email: '',\n            registrationSource: 'POS'\n        });\n\n        toast.success('Cliente registrado y asignado');\n        onClose();\n    };\n\n    const handleKeyDown = (e: React.KeyboardEvent) => {\n        if (e.key === 'Escape') onClose();\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-start justify-center pt-20\" onKeyDown={handleKeyDown}>\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200\">\n                {/* Header */}\n                <div className=\"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50\">\n                    <h3 className=\"text-lg font-bold text-gray-800 flex items-center gap-2\">\n                        <User className=\"text-cyan-600\" size={20} />\n                        Asignar Cliente\n                    </h3>\n                    <button onClick={onClose} className=\"p-1 hover:bg-gray-200 rounded-full transition-colors\">\n                        <X size={20} className=\"text-gray-500\" />\n                    </button>\n                </div>\n\n                {/* Body */}\n                <div className=\"p-4\">\n                    {!isRegistering ? (\n                        <>\n                            {/* Search Mode */}\n                            <div className=\"relative mb-4\">\n                                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\" size={20} />\n                                <input\n                                    ref={searchInputRef}\n                                    type=\"text\"\n                                    placeholder=\"Buscar por RUT o Nombre...\"\n                                    className=\"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-cyan-500 focus:outline-none text-lg font-medium\"\n                                    value={searchTerm}\n                                    onChange={(e) => setSearchTerm(e.target.value)}\n                                />\n                            </div>\n\n                            <div className=\"space-y-2\">\n                                {filteredCustomers.map(customer => (\n                                    <button\n                                        key={customer.id}\n                                        onClick={() => handleSelect(customer)}\n                                        className=\"w-full p-3 text-left hover:bg-cyan-50 border border-gray-100 rounded-xl transition flex justify-between items-center group\"\n                                    >\n                                        <div>\n                                            <div className=\"font-bold text-gray-800\">{customer.fullName}</div>\n                                            <div className=\"text-xs text-gray-500 font-mono\">{customer.rut}</div>\n                                        </div>\n                                        <Check size={18} className=\"text-gray-300 group-hover:text-cyan-600\" />\n                                    </button>\n                                ))}\n\n                                {searchTerm && filteredCustomers.length === 0 && (\n                                    <div className=\"text-center py-4\">\n                                        <p className=\"text-gray-400 text-sm mb-3\">No se encontraron resultados</p>\n                                        <button\n                                            onClick={() => {\n                                                setIsRegistering(true);\n                                                setNewRut(searchTerm); // Pre-fill if it looks like a RUT?\n                                            }}\n                                            className=\"px-4 py-2 bg-slate-800 text-white rounded-lg font-bold text-sm hover:bg-slate-700 transition flex items-center gap-2 mx-auto\"\n                                        >\n                                            <UserPlus size={16} />\n                                            Registrar Nuevo Cliente\n                                        </button>\n                                    </div>\n                                )}\n                            </div>\n                        </>\n                    ) : (\n                        <div className=\"space-y-4 animate-in slide-in-from-right-4\">\n                            {/* Register Mode */}\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">RUT</label>\n                                <input\n                                    type=\"text\"\n                                    className=\"w-full p-3 border border-gray-200 rounded-xl focus:border-cyan-500 focus:outline-none font-mono\"\n                                    value={newRut}\n                                    onChange={(e) => setNewRut(e.target.value)}\n                                    placeholder=\"11.111.111-1\"\n                                    autoFocus\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Nombre Completo</label>\n                                <input\n                                    type=\"text\"\n                                    className=\"w-full p-3 border border-gray-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                                    value={newName}\n                                    onChange={(e) => setNewName(e.target.value)}\n                                    placeholder=\"Juan Pérez\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Teléfono (Opcional)</label>\n                                <input\n                                    type=\"tel\"\n                                    className=\"w-full p-3 border border-gray-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                                    value={newPhone}\n                                    onChange={(e) => setNewPhone(e.target.value)}\n                                    placeholder=\"+569...\"\n                                />\n                            </div>\n\n                            <div className=\"flex gap-3 pt-2\">\n                                <button\n                                    onClick={() => setIsRegistering(false)}\n                                    className=\"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 rounded-xl transition\"\n                                >\n                                    Volver\n                                </button>\n                                <button\n                                    onClick={handleQuickRegister}\n                                    className=\"flex-1 py-3 bg-cyan-600 text-white font-bold rounded-xl hover:bg-cyan-700 transition shadow-lg shadow-cyan-200\"\n                                >\n                                    Guardar y Asignar\n                                </button>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CustomerSelectModal;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;;;;;;;AAOA,MAAM,sBAA0D,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE;;IAChF,MAAM,EAAE,SAAS,EAAE,WAAW,EAAE,WAAW,EAAE,GAAG,IAAA,6JAAc;IAC9D,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IAEnD,0BAA0B;IAC1B,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,MAAM,iBAAiB,IAAA,uKAAM,EAAmB;IAEhD,IAAA,0KAAS;yCAAC;YACN,IAAI,QAAQ;gBACR;qDAAW,IAAM,eAAe,OAAO,EAAE;oDAAS;gBAClD,cAAc;gBACd,iBAAiB;gBACjB,UAAU;gBACV,WAAW;gBACX,YAAY;YAChB;QACJ;wCAAG;QAAC;KAAO;IAEX,MAAM,oBAAoB,IAAA,wKAAO;0DAAC;YAC9B,IAAI,CAAC,YAAY,OAAO,EAAE;YAC1B,MAAM,OAAO,WAAW,WAAW;YACnC,OAAO,UAAU,MAAM;kEAAC,CAAA,IACpB,EAAE,QAAQ,CAAC,WAAW,GAAG,QAAQ,CAAC,SAClC,EAAE,GAAG,CAAC,QAAQ,CAAC;iEACjB,KAAK,CAAC,GAAG;QACf;yDAAG;QAAC;QAAW;KAAW;IAE1B,MAAM,eAAe,CAAC;QAClB,YAAY;QACZ,oJAAK,CAAC,OAAO,CAAC,CAAC,kBAAkB,EAAE,SAAS,QAAQ,EAAE;QACtD;IACJ;IAEA,MAAM,sBAAsB;QACxB,IAAI,CAAC,UAAU,CAAC,SAAS;YACrB,oJAAK,CAAC,KAAK,CAAC;YACZ;QACJ;QAEA,qCAAqC;QAErC,YAAY;YACR,KAAK;YACL,UAAU;YACV,OAAO;YACP,OAAO;YACP,oBAAoB;QACxB;QAEA,oJAAK,CAAC,OAAO,CAAC;QACd;IACJ;IAEA,MAAM,gBAAgB,CAAC;QACnB,IAAI,EAAE,GAAG,KAAK,UAAU;IAC5B;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACI,6LAAC;QAAI,WAAU;QAAwF,WAAW;kBAC9G,cAAA,6LAAC;YAAI,WAAU;;8BAEX,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAG,WAAU;;8CACV,6LAAC,6MAAI;oCAAC,WAAU;oCAAgB,MAAM;;;;;;gCAAM;;;;;;;sCAGhD,6LAAC;4BAAO,SAAS;4BAAS,WAAU;sCAChC,cAAA,6LAAC,oMAAC;gCAAC,MAAM;gCAAI,WAAU;;;;;;;;;;;;;;;;;8BAK/B,6LAAC;oBAAI,WAAU;8BACV,CAAC,8BACE;;0CAEI,6LAAC;gCAAI,WAAU;;kDACX,6LAAC,mNAAM;wCAAC,WAAU;wCAAyD,MAAM;;;;;;kDACjF,6LAAC;wCACG,KAAK;wCACL,MAAK;wCACL,aAAY;wCACZ,WAAU;wCACV,OAAO;wCACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;0CAIrD,6LAAC;gCAAI,WAAU;;oCACV,kBAAkB,GAAG,CAAC,CAAA,yBACnB,6LAAC;4CAEG,SAAS,IAAM,aAAa;4CAC5B,WAAU;;8DAEV,6LAAC;;sEACG,6LAAC;4DAAI,WAAU;sEAA2B,SAAS,QAAQ;;;;;;sEAC3D,6LAAC;4DAAI,WAAU;sEAAmC,SAAS,GAAG;;;;;;;;;;;;8DAElE,6LAAC,gNAAK;oDAAC,MAAM;oDAAI,WAAU;;;;;;;2CARtB,SAAS,EAAE;;;;;oCAYvB,cAAc,kBAAkB,MAAM,KAAK,mBACxC,6LAAC;wCAAI,WAAU;;0DACX,6LAAC;gDAAE,WAAU;0DAA6B;;;;;;0DAC1C,6LAAC;gDACG,SAAS;oDACL,iBAAiB;oDACjB,UAAU,aAAa,mCAAmC;gDAC9D;gDACA,WAAU;;kEAEV,6LAAC,6NAAQ;wDAAC,MAAM;;;;;;oDAAM;;;;;;;;;;;;;;;;;;;;qDAQ1C,6LAAC;wBAAI,WAAU;;0CAEX,6LAAC;;kDACG,6LAAC;wCAAM,WAAU;kDAAuD;;;;;;kDACxE,6LAAC;wCACG,MAAK;wCACL,WAAU;wCACV,OAAO;wCACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;wCACzC,aAAY;wCACZ,SAAS;;;;;;;;;;;;0CAGjB,6LAAC;;kDACG,6LAAC;wCAAM,WAAU;kDAAuD;;;;;;kDACxE,6LAAC;wCACG,MAAK;wCACL,WAAU;wCACV,OAAO;wCACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;wCAC1C,aAAY;;;;;;;;;;;;0CAGpB,6LAAC;;kDACG,6LAAC;wCAAM,WAAU;kDAAuD;;;;;;kDACxE,6LAAC;wCACG,MAAK;wCACL,WAAU;wCACV,OAAO;wCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wCAC3C,aAAY;;;;;;;;;;;;0CAIpB,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;wCACG,SAAS,IAAM,iBAAiB;wCAChC,WAAU;kDACb;;;;;;kDAGD,6LAAC;wCACG,SAAS;wCACT,WAAU;kDACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjC;GAtLM;;QAC8C,6JAAc;;;KAD5D;uCAwLS"}}]
}