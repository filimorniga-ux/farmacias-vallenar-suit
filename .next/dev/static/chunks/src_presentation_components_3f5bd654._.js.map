{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/layout/LocationSelector.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useLocationStore } from '../../store/useLocationStore';\nimport { usePharmaStore } from '../../store/useStore';\nimport { MapPin, Building2, Warehouse, ChevronDown, Lock } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst LocationSelector: React.FC = () => {\n    const { currentLocation, locations, switchLocation, canSwitchLocation } = useLocationStore();\n    const { user } = usePharmaStore();\n    const [isOpen, setIsOpen] = useState(false);\n\n    const canSwitch = user ? canSwitchLocation(user.role) : false;\n\n    const getLocationIcon = (type: string) => {\n        switch (type) {\n            case 'WAREHOUSE':\n                return Warehouse;\n            case 'STORE':\n                return Building2;\n            default:\n                return MapPin;\n        }\n    };\n\n    const getLocationColor = (type: string) => {\n        switch (type) {\n            case 'WAREHOUSE':\n                return 'from-amber-500 to-orange-600';\n            case 'STORE':\n                return 'from-blue-500 to-cyan-600';\n            default:\n                return 'from-gray-500 to-gray-600';\n        }\n    };\n\n    const getLocationBadgeColor = (type: string) => {\n        switch (type) {\n            case 'WAREHOUSE':\n                return 'bg-amber-100 text-amber-700 border-amber-300';\n            case 'STORE':\n                return 'bg-blue-100 text-blue-700 border-blue-300';\n            default:\n                return 'bg-gray-100 text-gray-700 border-gray-300';\n        }\n    };\n\n    const handleLocationSwitch = (locationId: string) => {\n        if (!canSwitch) return;\n\n        switchLocation(locationId, () => {\n            setIsOpen(false);\n            // Optionally trigger data refresh here\n            // usePharmaStore.getState().syncData();\n        });\n    };\n\n    if (!currentLocation) return null;\n\n    const Icon = getLocationIcon(currentLocation.type);\n\n    return (\n        <div className=\"relative\">\n            {/* Current Location Button */}\n            <button\n                onClick={() => canSwitch && setIsOpen(!isOpen)}\n                disabled={!canSwitch}\n                className={`flex items-center gap-3 px-4 py-2.5 rounded-xl border-2 transition-all ${canSwitch\n                    ? 'hover:shadow-lg cursor-pointer'\n                    : 'opacity-75 cursor-not-allowed'\n                    } bg-gradient-to-r ${getLocationColor(currentLocation.type)} text-white border-white/20`}\n            >\n                <Icon className=\"w-5 h-5\" />\n                <div className=\"text-left\">\n                    <div className=\"text-xs font-medium opacity-90\">\n                        {currentLocation.type === 'WAREHOUSE' ? 'üè≠ BODEGA' : 'üè• SUCURSAL'}\n                    </div>\n                    <div className=\"text-sm font-bold\">\n                        {currentLocation.name.replace('Farmacia Vallenar ', '').replace('Bodega Central ', '')}\n                    </div>\n                </div>\n                {canSwitch ? (\n                    <ChevronDown className={`w-4 h-4 transition-transform ${isOpen ? 'rotate-180' : ''}`} />\n                ) : (\n                    <Lock className=\"w-4 h-4\" />\n                )}\n            </button>\n\n            {/* Dropdown Menu */}\n            <AnimatePresence>\n                {isOpen && canSwitch && (\n                    <motion.div\n                        initial={{ opacity: 0, y: -10 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        exit={{ opacity: 0, y: -10 }}\n                        transition={{ duration: 0.2 }}\n                        className=\"absolute top-full right-0 mt-2 w-80 bg-white rounded-xl shadow-2xl border border-gray-200 overflow-hidden z-50\"\n                    >\n                        {/* Header */}\n                        <div className=\"bg-gradient-to-r from-gray-50 to-gray-100 px-4 py-3 border-b border-gray-200\">\n                            <div className=\"flex items-center gap-2\">\n                                <MapPin className=\"w-4 h-4 text-gray-600\" />\n                                <span className=\"text-sm font-bold text-gray-900\">Cambiar Ubicaci√≥n</span>\n                            </div>\n                            <p className=\"text-xs text-gray-600 mt-1\">\n                                Selecciona la sucursal o bodega que deseas gestionar\n                            </p>\n                        </div>\n\n                        {/* Locations List */}\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {locations.map((location) => {\n                                const LocationIcon = getLocationIcon(location.type);\n                                const isActive = location.id === currentLocation?.id;\n\n                                return (\n                                    <button\n                                        key={location.id}\n                                        onClick={() => handleLocationSwitch(location.id)}\n                                        className={`w-full px-4 py-3 flex items-center gap-3 transition-all ${isActive\n                                            ? 'bg-blue-50 border-l-4 border-blue-600'\n                                            : 'hover:bg-gray-50 border-l-4 border-transparent'\n                                            }`}\n                                    >\n                                        <div className={`p-2 rounded-lg bg-gradient-to-br ${getLocationColor(location.type)}`}>\n                                            <LocationIcon className=\"w-5 h-5 text-white\" />\n                                        </div>\n                                        <div className=\"flex-1 text-left\">\n                                            <div className=\"flex items-center gap-2\">\n                                                <span className={`text-sm font-bold ${isActive ? 'text-blue-900' : 'text-gray-900'\n                                                    }`}>\n                                                    {location.name}\n                                                </span>\n                                                {isActive && (\n                                                    <span className=\"px-2 py-0.5 bg-blue-600 text-white text-xs font-bold rounded-full\">\n                                                        Actual\n                                                    </span>\n                                                )}\n                                            </div>\n                                            <div className=\"flex items-center gap-2 mt-1\">\n                                                <span className={`px-2 py-0.5 text-xs font-medium rounded-full border ${getLocationBadgeColor(location.type)\n                                                    }`}>\n                                                    {location.type === 'WAREHOUSE' ? 'Bodega' : 'Sucursal'}\n                                                </span>\n                                                <span className=\"text-xs text-gray-500\">\n                                                    {location.address}\n                                                </span>\n                                            </div>\n                                        </div>\n                                    </button>\n                                );\n                            })}\n                        </div>\n\n                        {/* Footer Info */}\n                        <div className=\"bg-gray-50 px-4 py-3 border-t border-gray-200\">\n                            <div className=\"flex items-center gap-2 text-xs text-gray-600\">\n                                <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n                                <span>Rol: <span className=\"font-bold text-gray-900\">{user?.role}</span></span>\n                                <span className=\"mx-1\">‚Ä¢</span>\n                                <span>Acceso: <span className=\"font-bold text-green-600\">Total</span></span>\n                            </div>\n                        </div>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n\n            {/* Locked Message for Non-Managers */}\n            {!canSwitch && (\n                <div className=\"absolute top-full right-0 mt-2 w-64 bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-xs text-yellow-800 shadow-lg z-50 hidden group-hover:block\">\n                    <div className=\"flex items-start gap-2\">\n                        <Lock className=\"w-4 h-4 mt-0.5 flex-shrink-0\" />\n                        <div>\n                            <p className=\"font-bold\">Ubicaci√≥n Bloqueada</p>\n                            <p className=\"mt-1\">\n                                Tu rol ({user?.role}) solo tiene acceso a esta ubicaci√≥n.\n                                Contacta al gerente para cambiar de sucursal.\n                            </p>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default LocationSelector;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 436, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/ui/NotificationCenter.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Bell, Check, Trash2, X, AlertTriangle, Info, CheckCircle, AlertCircle } from 'lucide-react';\nimport { useNotificationStore, Notification } from '../../store/useNotificationStore';\nimport { usePharmaStore } from '../../store/useStore';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst NotificationCenter: React.FC = () => {\n    const { notifications, markAsRead, markAllAsRead, clearAll, getUnreadCount } = useNotificationStore();\n    const { user } = usePharmaStore();\n    const [isOpen, setIsOpen] = useState(false);\n\n    const userRole = user?.role || 'GUEST';\n    const unreadCount = getUnreadCount(userRole);\n\n    const filteredNotifications = notifications.filter(\n        n => n.roleTarget === 'ALL' || n.roleTarget === userRole\n    );\n\n    const getIcon = (type: string) => {\n        switch (type) {\n            case 'CRITICAL': return <AlertCircle className=\"text-red-500\" size={20} />;\n            case 'WARNING': return <AlertTriangle className=\"text-amber-500\" size={20} />;\n            case 'SUCCESS': return <CheckCircle className=\"text-emerald-500\" size={20} />;\n            default: return <Info className=\"text-blue-500\" size={20} />;\n        }\n    };\n\n    const getBorderColor = (type: string) => {\n        switch (type) {\n            case 'CRITICAL': return 'border-l-4 border-l-red-500 bg-red-50/50';\n            case 'WARNING': return 'border-l-4 border-l-amber-500 bg-amber-50/50';\n            case 'SUCCESS': return 'border-l-4 border-l-emerald-500 bg-emerald-50/50';\n            default: return 'border-l-4 border-l-blue-500 bg-blue-50/50';\n        }\n    };\n\n    return (\n        <div className=\"relative z-50\">\n            <button\n                onClick={() => setIsOpen(!isOpen)}\n                className=\"relative p-2 text-slate-500 hover:bg-slate-100 rounded-full transition-colors\"\n            >\n                <Bell size={24} />\n                {unreadCount > 0 && (\n                    <span className=\"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold flex items-center justify-center rounded-full animate-bounce\">\n                        {unreadCount > 9 ? '9+' : unreadCount}\n                    </span>\n                )}\n            </button>\n\n            <AnimatePresence>\n                {isOpen && (\n                    <>\n                        <div\n                            className=\"fixed inset-0 z-40\"\n                            onClick={() => setIsOpen(false)}\n                        />\n                        <motion.div\n                            initial={{ opacity: 0, y: 10, scale: 0.95 }}\n                            animate={{ opacity: 1, y: 0, scale: 1 }}\n                            exit={{ opacity: 0, y: 10, scale: 0.95 }}\n                            className=\"absolute right-0 mt-2 w-96 bg-white rounded-2xl shadow-2xl border border-slate-200 z-50 overflow-hidden\"\n                        >\n                            <div className=\"p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/80 backdrop-blur-sm\">\n                                <h3 className=\"font-bold text-slate-800\">Notificaciones</h3>\n                                <div className=\"flex gap-2\">\n                                    <button\n                                        onClick={() => markAllAsRead()}\n                                        className=\"text-xs font-bold text-cyan-600 hover:text-cyan-700 flex items-center gap-1 px-2 py-1 rounded hover:bg-cyan-50\"\n                                        title=\"Marcar todas como le√≠das\"\n                                    >\n                                        <Check size={14} /> Le√≠das\n                                    </button>\n                                    <button\n                                        onClick={() => clearAll()}\n                                        className=\"text-xs font-bold text-slate-400 hover:text-red-500 flex items-center gap-1 px-2 py-1 rounded hover:bg-red-50\"\n                                        title=\"Borrar todas\"\n                                    >\n                                        <Trash2 size={14} />\n                                    </button>\n                                </div>\n                            </div>\n\n                            <div className=\"max-h-[400px] overflow-y-auto\">\n                                {filteredNotifications.length === 0 ? (\n                                    <div className=\"p-8 text-center text-slate-400\">\n                                        <Bell size={48} className=\"mx-auto mb-3 opacity-20\" />\n                                        <p className=\"text-sm\">No tienes notificaciones nuevas</p>\n                                    </div>\n                                ) : (\n                                    <div className=\"divide-y divide-slate-100\">\n                                        {filteredNotifications.map(notification => (\n                                            <div\n                                                key={notification.id}\n                                                className={`p-4 hover:bg-slate-50 transition-colors relative group ${notification.read ? 'opacity-60' : 'bg-white'} ${getBorderColor(notification.type)}`}\n                                                onClick={() => markAsRead(notification.id)}\n                                            >\n                                                <div className=\"flex gap-3\">\n                                                    <div className=\"mt-1 flex-shrink-0\">\n                                                        {getIcon(notification.type)}\n                                                    </div>\n                                                    <div className=\"flex-1\">\n                                                        <div className=\"flex justify-between items-start\">\n                                                            <h4 className={`text-sm font-bold ${notification.read ? 'text-slate-600' : 'text-slate-800'}`}>\n                                                                {notification.title}\n                                                            </h4>\n                                                            <span className=\"text-[10px] text-slate-400 whitespace-nowrap ml-2\">\n                                                                {new Date(notification.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                                                            </span>\n                                                        </div>\n                                                        <p className=\"text-xs text-slate-500 mt-1 leading-relaxed\">\n                                                            {notification.message}\n                                                        </p>\n                                                    </div>\n                                                </div>\n                                                {!notification.read && (\n                                                    <div className=\"absolute top-4 right-4 w-2 h-2 bg-cyan-500 rounded-full\" />\n                                                )}\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </motion.div>\n                    </>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n};\n\nexport default NotificationCenter;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 792, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/PrescriptionModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { FileText, Stethoscope, CheckSquare, AlertTriangle } from 'lucide-react';\n\ninterface PrescriptionModalProps {\n    isOpen: boolean;\n    onConfirm: (data: { folio: string, doctorRut: string }) => void;\n    onCancel: () => void;\n    itemName: string;\n}\n\nconst PrescriptionModal: React.FC<PrescriptionModalProps> = ({ isOpen, onConfirm, onCancel, itemName }) => {\n    const [folio, setFolio] = useState('');\n    const [doctorRut, setDoctorRut] = useState('');\n    const [isArchived, setIsArchived] = useState(false);\n\n    if (!isOpen) return null;\n\n    const isValid = folio.length > 0 && doctorRut.length > 8 && isArchived;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200\">\n                <div className=\"bg-amber-50 p-6 border-b border-amber-100\">\n                    <h3 className=\"text-xl font-bold text-amber-800 flex items-center gap-2\">\n                        <AlertTriangle className=\"text-amber-600\" /> Receta Retenida\n                    </h3>\n                    <p className=\"text-sm text-amber-700 mt-1\">\n                        La venta de <strong>{itemName}</strong> requiere receta retenida.\n                    </p>\n                </div>\n\n                <div className=\"p-6 space-y-4\">\n                    <div>\n                        <label className=\"block text-sm font-bold text-slate-700 mb-1 flex items-center gap-2\">\n                            <FileText size={16} /> Folio Receta\n                        </label>\n                        <input\n                            type=\"text\"\n                            className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-amber-500 focus:outline-none\"\n                            placeholder=\"Ej: A-123456\"\n                            value={folio}\n                            onChange={(e) => setFolio(e.target.value)}\n                        />\n                    </div>\n\n                    <div>\n                        <label className=\"block text-sm font-bold text-slate-700 mb-1 flex items-center gap-2\">\n                            <Stethoscope size={16} /> RUT M√©dico Prescriptor\n                        </label>\n                        <input\n                            type=\"text\"\n                            className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-amber-500 focus:outline-none\"\n                            placeholder=\"Ej: 11.222.333-4\"\n                            value={doctorRut}\n                            onChange={(e) => setDoctorRut(e.target.value)}\n                        />\n                    </div>\n\n                    <div className=\"bg-slate-50 p-4 rounded-xl border border-slate-200\">\n                        <label className=\"flex items-center gap-3 cursor-pointer\">\n                            <div className={`w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${isArchived ? 'bg-amber-500 border-amber-500 text-white' : 'border-slate-300 bg-white'}`}>\n                                {isArchived && <CheckSquare size={16} />}\n                            </div>\n                            <input\n                                type=\"checkbox\"\n                                className=\"hidden\"\n                                checked={isArchived}\n                                onChange={(e) => setIsArchived(e.target.checked)}\n                            />\n                            <span className=\"text-sm font-bold text-slate-700\">Receta F√≠sica Archivada</span>\n                        </label>\n                        <p className=\"text-xs text-slate-400 mt-2 ml-9\">\n                            Declaro haber recibido y archivado la receta f√≠sica correspondiente.\n                        </p>\n                    </div>\n\n                    <div className=\"flex flex-col gap-3 pt-4\">\n                        <div className=\"flex gap-3\">\n                            <button\n                                onClick={onCancel}\n                                className=\"flex-1 py-3 text-slate-500 font-bold hover:bg-slate-100 rounded-xl transition\"\n                            >\n                                Cancelar\n                            </button>\n                            <button\n                                onClick={() => isValid && onConfirm({ folio, doctorRut })}\n                                disabled={!isValid}\n                                className=\"flex-1 py-3 bg-amber-600 text-white font-bold rounded-xl hover:bg-amber-700 transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-amber-200\"\n                            >\n                                Confirmar\n                            </button>\n                        </div>\n                        <button\n                            onClick={() => onConfirm({ folio: 'PENDIENTE_VALIDACION', doctorRut: 'VALIDACION_MANUAL' })}\n                            className=\"w-full py-2 text-xs font-bold text-slate-400 hover:text-slate-600 transition uppercase tracking-wider\"\n                        >\n                            Omitir / Validar Manualmente\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default PrescriptionModal;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;AAAA;;;;;AASA,MAAM,oBAAsD,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE,QAAQ,EAAE;;IAClG,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAE7C,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,UAAU,MAAM,MAAM,GAAG,KAAK,UAAU,MAAM,GAAG,KAAK;IAE5D,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAG,WAAU;;8CACV,6LAAC,4OAAa;oCAAC,WAAU;;;;;;gCAAmB;;;;;;;sCAEhD,6LAAC;4BAAE,WAAU;;gCAA8B;8CAC3B,6LAAC;8CAAQ;;;;;;gCAAkB;;;;;;;;;;;;;8BAI/C,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;;sDACb,6LAAC,6NAAQ;4CAAC,MAAM;;;;;;wCAAM;;;;;;;8CAE1B,6LAAC;oCACG,MAAK;oCACL,WAAU;oCACV,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;sCAIhD,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;;sDACb,6LAAC,kOAAW;4CAAC,MAAM;;;;;;wCAAM;;;;;;;8CAE7B,6LAAC;oCACG,MAAK;oCACL,WAAU;oCACV,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;sCAIpD,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAM,WAAU;;sDACb,6LAAC;4CAAI,WAAW,CAAC,4EAA4E,EAAE,aAAa,6CAA6C,6BAA6B;sDACjL,4BAAc,6LAAC,6OAAW;gDAAC,MAAM;;;;;;;;;;;sDAEtC,6LAAC;4CACG,MAAK;4CACL,WAAU;4CACV,SAAS;4CACT,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,OAAO;;;;;;sDAEnD,6LAAC;4CAAK,WAAU;sDAAmC;;;;;;;;;;;;8CAEvD,6LAAC;oCAAE,WAAU;8CAAmC;;;;;;;;;;;;sCAKpD,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CACG,SAAS;4CACT,WAAU;sDACb;;;;;;sDAGD,6LAAC;4CACG,SAAS,IAAM,WAAW,UAAU;oDAAE;oDAAO;gDAAU;4CACvD,UAAU,CAAC;4CACX,WAAU;sDACb;;;;;;;;;;;;8CAIL,6LAAC;oCACG,SAAS,IAAM,UAAU;4CAAE,OAAO;4CAAwB,WAAW;wCAAoB;oCACzF,WAAU;8CACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQzB;GA7FM;KAAA;uCA+FS"}},
    {"offset": {"line": 1077, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/ManualItemModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { PlusCircle, DollarSign, Package } from 'lucide-react';\n\ninterface ManualItemModalProps {\n    isOpen: boolean;\n    onConfirm: (data: { description: string, price: number, quantity: number }) => void;\n    onClose: () => void;\n}\n\nconst ManualItemModal: React.FC<ManualItemModalProps> = ({ isOpen, onConfirm, onClose }) => {\n    const [description, setDescription] = useState('');\n    const [price, setPrice] = useState('');\n    const [quantity, setQuantity] = useState('1');\n\n    if (!isOpen) return null;\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (description && price) {\n            onConfirm({\n                description,\n                price: parseInt(price),\n                quantity: parseInt(quantity)\n            });\n            // Reset\n            setDescription('');\n            setPrice('');\n            setQuantity('1');\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-sm overflow-hidden animate-in fade-in zoom-in duration-200\">\n                <div className=\"bg-slate-900 p-4 border-b border-slate-800 text-white\">\n                    <h3 className=\"text-lg font-bold flex items-center gap-2\">\n                        <PlusCircle className=\"text-cyan-400\" /> √çtem Manual / Vario\n                    </h3>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                    <div>\n                        <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Descripci√≥n</label>\n                        <input\n                            type=\"text\"\n                            autoFocus\n                            className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                            placeholder=\"Ej: Servicio Inyectable\"\n                            value={description}\n                            onChange={(e) => setDescription(e.target.value)}\n                        />\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Precio Unit.</label>\n                            <div className=\"relative\">\n                                <DollarSign size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" />\n                                <input\n                                    type=\"number\"\n                                    className=\"w-full pl-8 pr-3 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                                    placeholder=\"0\"\n                                    value={price}\n                                    onChange={(e) => setPrice(e.target.value)}\n                                />\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Cantidad</label>\n                            <div className=\"relative\">\n                                <Package size={16} className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" />\n                                <input\n                                    type=\"number\"\n                                    className=\"w-full pl-8 pr-3 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:outline-none\"\n                                    value={quantity}\n                                    onChange={(e) => setQuantity(e.target.value)}\n                                />\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex gap-3 pt-4\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"flex-1 py-3 text-slate-500 font-bold hover:bg-slate-100 rounded-xl transition\"\n                        >\n                            Cancelar\n                        </button>\n                        <button\n                            type=\"submit\"\n                            className=\"flex-1 py-3 bg-cyan-600 text-white font-bold rounded-xl hover:bg-cyan-700 transition shadow-lg shadow-cyan-200\"\n                        >\n                            Agregar\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n};\n\nexport default ManualItemModal;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;;;;;AAQA,MAAM,kBAAkD,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE;;IACnF,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,eAAe,CAAC;QAClB,EAAE,cAAc;QAChB,IAAI,eAAe,OAAO;YACtB,UAAU;gBACN;gBACA,OAAO,SAAS;gBAChB,UAAU,SAAS;YACvB;YACA,QAAQ;YACR,eAAe;YACf,SAAS;YACT,YAAY;QAChB;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC;wBAAG,WAAU;;0CACV,6LAAC,mOAAU;gCAAC,WAAU;;;;;;4BAAkB;;;;;;;;;;;;8BAIhD,6LAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACpC,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;8CAAwD;;;;;;8CACzE,6LAAC;oCACG,MAAK;oCACL,SAAS;oCACT,WAAU;oCACV,aAAY;oCACZ,OAAO;oCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;sCAItD,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;;sDACG,6LAAC;4CAAM,WAAU;sDAAwD;;;;;;sDACzE,6LAAC;4CAAI,WAAU;;8DACX,6LAAC,mOAAU;oDAAC,MAAM;oDAAI,WAAU;;;;;;8DAChC,6LAAC;oDACG,MAAK;oDACL,WAAU;oDACV,aAAY;oDACZ,OAAO;oDACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;;;;;;;8CAIpD,6LAAC;;sDACG,6LAAC;4CAAM,WAAU;sDAAwD;;;;;;sDACzE,6LAAC;4CAAI,WAAU;;8DACX,6LAAC,sNAAO;oDAAC,MAAM;oDAAI,WAAU;;;;;;8DAC7B,6LAAC;oDACG,MAAK;oDACL,WAAU;oDACV,OAAO;oDACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;;;;;;;;;;;;;sCAM3D,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCACG,MAAK;oCACL,SAAS;oCACT,WAAU;8CACb;;;;;;8CAGD,6LAAC;oCACG,MAAK;oCACL,WAAU;8CACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQzB;GA3FM;KAAA;uCA6FS"}},
    {"offset": {"line": 1325, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/security/SupervisorOverrideModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { ShieldAlert, Lock, X, CheckCircle, AlertTriangle } from 'lucide-react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { canOverride } from '../../../domain/security/roles';\n\ninterface SupervisorOverrideModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onAuthorize: (authorizedBy: string) => void;\n    actionDescription: string;\n}\n\nexport const SupervisorOverrideModal: React.FC<SupervisorOverrideModalProps> = ({\n    isOpen,\n    onClose,\n    onAuthorize,\n    actionDescription\n}) => {\n    const [pin, setPin] = useState('');\n    const [error, setError] = useState<string | null>(null);\n    const { employees } = usePharmaStore();\n\n    const handleVerify = (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        const supervisor = employees.find(emp => emp.access_pin === pin);\n\n        if (!supervisor) {\n            setError('PIN inv√°lido. Intente nuevamente.');\n            setPin('');\n            return;\n        }\n\n        if (!canOverride(supervisor)) {\n            setError(`El usuario ${supervisor.name} (${supervisor.role}) no tiene permisos de supervisor.`);\n            setPin('');\n            return;\n        }\n\n        // Success\n        onAuthorize(supervisor.id);\n        setPin('');\n        onClose();\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <AnimatePresence>\n            <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n                <motion.div\n                    initial={{ opacity: 0, scale: 0.95 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    exit={{ opacity: 0, scale: 0.95 }}\n                    className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden\"\n                >\n                    <div className=\"bg-red-600 p-4 flex justify-between items-center text-white\">\n                        <div className=\"flex items-center gap-2\">\n                            <ShieldAlert size={24} />\n                            <h2 className=\"font-bold text-lg\">Autorizaci√≥n Requerida</h2>\n                        </div>\n                        <button onClick={onClose} className=\"hover:bg-red-700 p-1 rounded-full transition-colors\">\n                            <X size={20} />\n                        </button>\n                    </div>\n\n                    <div className=\"p-6\">\n                        <div className=\"bg-red-50 border border-red-100 rounded-lg p-4 mb-6 flex items-start gap-3\">\n                            <AlertTriangle className=\"text-red-600 shrink-0 mt-0.5\" size={20} />\n                            <div>\n                                <h3 className=\"font-bold text-red-800 text-sm mb-1\">Acci√≥n Restringida</h3>\n                                <p className=\"text-red-600 text-sm\">{actionDescription}</p>\n                            </div>\n                        </div>\n\n                        <form onSubmit={handleVerify} className=\"space-y-4\">\n                            <div>\n                                <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n                                    PIN de Supervisor (Manager/Admin)\n                                </label>\n                                <div className=\"relative\">\n                                    <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n                                    <input\n                                        type=\"password\"\n                                        value={pin}\n                                        onChange={(e) => setPin(e.target.value)}\n                                        className=\"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none text-lg tracking-widest text-center font-mono\"\n                                        placeholder=\"Ingrese PIN de 4 d√≠gitos\"\n                                        maxLength={4}\n                                        autoFocus\n                                    />\n                                </div>\n                            </div>\n\n                            {error && (\n                                <motion.div\n                                    initial={{ opacity: 0, y: -10 }}\n                                    animate={{ opacity: 1, y: 0 }}\n                                    className=\"text-red-600 text-sm font-medium text-center bg-red-50 p-2 rounded-lg\"\n                                >\n                                    {error}\n                                </motion.div>\n                            )}\n\n                            <div className=\"flex gap-3 mt-6\">\n                                <button\n                                    type=\"button\"\n                                    onClick={onClose}\n                                    className=\"flex-1 py-3 px-4 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition-colors\"\n                                >\n                                    Cancelar\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={pin.length < 4}\n                                    className=\"flex-1 py-3 px-4 bg-red-600 text-white font-bold rounded-xl hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-red-200\"\n                                >\n                                    Autorizar\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </motion.div>\n            </div>\n        </AnimatePresence>\n    );\n};\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;;AASO,MAAM,0BAAkE,CAAC,EAC5E,MAAM,EACN,OAAO,EACP,WAAW,EACX,iBAAiB,EACpB;;IACG,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAC;IAC/B,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAClD,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,6JAAc;IAEpC,MAAM,eAAe,CAAC;QAClB,EAAE,cAAc;QAChB,SAAS;QAET,MAAM,aAAa,UAAU,IAAI,CAAC,CAAA,MAAO,IAAI,UAAU,KAAK;QAE5D,IAAI,CAAC,YAAY;YACb,SAAS;YACT,OAAO;YACP;QACJ;QAEA,IAAI,CAAC,IAAA,oJAAW,EAAC,aAAa;YAC1B,SAAS,CAAC,WAAW,EAAE,WAAW,IAAI,CAAC,EAAE,EAAE,WAAW,IAAI,CAAC,kCAAkC,CAAC;YAC9F,OAAO;YACP;QACJ;QAEA,UAAU;QACV,YAAY,WAAW,EAAE;QACzB,OAAO;QACP;IACJ;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACI,6LAAC,+MAAe;kBACZ,cAAA,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC,uMAAM,CAAC,GAAG;gBACP,SAAS;oBAAE,SAAS;oBAAG,OAAO;gBAAK;gBACnC,SAAS;oBAAE,SAAS;oBAAG,OAAO;gBAAE;gBAChC,MAAM;oBAAE,SAAS;oBAAG,OAAO;gBAAK;gBAChC,WAAU;;kCAEV,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;;kDACX,6LAAC,sOAAW;wCAAC,MAAM;;;;;;kDACnB,6LAAC;wCAAG,WAAU;kDAAoB;;;;;;;;;;;;0CAEtC,6LAAC;gCAAO,SAAS;gCAAS,WAAU;0CAChC,cAAA,6LAAC,oMAAC;oCAAC,MAAM;;;;;;;;;;;;;;;;;kCAIjB,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;;kDACX,6LAAC,4OAAa;wCAAC,WAAU;wCAA+B,MAAM;;;;;;kDAC9D,6LAAC;;0DACG,6LAAC;gDAAG,WAAU;0DAAsC;;;;;;0DACpD,6LAAC;gDAAE,WAAU;0DAAwB;;;;;;;;;;;;;;;;;;0CAI7C,6LAAC;gCAAK,UAAU;gCAAc,WAAU;;kDACpC,6LAAC;;0DACG,6LAAC;gDAAM,WAAU;0DAAgD;;;;;;0DAGjE,6LAAC;gDAAI,WAAU;;kEACX,6LAAC,6MAAI;wDAAC,WAAU;wDAA0D,MAAM;;;;;;kEAChF,6LAAC;wDACG,MAAK;wDACL,OAAO;wDACP,UAAU,CAAC,IAAM,OAAO,EAAE,MAAM,CAAC,KAAK;wDACtC,WAAU;wDACV,aAAY;wDACZ,WAAW;wDACX,SAAS;;;;;;;;;;;;;;;;;;oCAKpB,uBACG,6LAAC,uMAAM,CAAC,GAAG;wCACP,SAAS;4CAAE,SAAS;4CAAG,GAAG,CAAC;wCAAG;wCAC9B,SAAS;4CAAE,SAAS;4CAAG,GAAG;wCAAE;wCAC5B,WAAU;kDAET;;;;;;kDAIT,6LAAC;wCAAI,WAAU;;0DACX,6LAAC;gDACG,MAAK;gDACL,SAAS;gDACT,WAAU;0DACb;;;;;;0DAGD,6LAAC;gDACG,MAAK;gDACL,UAAU,IAAI,MAAM,GAAG;gDACvB,WAAU;0DACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjC;GAnHa;;QAQa,6JAAc;;;KAR3B"}},
    {"offset": {"line": 1620, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/CashManagementModal.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { X, DollarSign, Camera, AlertTriangle, CheckCircle, TrendingDown, TrendingUp, Lock, ChevronDown, ChevronUp } from 'lucide-react';\nimport { CashMovementReason } from '../../../domain/types';\nimport { SupervisorOverrideModal } from '../security/SupervisorOverrideModal';\n\ninterface CashManagementModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst CashManagementModal: React.FC<CashManagementModalProps> = ({ isOpen, onClose }) => {\n    const { currentShift, openShift, closeShift, registerCashMovement, getShiftMetrics } = usePharmaStore();\n    const [activeTab, setActiveTab] = useState<'OPENING' | 'EXPENSE' | 'CLOSING'>('OPENING');\n\n    // Security State\n    const [isSupervisorModalOpen, setIsSupervisorModalOpen] = useState(false);\n    const [supervisorAction, setSupervisorAction] = useState<'OPEN' | 'CLOSE' | 'AUDIT' | null>(null);\n    const [isAuditVisible, setIsAuditVisible] = useState(false);\n\n    // Opening State\n    const [openingAmount, setOpeningAmount] = useState('');\n\n    // Expense State\n    const [expenseAmount, setExpenseAmount] = useState('');\n    const [expenseReason, setExpenseReason] = useState<CashMovementReason>('SUPPLIES');\n    const [expenseDescription, setExpenseDescription] = useState('');\n    const [expenseEvidence, setExpenseEvidence] = useState<string | null>(null);\n\n    // Closing State\n    const [closingAmount, setClosingAmount] = useState('');\n    const [metrics, setMetrics] = useState<any>(null);\n    const [expandedSection, setExpandedSection] = useState<'TRANSFER' | 'CARD' | null>(null);\n\n    useEffect(() => {\n        if (isOpen) {\n            if (!currentShift || currentShift.status === 'CLOSED') {\n                setActiveTab('OPENING');\n                setIsAuditVisible(false);\n            } else {\n                setActiveTab('EXPENSE'); // Default to expense if open\n                setMetrics(getShiftMetrics());\n                setIsAuditVisible(false); // Reset audit visibility on open\n            }\n        }\n    }, [isOpen, currentShift]);\n\n    useEffect(() => {\n        if (currentShift?.status === 'OPEN') {\n            const interval = setInterval(() => {\n                setMetrics(getShiftMetrics());\n            }, 1000); // Update metrics every second\n            return () => clearInterval(interval);\n        }\n    }, [currentShift]);\n\n\n    const handleOpenShiftRequest = () => {\n        const amount = parseInt(openingAmount);\n        if (isNaN(amount) || amount < 0) return;\n        setSupervisorAction('OPEN');\n        setIsSupervisorModalOpen(true);\n    };\n\n    const handleCloseShiftRequest = () => {\n        const amount = parseInt(closingAmount);\n        if (isNaN(amount) || amount < 0) return;\n        setSupervisorAction('CLOSE');\n        setIsSupervisorModalOpen(true);\n    };\n\n    const handleAuditRequest = () => {\n        setSupervisorAction('AUDIT');\n        setIsSupervisorModalOpen(true);\n    };\n\n    const handleSupervisorAuthorize = (authorizedBy: string) => {\n        if (supervisorAction === 'OPEN') {\n            const amount = parseInt(openingAmount);\n            openShift(amount, authorizedBy);\n            setActiveTab('EXPENSE');\n        } else if (supervisorAction === 'CLOSE') {\n            const amount = parseInt(closingAmount);\n            closeShift(amount, authorizedBy);\n            onClose();\n        } else if (supervisorAction === 'AUDIT') {\n            setIsAuditVisible(true);\n            setActiveTab('CLOSING'); // Switch to closing tab to see metrics\n        }\n        setIsSupervisorModalOpen(false);\n        setSupervisorAction(null);\n    };\n\n    const handleRegisterExpense = () => {\n        const amount = parseInt(expenseAmount);\n        if (isNaN(amount) || amount <= 0) return;\n        if (!expenseEvidence && expenseDescription.length < 10) return; // Validation rule\n\n        registerCashMovement({\n            type: 'OUT',\n            amount,\n            reason: expenseReason,\n            description: expenseDescription,\n            evidence_url: expenseEvidence || undefined,\n            is_cash: true\n        });\n\n        // Reset form\n        setExpenseAmount('');\n        setExpenseDescription('');\n        setExpenseEvidence(null);\n        alert('Gasto registrado correctamente');\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <>\n            <AnimatePresence>\n                <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    exit={{ opacity: 0 }}\n                    className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\"\n                >\n                    <motion.div\n                        initial={{ scale: 0.95, opacity: 0 }}\n                        animate={{ scale: 1, opacity: 1 }}\n                        exit={{ scale: 0.95, opacity: 0 }}\n                        className=\"bg-white rounded-2xl shadow-xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]\"\n                    >\n                        {/* Header */}\n                        <div className=\"p-6 border-b border-gray-100 flex justify-between items-center bg-slate-50\">\n                            <div>\n                                <h2 className=\"text-xl font-bold text-slate-800 flex items-center gap-2\">\n                                    <DollarSign className=\"text-blue-600\" />\n                                    Gesti√≥n de Caja\n                                </h2>\n                                <p className=\"text-sm text-slate-500\">\n                                    {currentShift?.status === 'OPEN' ? `Turno #${currentShift.shiftNumber} - Abierto` : 'Caja Cerrada'}\n                                </p>\n                            </div>\n                            <button onClick={onClose} className=\"text-slate-400 hover:text-slate-600\">\n                                <X size={24} />\n                            </button>\n                        </div>\n\n                        {/* Tabs (Only visible if shift is open) */}\n                        {currentShift?.status === 'OPEN' && (\n                            <div className=\"flex border-b border-gray-100\">\n                                <button\n                                    onClick={() => setActiveTab('EXPENSE')}\n                                    className={`flex-1 py-4 text-sm font-semibold transition-colors ${activeTab === 'EXPENSE' ? 'text-blue-600 border-b-2 border-blue-600 bg-blue-50/50' : 'text-slate-500 hover:bg-slate-50'}`}\n                                >\n                                    Registrar Salida/Gasto\n                                </button>\n                                <button\n                                    onClick={() => setActiveTab('CLOSING')}\n                                    className={`flex-1 py-4 text-sm font-semibold transition-colors ${activeTab === 'CLOSING' ? 'text-blue-600 border-b-2 border-blue-600 bg-blue-50/50' : 'text-slate-500 hover:bg-slate-50'}`}\n                                >\n                                    Arqueo y Cierre\n                                </button>\n                            </div>\n                        )}\n\n                        {/* Content */}\n                        <div className=\"p-6 overflow-y-auto flex-1\">\n\n                            {/* A. OPENING */}\n                            {activeTab === 'OPENING' && (\n                                <div className=\"text-center py-8\">\n                                    <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6 text-green-600\">\n                                        <Lock size={40} />\n                                    </div>\n                                    <h3 className=\"text-2xl font-bold text-slate-800 mb-2\">Apertura de Caja</h3>\n                                    <p className=\"text-slate-500 mb-8\">Ingresa el monto de dinero sencillo con el que inicias el turno.</p>\n\n                                    <div className=\"max-w-xs mx-auto\">\n                                        <label className=\"block text-sm font-medium text-slate-700 mb-2 text-left\">Monto Inicial</label>\n                                        <div className=\"relative\">\n                                            <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 text-lg\">$</span>\n                                            <input\n                                                type=\"number\"\n                                                value={openingAmount}\n                                                onChange={(e) => setOpeningAmount(e.target.value)}\n                                                className=\"w-full pl-8 pr-4 py-4 text-2xl font-bold text-slate-800 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all\"\n                                                placeholder=\"0\"\n                                                autoFocus\n                                            />\n                                        </div>\n                                        <button\n                                            onClick={handleOpenShiftRequest}\n                                            disabled={!openingAmount}\n                                            className=\"w-full mt-6 bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold shadow-lg shadow-blue-200 disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n                                        >\n                                            Solicitar Apertura (Supervisor)\n                                        </button>\n                                    </div>\n                                </div>\n                            )}\n\n                            {/* B. EXPENSE */}\n                            {activeTab === 'EXPENSE' && (\n                                <div className=\"space-y-6\">\n                                    <div className=\"grid grid-cols-2 gap-6\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-slate-700 mb-2\">Monto a Retirar</label>\n                                            <div className=\"relative\">\n                                                <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\">$</span>\n                                                <input\n                                                    type=\"number\"\n                                                    value={expenseAmount}\n                                                    onChange={(e) => setExpenseAmount(e.target.value)}\n                                                    className=\"w-full pl-8 pr-4 py-3 text-lg font-bold text-slate-800 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none\"\n                                                    placeholder=\"0\"\n                                                />\n                                            </div>\n                                        </div>\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-slate-700 mb-2\">Motivo</label>\n                                            <select\n                                                value={expenseReason}\n                                                onChange={(e) => setExpenseReason(e.target.value as CashMovementReason)}\n                                                className=\"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none\"\n                                            >\n                                                <option value=\"SUPPLIES\">Insumos / Gastos Menores</option>\n                                                <option value=\"SERVICES\">Pago Servicios</option>\n                                                <option value=\"WITHDRAWAL\">Retiro de Utilidades</option>\n                                                <option value=\"OTHER\">Otro</option>\n                                            </select>\n                                        </div>\n                                    </div>\n\n                                    <div>\n                                        <label className=\"block text-sm font-medium text-slate-700 mb-2\">Descripci√≥n / Justificaci√≥n</label>\n                                        <textarea\n                                            value={expenseDescription}\n                                            onChange={(e) => setExpenseDescription(e.target.value)}\n                                            className=\"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none h-24 resize-none\"\n                                            placeholder=\"Detalla el gasto (m√≠nimo 10 caracteres si no hay foto)...\"\n                                        />\n                                    </div>\n\n                                    <div className=\"border-2 border-dashed border-slate-300 rounded-xl p-6 text-center hover:bg-slate-50 transition-colors cursor-pointer relative\">\n                                        <input\n                                            type=\"file\"\n                                            className=\"absolute inset-0 opacity-0 cursor-pointer\"\n                                            onChange={(e) => setExpenseEvidence('https://via.placeholder.com/300')} // Mock upload\n                                        />\n                                        {expenseEvidence ? (\n                                            <div className=\"flex items-center justify-center gap-2 text-green-600 font-medium\">\n                                                <CheckCircle size={20} />\n                                                Evidencia Cargada\n                                            </div>\n                                        ) : (\n                                            <div className=\"flex flex-col items-center gap-2 text-slate-400\">\n                                                <Camera size={32} />\n                                                <span className=\"text-sm font-medium\">Subir Foto Boleta / Comprobante</span>\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    <button\n                                        onClick={handleRegisterExpense}\n                                        disabled={!expenseAmount || (!expenseEvidence && expenseDescription.length < 10)}\n                                        className=\"w-full bg-red-500 hover:bg-red-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-red-200 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2\"\n                                    >\n                                        <TrendingDown size={20} />\n                                        Registrar Salida de Efectivo\n                                    </button>\n                                </div>\n                            )}\n\n                            {/* C. CLOSING (RECONCILIATION) */}\n                            {activeTab === 'CLOSING' && metrics && (\n                                <div className=\"space-y-6\">\n                                    {/* Waterfall */}\n                                    <div className=\"space-y-3 bg-slate-50 p-6 rounded-2xl border border-slate-100 relative overflow-hidden\">\n                                        {!isAuditVisible && (\n                                            <div className=\"absolute inset-0 bg-slate-100/80 backdrop-blur-sm flex items-center justify-center z-10\">\n                                                <button\n                                                    onClick={handleAuditRequest}\n                                                    className=\"bg-white text-blue-600 px-6 py-3 rounded-xl font-bold shadow-lg border border-blue-100 flex items-center gap-2 hover:bg-blue-50 transition-colors\"\n                                                >\n                                                    <Lock size={18} />\n                                                    Revelar Totales (Supervisor)\n                                                </button>\n                                            </div>\n                                        )}\n\n                                        <div className=\"flex justify-between items-center text-slate-600\">\n                                            <span>(+) Ventas Totales</span>\n                                            <span className=\"font-medium\">${metrics.totalSales.toLocaleString()}</span>\n                                        </div>\n\n                                        {/* Transfer Accordion */}\n                                        <div className=\"border border-slate-200 rounded-lg overflow-hidden\">\n                                            <button\n                                                onClick={() => setExpandedSection(expandedSection === 'TRANSFER' ? null : 'TRANSFER')}\n                                                className=\"w-full flex justify-between items-center p-3 bg-slate-50 hover:bg-slate-100 transition-colors\"\n                                            >\n                                                <div className=\"flex items-center gap-2 text-purple-600 font-medium text-sm\">\n                                                    <ChevronDown size={16} className={`transition-transform ${expandedSection === 'TRANSFER' ? 'rotate-180' : ''}`} />\n                                                    üì± Transferencias ({metrics.transferCount})\n                                                </div>\n                                                <span className=\"font-bold text-slate-700\">-${metrics.transferSales.toLocaleString()}</span>\n                                            </button>\n                                            {expandedSection === 'TRANSFER' && (\n                                                <div className=\"bg-white p-3 text-xs max-h-40 overflow-y-auto\">\n                                                    <table className=\"w-full text-left\">\n                                                        <thead className=\"text-slate-400 border-b border-slate-100\">\n                                                            <tr>\n                                                                <th className=\"pb-2\">Hora</th>\n                                                                <th className=\"pb-2\">Folio</th>\n                                                                <th className=\"pb-2 text-right\">Monto</th>\n                                                            </tr>\n                                                        </thead>\n                                                        <tbody className=\"divide-y divide-slate-50\">\n                                                            {metrics.transferSalesList?.map((sale: any) => (\n                                                                <tr key={sale.id}>\n                                                                    <td className=\"py-2 text-slate-500\">{new Date(sale.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</td>\n                                                                    <td className=\"py-2 font-mono text-slate-600\">{sale.transfer_id || 'PENDIENTE'}</td>\n                                                                    <td className=\"py-2 text-right font-bold text-slate-800\">${sale.total.toLocaleString()}</td>\n                                                                </tr>\n                                                            ))}\n                                                        </tbody>\n                                                    </table>\n                                                </div>\n                                            )}\n                                        </div>\n\n                                        {/* Card Accordion */}\n                                        <div className=\"border border-slate-200 rounded-lg overflow-hidden\">\n                                            <button\n                                                onClick={() => setExpandedSection(expandedSection === 'CARD' ? null : 'CARD')}\n                                                className=\"w-full flex justify-between items-center p-3 bg-slate-50 hover:bg-slate-100 transition-colors\"\n                                            >\n                                                <div className=\"flex items-center gap-2 text-blue-600 font-medium text-sm\">\n                                                    <ChevronDown size={16} className={`transition-transform ${expandedSection === 'CARD' ? 'rotate-180' : ''}`} />\n                                                    üí≥ Tarjetas ({metrics.cardCount})\n                                                </div>\n                                                <span className=\"font-bold text-slate-700\">-${metrics.cardSales.toLocaleString()}</span>\n                                            </button>\n                                            {expandedSection === 'CARD' && (\n                                                <div className=\"bg-white p-3 text-xs max-h-40 overflow-y-auto\">\n                                                    <div className=\"space-y-2\">\n                                                        {metrics.cardSalesList?.map((sale: any) => (\n                                                            <div key={sale.id} className=\"flex justify-between items-center py-1 border-b border-slate-50 last:border-0\">\n                                                                <span className=\"text-slate-500\">{new Date(sale.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</span>\n                                                                <span className=\"font-bold text-slate-800\">${sale.total.toLocaleString()}</span>\n                                                            </div>\n                                                        ))}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n\n                                        <div className=\"flex justify-between items-center text-green-600 text-sm mt-2\">\n                                            <span>(+) Fondo Inicial</span>\n                                            <span>+${metrics.initialFund.toLocaleString()}</span>\n                                        </div>\n                                        <div className=\"flex justify-between items-center text-red-500 text-sm\">\n                                            <span>(-) Gastos / Salidas</span>\n                                            <span>-${metrics.totalOutflows.toLocaleString()}</span>\n                                        </div>\n                                        <div className=\"h-px bg-slate-200 my-2\"></div>\n                                        <div className=\"flex justify-between items-center text-xl font-bold text-slate-800\">\n                                            <span>(=) DEBE HABER EN CAJA</span>\n                                            <span>${metrics.expectedCash.toLocaleString()}</span>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"bg-blue-50 p-6 rounded-2xl border border-blue-100\">\n                                        <label className=\"block text-sm font-bold text-blue-900 mb-2 text-center\">DINERO CONTADO REAL (ARQUEO)</label>\n                                        <div className=\"relative max-w-xs mx-auto\">\n                                            <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-blue-400 text-xl\">$</span>\n                                            <input\n                                                type=\"number\"\n                                                value={closingAmount}\n                                                onChange={(e) => setClosingAmount(e.target.value)}\n                                                className=\"w-full pl-8 pr-4 py-4 text-3xl font-bold text-blue-900 bg-white border-2 border-blue-200 rounded-xl focus:ring-4 focus:ring-blue-200 focus:border-blue-400 outline-none text-center\"\n                                                placeholder=\"0\"\n                                            />\n                                        </div>\n\n                                        {closingAmount && isAuditVisible && (\n                                            <div className={`mt-4 text-center font-bold p-3 rounded-lg ${parseInt(closingAmount) - metrics.expectedCash === 0 ? 'bg-green-100 text-green-700' :\n                                                parseInt(closingAmount) - metrics.expectedCash > 0 ? 'bg-blue-100 text-blue-700' : 'bg-red-100 text-red-700'\n                                                }`}>\n                                                {parseInt(closingAmount) - metrics.expectedCash === 0 ? 'Cuadratura Perfecta ‚ú®' :\n                                                    parseInt(closingAmount) - metrics.expectedCash > 0 ? `Sobrante: +$${(parseInt(closingAmount) - metrics.expectedCash).toLocaleString()}` :\n                                                        `Faltante: -$${Math.abs(parseInt(closingAmount) - metrics.expectedCash).toLocaleString()}`}\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    <button\n                                        onClick={handleCloseShiftRequest}\n                                        disabled={!closingAmount}\n                                        className=\"w-full bg-slate-900 hover:bg-slate-800 text-white py-4 rounded-xl font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2\"\n                                    >\n                                        <Lock size={20} />\n                                        Cerrar Turno y Generar Reporte\n                                    </button>\n                                </div>\n                            )}\n                        </div>\n                    </motion.div>\n                </motion.div>\n            </AnimatePresence>\n\n            <SupervisorOverrideModal\n                isOpen={isSupervisorModalOpen}\n                onClose={() => setIsSupervisorModalOpen(false)}\n                onAuthorize={handleSupervisorAuthorize}\n                actionDescription={\n                    supervisorAction === 'OPEN' ? 'Autorizar APERTURA de turno' :\n                        supervisorAction === 'CLOSE' ? 'Autorizar CIERRE de turno' :\n                            'Autorizar ARQUEO (Ver Totales)'\n                }\n            />\n        </>\n    );\n};\n\nexport default CashManagementModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2705, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/CashOutModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { X, DollarSign, AlertTriangle, Lock } from 'lucide-react';\nimport { PrinterService } from '../../../domain/services/PrinterService';\nimport { toast } from 'sonner';\n\ninterface CashOutModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst CashOutModal: React.FC<CashOutModalProps> = ({ isOpen, onClose }) => {\n    const { registerCashMovement, employees, currentShift, printerConfig } = usePharmaStore();\n\n    const [amount, setAmount] = useState('');\n    const [description, setDescription] = useState('');\n    const [type, setType] = useState<'GASTO' | 'RETIRO' | 'ADELANTO'>('GASTO');\n    const [pin, setPin] = useState('');\n    const [error, setError] = useState('');\n\n    if (!isOpen) return null;\n\n    const handleSave = () => {\n        if (!amount || !description || !pin) {\n            setError('Todos los campos son obligatorios');\n            return;\n        }\n\n        // Validate PIN (Manager/Admin only)\n        const supervisor = employees.find(e => (e.role === 'MANAGER' || e.role === 'ADMIN') && e.access_pin === pin);\n\n        if (!supervisor) {\n            setError('PIN no autorizado o incorrecto');\n            return;\n        }\n\n        if (!currentShift) {\n            setError('No hay turno de caja abierto');\n            return;\n        }\n\n        // Register Movement\n        const movement = {\n            type: 'OUT' as const,\n            amount: Number(amount),\n            description: `[${type}] ${description} (Auth: ${supervisor.name})`,\n            reason: (type === 'RETIRO' || type === 'ADELANTO' ? 'WITHDRAWAL' : 'SUPPLIES') as any,\n            is_cash: true\n        };\n\n        registerCashMovement(movement);\n\n        // ...\n\n        // Auto-Print\n        PrinterService.printVoucher({\n            ...movement,\n            id: `MOV-${Date.now()}`,\n            timestamp: Date.now(),\n            shift_id: currentShift.id,\n            user_id: supervisor.id\n        }, printerConfig);\n\n        toast.success('Retiro registrado y caj√≥n abierto.');\n        onClose();\n\n        // Reset form\n        setAmount('');\n        setDescription('');\n        setPin('');\n        setError('');\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200\">\n                <div className=\"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50\">\n                    <h3 className=\"text-xl font-bold text-slate-800 flex items-center gap-2\">\n                        <DollarSign className=\"text-red-500\" /> Retiro de Caja\n                    </h3>\n                    <button onClick={onClose}><X className=\"text-slate-400 hover:text-slate-600\" /></button>\n                </div>\n\n                <div className=\"p-6 space-y-4\">\n                    {/* Type Selector */}\n                    <div className=\"grid grid-cols-3 gap-2\">\n                        {(['GASTO', 'RETIRO', 'ADELANTO'] as const).map((t) => (\n                            <button\n                                key={t}\n                                onClick={() => setType(t)}\n                                className={`py-2 px-1 rounded-xl text-xs font-bold border-2 transition-all ${type === t\n                                    ? 'border-red-500 bg-red-50 text-red-700'\n                                    : 'border-slate-100 text-slate-400 hover:bg-slate-50'\n                                    }`}\n                            >\n                                {t}\n                            </button>\n                        ))}\n                    </div>\n\n                    {/* Amount */}\n                    <div>\n                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">Monto a Retirar</label>\n                        <div className=\"relative\">\n                            <span className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold\">$</span>\n                            <input\n                                type=\"number\"\n                                className=\"w-full pl-8 pr-4 py-3 border-2 border-slate-200 rounded-xl font-bold text-xl focus:border-red-500 focus:outline-none\"\n                                placeholder=\"0\"\n                                value={amount}\n                                onChange={(e) => setAmount(e.target.value)}\n                            />\n                        </div>\n                    </div>\n\n                    {/* Description */}\n                    <div>\n                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">Motivo / Descripci√≥n</label>\n                        <textarea\n                            className=\"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-red-500 focus:outline-none text-sm\"\n                            rows={2}\n                            placeholder=\"Ej: Compra de art√≠culos de aseo...\"\n                            value={description}\n                            onChange={(e) => setDescription(e.target.value)}\n                        />\n                    </div>\n\n                    {/* Security PIN */}\n                    <div className=\"bg-red-50 p-4 rounded-xl border border-red-100\">\n                        <div className=\"flex items-center gap-2 mb-2 text-red-800 font-bold text-xs uppercase tracking-wider\">\n                            <Lock size={12} /> Autorizaci√≥n Requerida\n                        </div>\n                        <input\n                            type=\"password\"\n                            maxLength={4}\n                            className=\"w-full p-3 border-2 border-red-200 rounded-xl font-bold text-center tracking-[1em] focus:border-red-500 focus:outline-none bg-white\"\n                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                            value={pin}\n                            onChange={(e) => {\n                                setPin(e.target.value);\n                                setError('');\n                            }}\n                        />\n                        <p className=\"text-[10px] text-red-600/70 text-center mt-2\">PIN de Gerente o Administrador</p>\n                    </div>\n\n                    {error && (\n                        <div className=\"flex items-center gap-2 text-red-600 text-xs font-bold bg-red-50 p-3 rounded-lg\">\n                            <AlertTriangle size={16} /> {error}\n                        </div>\n                    )}\n\n                    <button\n                        onClick={handleSave}\n                        className=\"w-full py-4 bg-red-600 text-white rounded-xl font-bold hover:bg-red-700 transition-colors shadow-lg shadow-red-200\"\n                    >\n                        Confirmar Retiro\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default CashOutModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3024, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/QuickFractionModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { X, Scissors, Calculator } from 'lucide-react';\nimport { InventoryBatch, Customer } from '../../../domain/types';\nimport { usePharmaStore } from '../../store/useStore';\n\ninterface QuickFractionModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    product: InventoryBatch | null;\n    onConfirm: (quantity: number, price: number) => void;\n}\n\nconst QuickFractionModal: React.FC<QuickFractionModalProps> = ({ isOpen, onClose, product, onConfirm }) => {\n    const [quantity, setQuantity] = useState<string>('');\n    const inputRef = useRef<HTMLInputElement>(null);\n    const { currentCustomer } = usePharmaStore();\n\n    useEffect(() => {\n        if (isOpen) {\n            setQuantity('');\n            setTimeout(() => {\n                inputRef.current?.focus();\n            }, 100);\n        }\n    }, [isOpen]);\n\n    if (!isOpen || !product) return null;\n\n    const qty = parseInt(quantity) || 0;\n    const unitPrice = product.fractional_price || Math.ceil(product.price / (product.units_per_box || 1));\n    const totalPrice = qty * unitPrice;\n\n    const handleConfirm = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (qty > 0) {\n            onConfirm(qty, totalPrice);\n            onClose();\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200\">\n                {/* Header */}\n                <div className=\"bg-gradient-to-r from-blue-600 to-cyan-600 p-6 text-white flex justify-between items-center\">\n                    <div className=\"flex items-center gap-3\">\n                        <div className=\"bg-white/20 p-2 rounded-xl\">\n                            <Scissors size={24} />\n                        </div>\n                        <div>\n                            <h3 className=\"text-xl font-bold\">Venta Fraccionada</h3>\n                            <p className=\"text-blue-100 text-sm font-medium\">Art. 19 A - Venta por Unidad</p>\n                        </div>\n                    </div>\n                    <button onClick={onClose} className=\"text-white/80 hover:text-white hover:bg-white/10 p-2 rounded-full transition\">\n                        <X size={24} />\n                    </button>\n                </div>\n\n                <div className=\"p-8\">\n                    {/* Product Info */}\n                    <div className=\"mb-8 text-center\">\n                        <h4 className=\"text-lg font-bold text-slate-800 mb-1\">{product.name}</h4>\n                        <p className=\"text-slate-500 text-sm mb-4\">{product.dci} - {product.laboratory}</p>\n                        <div className=\"inline-flex items-center gap-2 bg-blue-50 text-blue-700 px-4 py-2 rounded-full font-bold text-sm\">\n                            <span>Precio Unitario: ${unitPrice.toLocaleString()}</span>\n                        </div>\n                    </div>\n\n                    <form onSubmit={handleConfirm}>\n                        <div className=\"mb-8\">\n                            <label className=\"block text-center text-sm font-bold text-slate-500 mb-3 uppercase tracking-wider\">\n                                ¬øCu√°ntas unidades?\n                            </label>\n                            <div className=\"relative max-w-[200px] mx-auto\">\n                                <input\n                                    ref={inputRef}\n                                    type=\"number\"\n                                    min=\"1\"\n                                    className=\"w-full text-center text-5xl font-black text-slate-800 border-b-4 border-blue-500 focus:outline-none focus:border-cyan-400 py-2 bg-transparent placeholder-slate-200\"\n                                    placeholder=\"0\"\n                                    value={quantity}\n                                    onChange={(e) => setQuantity(e.target.value)}\n                                />\n                            </div>\n                        </div>\n\n                        {/* Calculation Preview */}\n                        <div className=\"bg-slate-50 rounded-2xl p-6 mb-8 flex items-center justify-between border border-slate-100\">\n                            <div className=\"flex items-center gap-3 text-slate-400\">\n                                <Calculator size={20} />\n                                <span className=\"font-medium text-lg\">{qty} x ${unitPrice.toLocaleString()}</span>\n                            </div>\n                            <div className=\"text-right\">\n                                <p className=\"text-xs font-bold text-slate-400 uppercase mb-1\">Total a Cobrar</p>\n                                <p className=\"text-3xl font-black text-slate-900\">${totalPrice.toLocaleString()}</p>\n                            </div>\n                        </div>\n\n                        {/* Customer Info (Read Only) */}\n                        {currentCustomer ? (\n                            <div className=\"mb-6 bg-emerald-50 border border-emerald-100 p-3 rounded-xl flex items-center gap-3 text-emerald-700 text-sm font-bold\">\n                                <div className=\"w-2 h-2 rounded-full bg-emerald-500\" />\n                                Cliente: {currentCustomer.fullName}\n                            </div>\n                        ) : (\n                            <div className=\"mb-6 bg-slate-50 border border-slate-100 p-3 rounded-xl text-center text-slate-400 text-xs\">\n                                Sin cliente asignado (Venta Gen√©rica)\n                            </div>\n                        )}\n\n                        <button\n                            type=\"submit\"\n                            disabled={qty <= 0}\n                            className=\"w-full py-4 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 transition shadow-lg shadow-blue-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-lg\"\n                        >\n                            <Scissors size={20} />\n                            Agregar al Carrito\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default QuickFractionModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3383, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/pos/CustomerCaptureModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { User, UserPlus, ArrowRight, X, Check } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface CustomerCaptureModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onConfirm: (customerRut: string) => void;\n    onSkip: () => void;\n}\n\nconst CustomerCaptureModal: React.FC<CustomerCaptureModalProps> = ({ isOpen, onClose, onConfirm, onSkip }) => {\n    const { customers, addCustomer } = usePharmaStore();\n    const [rut, setRut] = useState('');\n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [isNewCustomer, setIsNewCustomer] = useState(false);\n    const [foundCustomer, setFoundCustomer] = useState<any>(null);\n    const inputRef = useRef<HTMLInputElement>(null);\n\n    useEffect(() => {\n        if (isOpen) {\n            setRut('');\n            setName('');\n            setPhone('');\n            setIsNewCustomer(false);\n            setFoundCustomer(null);\n            setTimeout(() => inputRef.current?.focus(), 100);\n        }\n    }, [isOpen]);\n\n    // Keyboard Shortcuts\n    useEffect(() => {\n        const handleKeyDown = (e: KeyboardEvent) => {\n            if (!isOpen) return;\n            if (e.key === 'Escape') onSkip();\n        };\n        window.addEventListener('keydown', handleKeyDown);\n        return () => window.removeEventListener('keydown', handleKeyDown);\n    }, [isOpen, onSkip]);\n\n    const formatRut = (value: string) => {\n        const clean = value.replace(/[^0-9kK]/g, '');\n        if (clean.length <= 1) return clean;\n        const body = clean.slice(0, -1);\n        const dv = clean.slice(-1).toUpperCase();\n        let formattedBody = '';\n        for (let i = body.length - 1, j = 0; i >= 0; i--, j++) {\n            formattedBody = body.charAt(i) + (j > 0 && j % 3 === 0 ? '.' : '') + formattedBody;\n        }\n        return `${formattedBody}-${dv}`;\n    };\n\n    const handleRutChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const val = formatRut(e.target.value);\n        setRut(val);\n\n        // Real-time search\n        if (val.length >= 8) {\n            const existing = customers.find(c => c.rut === val);\n            if (existing) {\n                setFoundCustomer(existing);\n                setIsNewCustomer(false);\n            } else {\n                setFoundCustomer(null);\n                // If it looks like a complete RUT, assume new\n                if (val.length >= 9) setIsNewCustomer(true);\n            }\n        } else {\n            setFoundCustomer(null);\n            setIsNewCustomer(false);\n        }\n    };\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (foundCustomer) {\n            onConfirm(foundCustomer.rut);\n        } else if (isNewCustomer && name) {\n            // Register new\n            const newCust = addCustomer({\n                rut,\n                fullName: name,\n                phone,\n                registrationSource: 'POS'\n            });\n            onConfirm(newCust.rut);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm z-[60] flex items-center justify-center p-4\">\n            <motion.div\n                initial={{ scale: 0.9, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                className=\"bg-white rounded-3xl shadow-2xl w-full max-w-lg overflow-hidden\"\n            >\n                <div className=\"p-6 bg-slate-900 text-white flex justify-between items-center\">\n                    <h3 className=\"text-xl font-bold flex items-center gap-2\">\n                        <User className=\"text-cyan-400\" /> ¬øA qui√©n vendemos?\n                    </h3>\n                    <button onClick={onSkip} className=\"text-slate-400 hover:text-white text-xs font-bold uppercase tracking-wider\">\n                        Omitir (ESC)\n                    </button>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"p-8\">\n                    <div className=\"mb-6\">\n                        <label className=\"block text-sm font-bold text-slate-600 mb-2\">RUT del Cliente</label>\n                        <input\n                            ref={inputRef}\n                            type=\"text\"\n                            value={rut}\n                            onChange={handleRutChange}\n                            className=\"w-full p-4 text-3xl font-mono font-bold border-2 border-slate-200 rounded-2xl focus:border-cyan-500 focus:outline-none text-center uppercase\"\n                            placeholder=\"12.345.678-K\"\n                            maxLength={12}\n                        />\n                    </div>\n\n                    <AnimatePresence mode=\"wait\">\n                        {foundCustomer && (\n                            <motion.div\n                                initial={{ opacity: 0, y: 10 }}\n                                animate={{ opacity: 1, y: 0 }}\n                                className=\"bg-emerald-50 border border-emerald-200 rounded-xl p-4 mb-6 flex items-center gap-4\"\n                            >\n                                <div className=\"w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-600\">\n                                    <Check size={24} />\n                                </div>\n                                <div>\n                                    <p className=\"text-emerald-800 font-bold text-lg\">{foundCustomer.fullName}</p>\n                                    <p className=\"text-emerald-600 text-sm\">Cliente Registrado</p>\n                                </div>\n                            </motion.div>\n                        )}\n\n                        {isNewCustomer && !foundCustomer && (\n                            <motion.div\n                                initial={{ opacity: 0, height: 0 }}\n                                animate={{ opacity: 1, height: 'auto' }}\n                                className=\"space-y-4 mb-6 overflow-hidden\"\n                            >\n                                <div className=\"bg-blue-50 border border-blue-200 rounded-xl p-3 text-blue-800 text-sm font-bold flex items-center gap-2\">\n                                    <UserPlus size={16} /> Cliente Nuevo - Registro R√°pido\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Nombre Completo *</label>\n                                    <input\n                                        type=\"text\"\n                                        required\n                                        value={name}\n                                        onChange={(e) => setName(e.target.value)}\n                                        className=\"w-full p-3 border-2 border-slate-200 rounded-xl font-bold focus:border-blue-500 focus:outline-none\"\n                                        placeholder=\"Ej: Juan P√©rez\"\n                                        autoFocus\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Tel√©fono (Opcional)</label>\n                                    <input\n                                        type=\"tel\"\n                                        value={phone}\n                                        onChange={(e) => setPhone(e.target.value)}\n                                        className=\"w-full p-3 border-2 border-slate-200 rounded-xl font-bold focus:border-blue-500 focus:outline-none\"\n                                        placeholder=\"+569...\"\n                                    />\n                                </div>\n                            </motion.div>\n                        )}\n                    </AnimatePresence>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <button\n                            type=\"button\"\n                            onClick={onSkip}\n                            className=\"py-4 rounded-xl font-bold text-slate-500 hover:bg-slate-100 border-2 border-transparent hover:border-slate-200 transition-all\"\n                        >\n                            Omitir\n                        </button>\n                        <button\n                            type=\"submit\"\n                            disabled={!foundCustomer && (!isNewCustomer || !name)}\n                            className=\"py-4 rounded-xl font-bold bg-cyan-600 text-white hover:bg-cyan-700 shadow-lg shadow-cyan-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                        >\n                            {foundCustomer ? 'Confirmar' : 'Registrar'} <ArrowRight size={20} />\n                        </button>\n                    </div>\n                </form>\n            </motion.div>\n        </div>\n    );\n};\n\nexport default CustomerCaptureModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3800, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/POSMainScreen.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { usePharmaStore } from '../store/useStore';\nimport { Search, Plus, X, Tag, CreditCard, Banknote, Smartphone, AlertTriangle, ShoppingCart, PlusCircle, Coins, DollarSign, Lock as LockIcon, Edit, TrendingDown, TrendingUp, Wallet, User, Bot, AlertOctagon, Snowflake, ScanBarcode, Scissors } from 'lucide-react';\nimport ClinicalSidebar from './clinical/ClinicalSidebar';\nimport { ClinicalAgent } from '../../domain/logic/clinicalAgent';\nimport ClientPanel from './pos/ClientPanel';\nimport PrescriptionModal from './pos/PrescriptionModal';\nimport ManualItemModal from './pos/ManualItemModal';\nimport CashManagementModal from './pos/CashManagementModal';\nimport CashOutModal from './pos/CashOutModal';\nimport QuickFractionModal from './pos/QuickFractionModal';\nimport { CartItem, InventoryBatch } from '../../domain/types';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nimport { useKioskGuard } from '../hooks/useKioskGuard';\nimport SafeExitButton from './security/SafeExitButton';\nimport { PrinterService } from '../../domain/services/PrinterService';\nimport CustomerCaptureModal from './pos/CustomerCaptureModal';\nimport { toast } from 'sonner';\nimport { shouldGenerateDTE } from '../../domain/logic/sii_dte';\nimport { useBarcodeScanner } from '../hooks/useBarcodeScanner';\nimport { formatProductLabel } from '../../domain/logic/productDisplay';\nimport { useSettingsStore } from '@/presentation/store/useSettingsStore';\n\nconst POSMainScreen: React.FC = () => {\n    useKioskGuard(true); // Enable Kiosk Lock\n    const {\n        inventory, cart, addToCart, addManualItem, removeFromCart, clearCart,\n        processSale, currentCustomer, currentShift, getShiftMetrics, updateOpeningAmount, employees, printerConfig,\n        setCustomer\n    } = usePharmaStore();\n\n    const { enable_sii_integration } = useSettingsStore();\n\n    const metrics = getShiftMetrics();\n    const [isEditBaseModalOpen, setIsEditBaseModalOpen] = useState(false);\n    const [supervisorPin, setSupervisorPin] = useState('');\n    const [newBaseAmount, setNewBaseAmount] = useState('');\n    const [editBaseError, setEditBaseError] = useState('');\n\n    const total = useMemo(() => cart.reduce((sum, item) => sum + item.price * item.quantity, 0), [cart]);\n    const [searchTerm, setSearchTerm] = useState('');\n    const [isPaymentModalOpen, setIsPaymentModalOpen] = useState(false);\n    const [isPrescriptionModalOpen, setIsPrescriptionModalOpen] = useState(false);\n    const [isManualItemModalOpen, setIsManualItemModalOpen] = useState(false);\n    const [isCashModalOpen, setIsCashModalOpen] = useState(false);\n    const [isCashOutModalOpen, setIsCashOutModalOpen] = useState(false);\n    const [isCustomerCaptureModalOpen, setIsCustomerCaptureModalOpen] = useState(false);\n    const [isQuickFractionModalOpen, setIsQuickFractionModalOpen] = useState(false);\n    const [selectedProductForFraction, setSelectedProductForFraction] = useState<InventoryBatch | null>(null);\n    const [pendingItemForPrescription, setPendingItemForPrescription] = useState<CartItem | null>(null);\n    const [paymentMethod, setPaymentMethod] = useState<'CASH' | 'DEBIT' | 'TRANSFER'>('CASH');\n    const [transferId, setTransferId] = useState('');\n\n    // Sidebar Tabs State\n    const [activeTab, setActiveTab] = useState<'CART' | 'CLIENT' | 'AI'>('CART');\n\n    // Barcode Scanner Integration\n    useBarcodeScanner({\n        onScan: (sku) => {\n            const product = inventory.find(p => p.sku === sku || p.id === sku);\n            if (product) {\n                addToCart(product, 1);\n                toast.success('Producto agregado', { duration: 1000, icon: <ScanBarcode /> });\n                // Play beep sound if possible\n                const audio = new Audio('/beep.mp3'); // Assuming file exists or just placeholder\n                audio.play().catch(() => { });\n            } else {\n                toast.error('Producto no encontrado');\n            }\n        }\n    });\n\n    // FEFO Sorting & Filtering - ONLY SHOW IF SEARCHING\n    const filteredInventory = useMemo(() => {\n        if (!searchTerm) return []; // Hide by default\n        return inventory\n            .filter(item =>\n                item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                item.dci.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                item.sku.toLowerCase().includes(searchTerm.toLowerCase())\n            )\n            .sort((a, b) => a.expiry_date - b.expiry_date); // FEFO: First Expired, First Out\n    }, [inventory, searchTerm]);\n\n    // Clinical Analysis\n    const clinicalAnalysis = useMemo(() => ClinicalAgent.analyzeCart(cart, currentCustomer || undefined), [cart, currentCustomer]);\n    const cartTotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);\n\n    // AI Alert Logic\n    useEffect(() => {\n        if (clinicalAnalysis.status === 'WARNING' || clinicalAnalysis.status === 'BLOCK') {\n            setActiveTab('AI'); // Auto-switch to AI tab on alert\n        }\n    }, [clinicalAnalysis.status]);\n\n    // Check for Restricted Items (R/RR/RCH)\n    const isRestricted = (item: CartItem) => {\n        const inventoryItem = inventory.find(i => i.id === item.id);\n        return inventoryItem && (inventoryItem.condition === 'R' || inventoryItem.condition === 'RR' || inventoryItem.condition === 'RCH');\n    };\n    const hasRestrictedItems = cart.some(isRestricted);\n\n    const proceedToPaymentFlow = () => {\n        if (hasRestrictedItems) {\n            setIsPrescriptionModalOpen(true);\n        } else {\n            setIsPaymentModalOpen(true);\n        }\n    };\n\n    const handlePrePayment = () => {\n        if (cart.length === 0) return;\n        // Simplified flow: Skip customer check if not strictly required, or keep it but make it faster.\n        // Prompt 2 says \"Elimina el paso intermedio de Asociar Cliente\".\n        // We will go straight to payment. If customer is needed for R/RR, the PrescriptionModal handles it or we can add it there.\n        proceedToPaymentFlow();\n    };\n\n    const handlePrescriptionConfirm = (data: { folio: string, doctorRut: string }) => {\n        setIsPrescriptionModalOpen(false);\n        setIsPaymentModalOpen(true); // Proceed to payment\n    };\n\n    const handleCheckout = () => {\n        if (cart.length === 0) return;\n        if (!currentShift || currentShift.status === 'CLOSED') {\n            toast.error('Debe abrir caja antes de vender.');\n            return;\n        }\n        if (paymentMethod === 'TRANSFER' && !transferId) {\n            // Optional ID logic: allow empty, will be marked as PENDING\n        }\n\n        // Determine DTE Status based on Settings\n        let dteResult = { shouldGenerate: false, status: 'FISCALIZED_BY_VOUCHER' as any };\n        let dteFolio = undefined;\n\n        if (enable_sii_integration) {\n            const check = shouldGenerateDTE(paymentMethod);\n            dteResult = { shouldGenerate: check.shouldGenerate, status: check.status };\n            dteFolio = dteResult.shouldGenerate ? Math.floor(Math.random() * 100000).toString() : undefined;\n        }\n\n        // Capture sale data before processing (since cart clears)\n        const saleToPrint: any = {\n            id: `V-${Date.now()}`, // Mock ID, ideally returned by processSale\n            timestamp: Date.now(),\n            items: [...cart],\n            total: cart.reduce((sum, item) => sum + item.price * item.quantity, 0),\n            payment_method: paymentMethod,\n            customer: currentCustomer || undefined,\n            transfer_id: paymentMethod === 'TRANSFER' ? (transferId || 'SIN_ID_PENDIENTE') : undefined,\n            dte_status: dteResult.status,\n            dte_folio: dteFolio,\n            is_internal_ticket: !enable_sii_integration // Flag for template\n        };\n\n        processSale(paymentMethod, currentCustomer || undefined);\n\n        // Auto-Print Trigger\n        PrinterService.printTicket(saleToPrint, printerConfig);\n\n        setIsPaymentModalOpen(false);\n        setTransferId('');\n        setPaymentMethod('CASH');\n\n        if (enable_sii_integration && dteResult.shouldGenerate) {\n            toast.success(`¬°Venta Exitosa! Boleta N¬∫ ${dteFolio} generada.`, { duration: 3000 });\n        } else if (!enable_sii_integration) {\n            toast.success('¬°Venta Exitosa! Comprobante Interno Generado.', { duration: 3000 });\n        } else {\n            toast.success('¬°Venta Exitosa! Fiscalizada por Voucher.', { duration: 3000 });\n        }\n    };\n\n    const handleUpdateBase = () => {\n        const supervisor = employees.find(e => (e.role === 'MANAGER' || e.role === 'ADMIN') && e.access_pin === supervisorPin);\n        if (supervisor) {\n            updateOpeningAmount(Number(newBaseAmount));\n            setIsEditBaseModalOpen(false);\n            setSupervisorPin('');\n            setNewBaseAmount('');\n            setEditBaseError('');\n            alert('Base actualizada correctamente');\n        } else {\n            setEditBaseError('PIN no autorizado');\n        }\n    };\n\n    const openFractionModal = (e: React.MouseEvent, product: InventoryBatch) => {\n        e.stopPropagation();\n        setSelectedProductForFraction(product);\n        setIsQuickFractionModalOpen(true);\n    };\n\n    const handleFractionConfirm = (quantity: number, price: number) => {\n        if (selectedProductForFraction) {\n            // Create a special fractional item\n            const fractionalItem: any = {\n                ...selectedProductForFraction,\n                id: `${selectedProductForFraction.id}-F`, // Unique ID for fractional\n                name: `üîµ ${selectedProductForFraction.name} (FRACCIONADO: ${quantity} un)`,\n                price: selectedProductForFraction.fractional_price || Math.ceil(selectedProductForFraction.price / (selectedProductForFraction.units_per_box || 1)),\n                quantity: quantity,\n                is_fractional: true,\n                original_name: selectedProductForFraction.name\n            };\n            // We add it as a manual item effectively, or modify addToCart to handle it.\n            // Since addToCart takes InventoryBatch, we might need to use addManualItem or a custom logic.\n            // Let's use addManualItem for now as it fits the \"custom price/name\" model, \n            // BUT we need to ensure inventory tracking. \n            // Ideally, we should update addToCart to support overrides, but for now let's construct a CartItem.\n\n            // Hack: We use addToCart but we need to pass the modified object. \n            // However, addToCart looks up by ID usually. \n            // Let's use addManualItem which simply adds to cart array.\n            addManualItem({\n                sku: selectedProductForFraction.sku, // Keep SKU for tracking\n                description: fractionalItem.name,\n                price: fractionalItem.price,\n                quantity: quantity,\n                active_ingredients: selectedProductForFraction.active_ingredients,\n                is_fractional: true,\n                original_name: selectedProductForFraction.name\n            });\n\n            toast.success('Fraccionamiento agregado', { icon: <Scissors size={16} /> });\n        }\n    };\n\n    return (\n        <div className=\"flex h-[calc(100vh-80px)] bg-slate-100 overflow-hidden\">\n\n            {/* COL 1: B√∫squeda (20%) */}\n            <div className=\"w-[25%] flex flex-col p-6 pr-3 gap-4\">\n                <div className=\"bg-white rounded-3xl shadow-sm border border-slate-200 flex flex-col h-full overflow-hidden\">\n                    <div className=\"p-6 border-b border-slate-100\">\n                        <div className=\"relative w-full\">\n                            <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400\" size={24} />\n                            <input\n                                type=\"text\"\n                                placeholder=\"Buscar...\"\n                                className=\"w-full pl-12 pr-4 py-4 bg-slate-50 border-2 border-slate-200 rounded-2xl focus:border-cyan-500 focus:outline-none transition-colors font-bold text-lg\"\n                                value={searchTerm}\n                                onChange={(e) => setSearchTerm(e.target.value)}\n                                autoFocus\n                            />\n                        </div>\n                        <p className=\"text-xs text-slate-400 mt-2 text-center\">Escanee un producto para agregarlo r√°pido</p>\n                    </div>\n\n                    <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\n                        {searchTerm ? (\n                            filteredInventory.map(item => (\n                                <div\n                                    key={item.id}\n                                    onClick={() => addToCart(item, 1)}\n                                    className=\"bg-white p-3 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:border-cyan-200 cursor-pointer transition-all group\"\n                                >\n                                    <h3 className=\"font-bold text-slate-800 text-sm leading-tight mb-1 group-hover:text-cyan-600\">\n                                        {item.name}\n                                    </h3>\n                                    <p className=\"text-[10px] text-slate-500 font-mono mb-1\">{item.dci}</p>\n                                    <div className=\"flex justify-between items-center\">\n                                        <span className=\"font-bold text-slate-900\">${item.price.toLocaleString()}</span>\n                                        <div className=\"flex items-center gap-2\">\n                                            {item.is_fractionable && (\n                                                <button\n                                                    onClick={(e) => openFractionModal(e, item)}\n                                                    className=\"p-1.5 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors\"\n                                                    title=\"Venta Fraccionada\"\n                                                >\n                                                    <Scissors size={16} />\n                                                </button>\n                                            )}\n                                            <span className={`text-[10px] px-1.5 py-0.5 rounded ${item.stock_actual > 0 ? 'bg-emerald-100 text-emerald-700' : 'bg-red-100 text-red-700'}`}>Stock: {item.stock_actual}</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            ))\n                        ) : (\n                            <div className=\"h-full flex flex-col items-center justify-center text-slate-300 opacity-50\">\n                                <Search size={48} className=\"mb-4\" />\n                                <p className=\"text-sm font-bold\">Escriba para buscar</p>\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n\n            {/* COL 2: Carrito y Pago (80%) */}\n            <div className=\"flex-1 flex flex-col p-6 pl-0 gap-4\">\n                <div className=\"flex-1 bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden flex flex-col\">\n                    {/* Header */}\n                    <div className=\"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50\">\n                        <div className=\"flex items-center gap-4\">\n                            <div className=\"bg-cyan-100 p-3 rounded-2xl text-cyan-700\">\n                                <ShoppingCart size={28} />\n                            </div>\n                            <div>\n                                <h1 className=\"text-2xl font-extrabold text-slate-800\">Carrito de Compra</h1>\n                                <p className=\"text-sm text-slate-500\">{cart.length} √≠tems agregados</p>\n                            </div>\n                            {/* Shift Status Badge */}\n                            <div className={`px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2 ${currentShift?.status === 'OPEN' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>\n                                <div className={`w-2 h-2 rounded-full ${currentShift?.status === 'OPEN' ? 'bg-green-500 animate-pulse' : 'bg-red-500'}`} />\n                                {currentShift?.status === 'OPEN' ? `TURNO #${currentShift.shiftNumber} - ABIERTO` : 'CAJA CERRADA'}\n                            </div>\n                        </div>\n                        <div className=\"flex gap-3\">\n                            <button\n                                onClick={() => setIsCashModalOpen(true)}\n                                className=\"flex items-center gap-2 bg-blue-600 text-white px-5 py-3 rounded-xl hover:bg-blue-700 font-bold transition-colors shadow-lg shadow-blue-200\"\n                            >\n                                <DollarSign size={20} />\n                                <span className=\"hidden lg:inline\">Gesti√≥n Caja</span>\n                            </button>\n                            <button\n                                onClick={() => setIsManualItemModalOpen(true)}\n                                className=\"flex items-center gap-2 bg-purple-100 text-purple-700 px-5 py-3 rounded-xl hover:bg-purple-200 font-bold transition-colors\"\n                            >\n                                <Plus size={20} />\n                                <span className=\"hidden lg:inline\">Item Manual</span>\n                            </button>\n                            <button\n                                onClick={clearCart}\n                                className=\"flex items-center gap-2 bg-red-50 text-red-600 px-5 py-3 rounded-xl hover:bg-red-100 font-bold transition-colors\"\n                            >\n                                <X size={20} />\n                                <span className=\"hidden lg:inline\">Limpiar</span>\n                            </button>\n                        </div>\n                    </div>\n\n                    {/* Cart Items */}\n                    <div className=\"flex-1 overflow-y-auto p-6\">\n                        {cart.length === 0 ? (\n                            <div className=\"h-full flex flex-col items-center justify-center text-slate-300\">\n                                <ShoppingCart size={80} className=\"mb-6 opacity-20\" />\n                                <h3 className=\"text-2xl font-bold text-slate-400\">El carrito est√° vac√≠o</h3>\n                                <p className=\"text-slate-400\">Escanee un producto o use el buscador</p>\n                            </div>\n                        ) : (\n                            <table className=\"w-full\">\n                                <thead className=\"text-left text-slate-400 text-xs uppercase tracking-wider border-b border-slate-100\">\n                                    <tr>\n                                        <th className=\"pb-3 pl-4\">Producto (Seremi)</th>\n                                        <th className=\"pb-3 text-center\">Cant.</th>\n                                        <th className=\"pb-3 text-right\">Precio Unit.</th>\n                                        <th className=\"pb-3 text-right\">Total</th>\n                                        <th className=\"pb-3\"></th>\n                                    </tr>\n                                </thead>\n                                <tbody className=\"divide-y divide-slate-50\">\n                                    {cart.map((item, idx) => {\n                                        // Find full inventory item to get details for formatting\n                                        const fullItem = inventory.find(i => i.id === item.id);\n                                        const label = fullItem ? formatProductLabel(fullItem) : item.name;\n\n                                        return (\n                                            <tr key={idx} className=\"group hover:bg-slate-50 transition-colors\">\n                                                <td className=\"py-4 pl-4\">\n                                                    <div className=\"flex flex-col\">\n                                                        <span className={`font-bold text-lg ${item.is_fractional ? 'text-blue-600' : 'text-slate-800'}`}>{item.name}</span>\n                                                        <span className=\"text-xs text-slate-500 font-mono\">{label}</span>\n                                                    </div>\n                                                </td>\n                                                <td className=\"py-4 text-center\">\n                                                    <div className=\"inline-flex items-center bg-white border border-slate-200 rounded-lg\">\n                                                        <button className=\"px-3 py-1 hover:bg-slate-100 text-slate-600 font-bold\">-</button>\n                                                        <span className=\"px-3 font-bold text-slate-800\">{item.quantity}</span>\n                                                        <button className=\"px-3 py-1 hover:bg-slate-100 text-slate-600 font-bold\">+</button>\n                                                    </div>\n                                                </td>\n                                                <td className=\"py-4 text-right font-medium text-slate-600\">\n                                                    ${item.price.toLocaleString()}\n                                                </td>\n                                                <td className=\"py-4 text-right font-bold text-slate-900 text-xl\">\n                                                    ${(item.price * item.quantity).toLocaleString()}\n                                                </td>\n                                                <td className=\"py-4 text-right pr-4\">\n                                                    <button onClick={() => removeFromCart(item.sku)} className=\"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors\">\n                                                        <X size={20} />\n                                                    </button>\n                                                </td>\n                                            </tr>\n                                        );\n                                    })}\n                                </tbody>\n                            </table>\n                        )}\n                    </div>\n\n                    {/* Footer / Total */}\n                    <div className=\"bg-slate-900 text-white p-8 flex justify-between items-center\">\n                        <div className=\"flex gap-8\">\n                            <div>\n                                <p className=\"text-slate-400 text-sm mb-1\">√çtems</p>\n                                <p className=\"text-2xl font-bold\">{cart.reduce((acc, item) => acc + item.quantity, 0)}</p>\n                            </div>\n                            <div>\n                                <p className=\"text-slate-400 text-sm mb-1\">Subtotal</p>\n                                <p className=\"text-2xl font-bold\">${cartTotal.toLocaleString()}</p>\n                            </div>\n                        </div>\n                        <div className=\"flex items-center gap-8\">\n                            <div className=\"text-right\">\n                                <p className=\"text-slate-400 text-sm mb-1\">Total a Pagar</p>\n                                <p className=\"text-5xl font-extrabold text-emerald-400\">${cartTotal.toLocaleString()}</p>\n                            </div>\n                            <button\n                                onClick={handlePrePayment}\n                                disabled={cart.length === 0 || !currentShift || currentShift.status === 'CLOSED'}\n                                className=\"bg-emerald-500 hover:bg-emerald-400 text-emerald-950 px-12 py-6 rounded-2xl font-extrabold text-2xl shadow-lg shadow-emerald-900/50 transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\"\n                            >\n                                PAGAR (F9)\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Modals */}\n            <PrescriptionModal\n                isOpen={isPrescriptionModalOpen}\n                onCancel={() => setIsPrescriptionModalOpen(false)}\n                onConfirm={handlePrescriptionConfirm}\n                itemName={pendingItemForPrescription?.name || ''}\n            />\n\n            <ManualItemModal\n                isOpen={isManualItemModalOpen}\n                onClose={() => setIsManualItemModalOpen(false)}\n                onConfirm={(item) => { addManualItem(item); setIsManualItemModalOpen(false); }}\n            />\n\n            <CashManagementModal\n                isOpen={isCashModalOpen}\n                onClose={() => setIsCashModalOpen(false)}\n            />\n\n            <CashOutModal\n                isOpen={isCashOutModalOpen}\n                onClose={() => setIsCashOutModalOpen(false)}\n            />\n\n            <QuickFractionModal\n                isOpen={isQuickFractionModalOpen}\n                onClose={() => setIsQuickFractionModalOpen(false)}\n                product={selectedProductForFraction}\n                onConfirm={handleFractionConfirm}\n            />\n\n            {/* Edit Base Modal */}\n            {isEditBaseModalOpen && (\n                <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n                    <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-sm p-6 animate-in fade-in zoom-in duration-200\">\n                        <h3 className=\"text-xl font-bold text-slate-800 mb-4\">Ajustar Base Inicial</h3>\n\n                        <div className=\"space-y-4\">\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-600 mb-1\">Nuevo Monto Base</label>\n                                <input\n                                    type=\"number\"\n                                    className=\"w-full p-3 border-2 border-slate-200 rounded-xl font-bold text-lg\"\n                                    value={newBaseAmount}\n                                    onChange={(e) => setNewBaseAmount(e.target.value)}\n                                    placeholder=\"$0\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-bold text-slate-600 mb-1\">PIN Supervisor (Manager)</label>\n                                <input\n                                    type=\"password\"\n                                    maxLength={4}\n                                    className=\"w-full p-3 border-2 border-slate-200 rounded-xl font-bold text-lg tracking-widest text-center\"\n                                    value={supervisorPin}\n                                    onChange={(e) => {\n                                        setSupervisorPin(e.target.value);\n                                        setEditBaseError('');\n                                    }}\n                                    placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                                />\n                            </div>\n\n                            {editBaseError && <p className=\"text-red-500 text-sm font-bold text-center\">{editBaseError}</p>}\n\n                            <div className=\"grid grid-cols-2 gap-3 mt-6\">\n                                <button\n                                    onClick={() => setIsEditBaseModalOpen(false)}\n                                    className=\"py-3 rounded-xl font-bold text-slate-500 hover:bg-slate-100\"\n                                >\n                                    Cancelar\n                                </button>\n                                <button\n                                    onClick={handleUpdateBase}\n                                    className=\"py-3 rounded-xl font-bold bg-cyan-600 text-white hover:bg-cyan-700\"\n                                >\n                                    Confirmar\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* Payment Modal */}\n            {isPaymentModalOpen && (\n                <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n                    <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200\">\n                        <div className=\"p-6 border-b border-slate-100 flex justify-between items-center\">\n                            <h3 className=\"text-xl font-bold text-slate-800\">Finalizar Venta</h3>\n                            <button onClick={() => setIsPaymentModalOpen(false)}><X className=\"text-slate-400\" /></button>\n                        </div>\n\n                        <div className=\"p-6\">\n                            <div className=\"grid grid-cols-3 gap-4 mb-8\">\n                                <button\n                                    onClick={() => setPaymentMethod('CASH')}\n                                    className={`p-4 rounded-2xl border-2 flex flex-col items-center gap-2 transition-all ${paymentMethod === 'CASH' ? 'border-emerald-500 bg-emerald-50 text-emerald-700' : 'border-slate-100 text-slate-400'}`}\n                                >\n                                    <Banknote size={24} />\n                                    <span className=\"text-xs font-bold\">EFECTIVO</span>\n                                </button>\n                                <button\n                                    onClick={() => setPaymentMethod('DEBIT')}\n                                    className={`p-4 rounded-2xl border-2 flex flex-col items-center gap-2 transition-all ${paymentMethod === 'DEBIT' ? 'border-blue-500 bg-blue-50 text-blue-700' : 'border-slate-100 text-slate-400'}`}\n                                >\n                                    <CreditCard size={24} />\n                                    <span className=\"text-xs font-bold\">TARJETA</span>\n                                </button>\n                                <button\n                                    onClick={() => setPaymentMethod('TRANSFER')}\n                                    className={`p-4 rounded-2xl border-2 flex flex-col items-center gap-2 transition-all ${paymentMethod === 'TRANSFER' ? 'border-purple-500 bg-purple-50 text-purple-700' : 'border-slate-100 text-slate-400'}`}\n                                >\n                                    <Smartphone size={24} />\n                                    <span className=\"text-xs font-bold\">TRANSF.</span>\n                                </button>\n                            </div>\n\n                            {paymentMethod === 'TRANSFER' && (\n                                <div className=\"mb-6 animate-in fade-in slide-in-from-top-2\">\n                                    <label className=\"block text-sm font-bold text-slate-700 mb-2\">ID de Transacci√≥n</label>\n                                    <input\n                                        type=\"text\"\n                                        className=\"w-full p-3 border-2 border-slate-300 rounded-xl focus:border-purple-500 focus:outline-none\"\n                                        placeholder=\"Ej: 12345678 (Opcional)\"\n                                        value={transferId}\n                                        onChange={(e) => setTransferId(e.target.value)}\n                                    />\n                                    <p className=\"text-xs text-slate-400 mt-2 flex items-center\">\n                                        <AlertTriangle size={12} className=\"mr-1\" />\n                                        Puede ingresar el ID despu√©s en el historial si es necesario.\n                                    </p>\n                                </div>\n                            )}\n\n                            <button\n                                onClick={handleCheckout}\n                                className=\"w-full py-4 bg-cyan-600 text-white font-bold rounded-xl hover:bg-cyan-700 transition shadow-lg shadow-cyan-200 flex items-center justify-center gap-2\"\n                            >\n                                <DollarSign size={20} /> CONFIRMAR PAGO\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            )}\n            {/* Customer Capture Modal */}\n            <CustomerCaptureModal\n                isOpen={isCustomerCaptureModalOpen}\n                onClose={() => setIsCustomerCaptureModalOpen(false)}\n                onConfirm={(rut) => {\n                    // Logic to handle captured customer\n                    setIsCustomerCaptureModalOpen(false);\n                    proceedToPaymentFlow();\n                }}\n                onSkip={() => {\n                    setIsCustomerCaptureModalOpen(false);\n                    proceedToPaymentFlow();\n                }}\n            />\n\n            {/* Cash Management Modal */}\n            <CashManagementModal\n                isOpen={isCashModalOpen}\n                onClose={() => setIsCashModalOpen(false)}\n            />\n        </div>\n    );\n};\n\n// Helper Icon\nconst ClockIcon = ({ size }: { size: number }) => (\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n        <circle cx=\"12\" cy=\"12\" r=\"10\" />\n        <polyline points=\"12 6 12 12 16 14\" />\n    </svg>\n);\n\nexport default POSMainScreen;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5256, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/scm/BlindReceptionModal.tsx"],"sourcesContent":["\nimport React, { useState } from 'react';\nimport { Truck, Lock, Save } from 'lucide-react';\nimport { PurchaseOrder } from '../../../domain/types';\n\ninterface BlindReceptionModalProps {\n    order: PurchaseOrder;\n    onReceive: (order: PurchaseOrder, receivedItems: { sku: string; receivedQty: number }[]) => void;\n    onClose: () => void;\n}\n\nconst BlindReceptionModal: React.FC<BlindReceptionModalProps> = ({ order, onReceive, onClose }) => {\n    const [receivedQuantities, setReceivedQuantities] = useState<{ [sku: string]: number }>({});\n\n    const handleInputChange = (sku: string, value: string) => {\n        setReceivedQuantities(prev => ({\n            ...prev,\n            [sku]: parseInt(value) || 0\n        }));\n    };\n\n    const totalReceived = order.items.reduce((sum, item) => sum + (receivedQuantities[item.sku] || 0), 0);\n\n    // Comprobar si todas las cantidades han sido ingresadas manualmente\n    const isComplete = order.items.every(item => receivedQuantities[item.sku] !== undefined && receivedQuantities[item.sku] >= 0);\n\n    const inputStyle = \"w-full py-2 border-2 border-slate-400 rounded-lg text-center font-semibold text-lg text-slate-900\";\n\n\n    return (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white p-8 rounded-xl w-full max-w-2xl shadow-2xl\">\n                <h3 className=\"text-2xl font-bold text-slate-900 mb-6 flex items-center\">\n                    <Truck className=\"mr-3\" /> Recepci√≥n Ciega de Orden #{order.id}\n                </h3>\n\n                <p className=\"text-red-600 font-semibold mb-4 flex items-center\">\n                    <Lock size={18} className=\"mr-2\" /> La cantidad esperada (Expected Qty) NO es visible. Debe contar manualmente.\n                </p>\n\n                <div className=\"max-h-80 overflow-y-auto space-y-4 pr-2\">\n                    {order.items.map((item) => (\n                        <div key={item.sku} className=\"flex items-center justify-between border-b pb-3\">\n                            <p className=\"font-semibold text-slate-700 w-1/2\">{item.name}</p>\n                            <div className=\"w-1/3 ml-4\">\n                                <input\n                                    type=\"number\"\n                                    placeholder=\"Cantidad Real Recibida\"\n                                    className={inputStyle}\n                                    value={receivedQuantities[item.sku] || ''}\n                                    onChange={(e) => handleInputChange(item.sku, e.target.value)}\n                                />\n                            </div>\n                        </div>\n                    ))}\n                </div>\n\n                <div className=\"mt-8 pt-4 border-t border-slate-200\">\n                    <p className=\"text-xl font-bold text-slate-900 mb-4\">Total de Unidades Contadas: {totalReceived}</p>\n                    <button\n                        className=\"w-full py-3 bg-cyan-700 text-white font-bold rounded-xl hover:bg-cyan-800 transition disabled:opacity-50 flex items-center justify-center\"\n                        onClick={() => isComplete && onReceive(order, Object.entries(receivedQuantities).map(([sku, receivedQty]) => ({ sku, receivedQty })))}\n                        disabled={!isComplete}\n                    >\n                        <Save size={20} className=\"mr-2\" /> Confirmar Recepci√≥n Ciega\n                    </button>\n                    <button className=\"mt-2 w-full py-2 text-slate-600 hover:text-slate-900 transition\" onClick={onClose}>Cancelar</button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default BlindReceptionModal;\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAAA;;;;;AASA,MAAM,sBAA0D,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE;;IAC1F,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAA4B,CAAC;IAEzF,MAAM,oBAAoB,CAAC,KAAa;QACpC,sBAAsB,CAAA,OAAQ,CAAC;gBAC3B,GAAG,IAAI;gBACP,CAAC,IAAI,EAAE,SAAS,UAAU;YAC9B,CAAC;IACL;IAEA,MAAM,gBAAgB,MAAM,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,CAAC,kBAAkB,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,GAAG;IAEnG,oEAAoE;IACpE,MAAM,aAAa,MAAM,KAAK,CAAC,KAAK,CAAC,CAAA,OAAQ,kBAAkB,CAAC,KAAK,GAAG,CAAC,KAAK,aAAa,kBAAkB,CAAC,KAAK,GAAG,CAAC,IAAI;IAE3H,MAAM,aAAa;IAGnB,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAG,WAAU;;sCACV,6LAAC,gNAAK;4BAAC,WAAU;;;;;;wBAAS;wBAA4B,MAAM,EAAE;;;;;;;8BAGlE,6LAAC;oBAAE,WAAU;;sCACT,6LAAC,6MAAI;4BAAC,MAAM;4BAAI,WAAU;;;;;;wBAAS;;;;;;;8BAGvC,6LAAC;oBAAI,WAAU;8BACV,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,qBACd,6LAAC;4BAAmB,WAAU;;8CAC1B,6LAAC;oCAAE,WAAU;8CAAsC,KAAK,IAAI;;;;;;8CAC5D,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC;wCACG,MAAK;wCACL,aAAY;wCACZ,WAAW;wCACX,OAAO,kBAAkB,CAAC,KAAK,GAAG,CAAC,IAAI;wCACvC,UAAU,CAAC,IAAM,kBAAkB,KAAK,GAAG,EAAE,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;2BAR7D,KAAK,GAAG;;;;;;;;;;8BAe1B,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAE,WAAU;;gCAAwC;gCAA6B;;;;;;;sCAClF,6LAAC;4BACG,WAAU;4BACV,SAAS,IAAM,cAAc,UAAU,OAAO,OAAO,OAAO,CAAC,oBAAoB,GAAG,CAAC,CAAC,CAAC,KAAK,YAAY,GAAK,CAAC;wCAAE;wCAAK;oCAAY,CAAC;4BAClI,UAAU,CAAC;;8CAEX,6LAAC,6MAAI;oCAAC,MAAM;oCAAI,WAAU;;;;;;gCAAS;;;;;;;sCAEvC,6LAAC;4BAAO,WAAU;4BAAkE,SAAS;sCAAS;;;;;;;;;;;;;;;;;;;;;;;AAK1H;GA5DM;KAAA;uCA8DS"}},
    {"offset": {"line": 5441, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/inventory/StockEntryModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { X, ScanBarcode, Save, Package, Calendar, AlertTriangle, CheckCircle2 } from 'lucide-react';\nimport { InventoryBatch } from '../../../domain/types';\nimport { usePharmaStore } from '../../store/useStore';\nimport { toast } from 'sonner';\n\ninterface StockEntryModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst StockEntryModal: React.FC<StockEntryModalProps> = ({ isOpen, onClose }) => {\n    const { inventory, updateStock, addNewProduct } = usePharmaStore();\n    const [activeTab, setActiveTab] = useState<'SCAN' | 'CREATE'>('SCAN');\n    const [step, setStep] = useState<'SCAN' | 'DETAILS' | 'NEW_PRODUCT'>('SCAN');\n    const [scannedSku, setScannedSku] = useState('');\n    const [selectedProduct, setSelectedProduct] = useState<InventoryBatch | null>(null);\n\n    // Agile Fields\n    const [lot, setLot] = useState('');\n    const [expiry, setExpiry] = useState('');\n    const [quantity, setQuantity] = useState('');\n\n    // New Product Fields\n    const [newProductData, setNewProductData] = useState<Partial<InventoryBatch>>({});\n\n    const scanInputRef = useRef<HTMLInputElement>(null);\n    const lotInputRef = useRef<HTMLInputElement>(null);\n    const expiryInputRef = useRef<HTMLInputElement>(null);\n    const qtyInputRef = useRef<HTMLInputElement>(null);\n\n    useEffect(() => {\n        if (isOpen) {\n            resetFlow();\n        }\n    }, [isOpen]);\n\n    const resetFlow = () => {\n        setStep('SCAN');\n        setScannedSku('');\n        setSelectedProduct(null);\n        setLot('');\n        setExpiry('');\n        setQuantity('');\n        setNewProductData({});\n        if (activeTab === 'SCAN') {\n            setTimeout(() => scanInputRef.current?.focus(), 100);\n        }\n    };\n\n    const handleScan = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!scannedSku) return;\n\n        const product = inventory.find(p => p.sku === scannedSku);\n        if (product) {\n            setSelectedProduct(product);\n            setStep('DETAILS');\n            setTimeout(() => lotInputRef.current?.focus(), 100);\n            toast.success('Producto Identificado');\n        } else {\n            setNewProductData({ sku: scannedSku });\n            setStep('NEW_PRODUCT');\n            toast.info('Producto Nuevo Detectado');\n        }\n    };\n\n    const handleQuickSave = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!selectedProduct || !quantity) return;\n\n        // Parse Expiry (DDMMAA -> Timestamp)\n        let expiryTimestamp = Date.now();\n        if (expiry.length === 6) {\n            const day = parseInt(expiry.substring(0, 2));\n            const month = parseInt(expiry.substring(2, 4)) - 1;\n            const year = 2000 + parseInt(expiry.substring(4, 6));\n            expiryTimestamp = new Date(year, month, day).getTime();\n        }\n\n        // Update Stock (In a real app, this would create a batch entry)\n        updateStock(selectedProduct.id, parseInt(quantity));\n\n        toast.success(`Ingresadas ${quantity} un. de ${selectedProduct.name}`);\n        resetFlow();\n    };\n\n    const handleNewProductSave = (e: React.FormEvent) => {\n        e.preventDefault();\n        // Validate mandatory fields\n        if (!newProductData.name || !newProductData.dci || !newProductData.isp_register) {\n            toast.error('Faltan campos obligatorios');\n            return;\n        }\n\n        const newProduct: InventoryBatch = {\n            id: `BATCH-${Date.now()}`,\n            sku: scannedSku,\n            name: newProductData.name!,\n            dci: newProductData.dci!,\n            active_ingredient: newProductData.dci!,\n            laboratory: newProductData.laboratory || 'GENERICO',\n            isp_register: newProductData.isp_register!,\n            unit_format_string: newProductData.unit_format_string || 'Unidad',\n            units_per_package: Number(newProductData.units_per_package) || 1,\n            price: Number(newProductData.price) || 0,\n            cost_price: Number(newProductData.cost_price) || 0,\n            stock_actual: Number(quantity) || 0,\n            stock_min: 10,\n            stock_max: 100,\n            expiry_date: Date.now(), // Should parse expiry\n            location_id: 'BODEGA_CENTRAL',\n            condition: 'VD',\n            category: 'MEDICAMENTO',\n            allows_commission: false,\n            active_ingredients: [newProductData.dci!],\n            is_generic: false,\n            bioequivalent_status: newProductData.bioequivalent ? 'BIOEQUIVALENTE' : 'NO_BIOEQUIVALENTE',\n            is_bioequivalent: newProductData.bioequivalent || false,\n            bioequivalent: newProductData.bioequivalent || false,\n            concentration: newProductData.concentration || '',\n            format: newProductData.format || '',\n            unit_count: Number(newProductData.units_per_package) || 1\n        };\n\n        addNewProduct(newProduct);\n        toast.success('Producto Creado e Ingresado');\n        resetFlow();\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden\">\n                {/* Header */}\n                <div className=\"bg-slate-900 p-6 flex justify-between items-center text-white\">\n                    <div className=\"flex items-center gap-3\">\n                        <Package className=\"text-cyan-400\" size={28} />\n                        <div>\n                            <h2 className=\"text-xl font-bold\">Ingreso R√°pido de Stock</h2>\n                            <p className=\"text-slate-400 text-sm\">WMS √Ågil - Bodega Central</p>\n                        </div>\n                    </div>\n                    <button onClick={onClose} className=\"text-slate-400 hover:text-white\"><X /></button>\n                </div>\n\n                {/* Tabs */}\n                <div className=\"flex border-b border-slate-100\">\n                    <button\n                        onClick={() => { setActiveTab('SCAN'); resetFlow(); }}\n                        className={`flex-1 py-4 font-bold text-sm transition-colors ${activeTab === 'SCAN' ? 'text-cyan-600 border-b-2 border-cyan-600 bg-cyan-50' : 'text-slate-500 hover:bg-slate-50'}`}\n                    >\n                        Escaneo R√°pido (Stock)\n                    </button>\n                    <button\n                        onClick={() => { setActiveTab('CREATE'); setStep('NEW_PRODUCT'); }}\n                        className={`flex-1 py-4 font-bold text-sm transition-colors ${activeTab === 'CREATE' ? 'text-amber-600 border-b-2 border-amber-600 bg-amber-50' : 'text-slate-500 hover:bg-slate-50'}`}\n                    >\n                        Crear Producto Maestro\n                    </button>\n                </div>\n\n                <div className=\"p-8\">\n                    {/* TAB A: SCAN */}\n                    {activeTab === 'SCAN' && step === 'SCAN' && (\n                        <form onSubmit={handleScan} className=\"flex flex-col items-center justify-center py-12\">\n                            <div className=\"relative w-full max-w-md\">\n                                <ScanBarcode className=\"absolute left-4 top-1/2 -translate-y-1/2 text-cyan-500 animate-pulse\" size={32} />\n                                <input\n                                    ref={scanInputRef}\n                                    type=\"text\"\n                                    value={scannedSku}\n                                    onChange={(e) => setScannedSku(e.target.value)}\n                                    className=\"w-full pl-16 pr-4 py-6 bg-slate-50 border-4 border-slate-200 rounded-2xl text-3xl font-bold text-center focus:border-cyan-500 focus:outline-none transition-all\"\n                                    placeholder=\"Escanear C√≥digo...\"\n                                    autoFocus\n                                />\n                            </div>\n                            <p className=\"mt-4 text-slate-400 font-medium\">Presione Enter tras escanear</p>\n                        </form>\n                    )}\n\n                    {/* TAB A: DETAILS (After Scan) */}\n                    {activeTab === 'SCAN' && step === 'DETAILS' && selectedProduct && (\n                        <form onSubmit={handleQuickSave} className=\"space-y-6\">\n                            <div className=\"bg-cyan-50 border border-cyan-100 p-4 rounded-xl flex items-center gap-4\">\n                                <div className=\"bg-white p-2 rounded-lg shadow-sm\">\n                                    <CheckCircle2 className=\"text-cyan-600\" size={32} />\n                                </div>\n                                <div>\n                                    <h3 className=\"text-xl font-bold text-slate-800\">{selectedProduct.name}</h3>\n                                    <p className=\"text-slate-500\">{selectedProduct.dci} - {selectedProduct.laboratory}</p>\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-bold text-slate-500 mb-1\">Lote</label>\n                                    <input\n                                        ref={lotInputRef}\n                                        type=\"text\"\n                                        value={lot}\n                                        onChange={(e) => setLot(e.target.value)}\n                                        className=\"w-full p-3 border-2 border-slate-200 rounded-xl font-bold text-lg focus:border-cyan-500 focus:outline-none\"\n                                        placeholder=\"Ej: L-2024\"\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-sm font-bold text-slate-500 mb-1\">Vencimiento</label>\n                                    <div className=\"relative\">\n                                        <Calendar className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n                                        <input\n                                            ref={expiryInputRef}\n                                            type=\"text\"\n                                            value={expiry}\n                                            onChange={(e) => setExpiry(e.target.value)}\n                                            className=\"w-full pl-10 p-3 border-2 border-slate-200 rounded-xl font-bold text-lg focus:border-cyan-500 focus:outline-none\"\n                                            placeholder=\"DDMMAA\"\n                                            maxLength={6}\n                                        />\n                                    </div>\n                                </div>\n                                <div>\n                                    <label className=\"block text-sm font-bold text-slate-500 mb-1\">Cantidad</label>\n                                    <input\n                                        ref={qtyInputRef}\n                                        type=\"number\"\n                                        value={quantity}\n                                        onChange={(e) => setQuantity(e.target.value)}\n                                        className=\"w-full p-3 border-2 border-slate-200 rounded-xl font-bold text-lg focus:border-cyan-500 focus:outline-none\"\n                                        placeholder=\"0\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"flex gap-3 pt-4\">\n                                <button type=\"button\" onClick={resetFlow} className=\"flex-1 py-4 rounded-xl font-bold text-slate-500 hover:bg-slate-100\">\n                                    Cancelar\n                                </button>\n                                <button type=\"submit\" className=\"flex-[2] py-4 bg-cyan-600 text-white rounded-xl font-bold hover:bg-cyan-700 shadow-lg shadow-cyan-200 flex items-center justify-center gap-2\">\n                                    <Save size={20} /> Guardar Ingreso\n                                </button>\n                            </div>\n                        </form>\n                    )}\n\n                    {/* TAB B: NEW PRODUCT FORM */}\n                    {(activeTab === 'CREATE' || (activeTab === 'SCAN' && step === 'NEW_PRODUCT')) && (\n                        <form onSubmit={handleNewProductSave} className=\"space-y-4\">\n                            <div className=\"bg-amber-50 border border-amber-100 p-4 rounded-xl flex items-center gap-3 mb-4\">\n                                <AlertTriangle className=\"text-amber-600\" />\n                                <div>\n                                    <h3 className=\"font-bold text-amber-800\">Producto Nuevo</h3>\n                                    <p className=\"text-xs text-amber-600\">Complete los datos sanitarios obligatorios (DS 466)</p>\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Nombre Comercial</label>\n                                    <input\n                                        className=\"w-full p-2 border rounded-lg\"\n                                        value={newProductData.name || ''}\n                                        onChange={e => setNewProductData({ ...newProductData, name: e.target.value })}\n                                        autoFocus\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Principio Activo (DCI)</label>\n                                    <input\n                                        className=\"w-full p-2 border rounded-lg\"\n                                        value={newProductData.dci || ''}\n                                        onChange={e => setNewProductData({ ...newProductData, dci: e.target.value })}\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Registro ISP</label>\n                                    <input\n                                        className=\"w-full p-2 border rounded-lg\"\n                                        placeholder=\"Ej: F-1234/20\"\n                                        value={newProductData.isp_register || ''}\n                                        onChange={e => setNewProductData({ ...newProductData, isp_register: e.target.value })}\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Laboratorio</label>\n                                    <input\n                                        className=\"w-full p-2 border rounded-lg\"\n                                        value={newProductData.laboratory || ''}\n                                        onChange={e => setNewProductData({ ...newProductData, laboratory: e.target.value })}\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Unidades por Caja</label>\n                                    <input\n                                        type=\"number\"\n                                        className=\"w-full p-2 border rounded-lg\"\n                                        value={newProductData.units_per_package || ''}\n                                        onChange={e => setNewProductData({ ...newProductData, units_per_package: parseInt(e.target.value) })}\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-2 pt-6\">\n                                    <input\n                                        type=\"checkbox\"\n                                        id=\"bio\"\n                                        checked={newProductData.bioequivalent || false}\n                                        onChange={e => setNewProductData({ ...newProductData, bioequivalent: e.target.checked })}\n                                        className=\"w-5 h-5 text-cyan-600\"\n                                    />\n                                    <label htmlFor=\"bio\" className=\"text-sm font-bold text-slate-700\">Es Bioequivalente</label>\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4 border-t pt-4\">\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Cantidad Inicial</label>\n                                    <input\n                                        type=\"number\"\n                                        className=\"w-full p-2 border rounded-lg font-bold\"\n                                        value={quantity}\n                                        onChange={e => setQuantity(e.target.value)}\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-bold text-slate-500 mb-1\">Precio Venta</label>\n                                    <input\n                                        type=\"number\"\n                                        className=\"w-full p-2 border rounded-lg font-bold\"\n                                        value={newProductData.price || ''}\n                                        onChange={e => setNewProductData({ ...newProductData, price: parseInt(e.target.value) })}\n                                    />\n                                </div>\n                            </div>\n\n                            <button type=\"submit\" className=\"w-full py-3 bg-cyan-600 text-white rounded-xl font-bold hover:bg-cyan-700 mt-4\">\n                                Crear y Guardar\n                            </button>\n                        </form>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default StockEntryModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6279, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/inventory/StockTransferModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { ArrowRightLeft, MapPin, Box, Search } from 'lucide-react';\nimport { InventoryBatch } from '../../../domain/types';\n\ninterface StockTransferModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst StockTransferModal: React.FC<StockTransferModalProps> = ({ isOpen, onClose }) => {\n    const { inventory, transferStock } = usePharmaStore();\n    const [searchTerm, setSearchTerm] = useState('');\n    const [selectedProduct, setSelectedProduct] = useState<InventoryBatch | null>(null);\n    const [qty, setQty] = useState('');\n    const [targetLocation, setTargetLocation] = useState('SUCURSAL_CENTRO');\n\n    if (!isOpen) return null;\n\n    const filteredInventory = inventory.filter(i =>\n        i.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        i.sku.includes(searchTerm)\n    );\n\n    const handleTransfer = () => {\n        if (selectedProduct && qty) {\n            transferStock(selectedProduct.id, targetLocation as any, parseInt(qty));\n            onClose();\n            setSearchTerm('');\n            setSelectedProduct(null);\n            setQty('');\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200\">\n                <div className=\"bg-slate-900 p-6 border-b border-slate-800 text-white\">\n                    <h3 className=\"text-xl font-bold flex items-center gap-2\">\n                        <ArrowRightLeft className=\"text-purple-400\" /> Transferencia de Stock\n                    </h3>\n                </div>\n\n                <div className=\"p-6 space-y-6\">\n                    {/* 1. Select Product */}\n                    {!selectedProduct ? (\n                        <div>\n                            <label className=\"block text-xs font-bold text-slate-500 mb-2 uppercase\">1. Buscar Producto (Origen)</label>\n                            <div className=\"relative mb-4\">\n                                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n                                <input\n                                    type=\"text\"\n                                    autoFocus\n                                    placeholder=\"Nombre o SKU...\"\n                                    className=\"w-full pl-10 pr-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-500 focus:outline-none\"\n                                    value={searchTerm}\n                                    onChange={(e) => setSearchTerm(e.target.value)}\n                                />\n                            </div>\n                            <div className=\"h-48 overflow-y-auto border border-slate-100 rounded-xl bg-slate-50 p-2 space-y-2\">\n                                {filteredInventory.map(item => (\n                                    <div\n                                        key={item.id}\n                                        onClick={() => setSelectedProduct(item)}\n                                        className=\"p-3 bg-white rounded-lg border border-slate-200 hover:border-purple-400 cursor-pointer transition flex justify-between items-center\"\n                                    >\n                                        <div>\n                                            <p className=\"font-bold text-sm text-slate-800\">{item.name}</p>\n                                            <p className=\"text-xs text-slate-500\">{item.location_id}</p>\n                                        </div>\n                                        <span className=\"bg-slate-100 text-slate-600 px-2 py-1 rounded text-xs font-bold\">Stock: {item.stock_actual}</span>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                    ) : (\n                        <div className=\"bg-purple-50 border border-purple-100 rounded-xl p-4 flex justify-between items-center\">\n                            <div>\n                                <h4 className=\"font-bold text-purple-900\">{selectedProduct.name}</h4>\n                                <p className=\"text-xs text-purple-700\">Origen: {selectedProduct.location_id}</p>\n                            </div>\n                            <button onClick={() => setSelectedProduct(null)} className=\"text-xs font-bold text-purple-500 hover:text-purple-700\">CAMBIAR</button>\n                        </div>\n                    )}\n\n                    {/* 2. Transfer Details */}\n                    {selectedProduct && (\n                        <div className=\"grid grid-cols-2 gap-4 animate-in fade-in slide-in-from-bottom-2\">\n                            <div>\n                                <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Destino</label>\n                                <div className=\"relative\">\n                                    <MapPin className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={16} />\n                                    <select\n                                        className=\"w-full pl-9 pr-3 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-500 focus:outline-none appearance-none bg-white\"\n                                        value={targetLocation}\n                                        onChange={(e) => setTargetLocation(e.target.value)}\n                                    >\n                                        <option value=\"SUCURSAL_CENTRO\">Sucursal Centro</option>\n                                        <option value=\"SUCURSAL_NORTE\">Sucursal Norte</option>\n                                        <option value=\"BODEGA_CENTRAL\">Bodega Central</option>\n                                        <option value=\"KIOSCO\">Kiosco</option>\n                                    </select>\n                                </div>\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Cantidad</label>\n                                <div className=\"relative\">\n                                    <Box className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={16} />\n                                    <input\n                                        type=\"number\"\n                                        className=\"w-full pl-9 pr-3 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-500 focus:outline-none\"\n                                        max={selectedProduct.stock_actual}\n                                        value={qty}\n                                        onChange={(e) => setQty(e.target.value)}\n                                    />\n                                </div>\n                                <p className=\"text-[10px] text-right text-slate-400 mt-1\">M√°x: {selectedProduct.stock_actual}</p>\n                            </div>\n                        </div>\n                    )}\n\n                    <div className=\"flex gap-3 pt-4\">\n                        <button onClick={onClose} className=\"flex-1 py-3 text-slate-500 font-bold hover:bg-slate-100 rounded-xl transition\">Cancelar</button>\n                        <button\n                            onClick={handleTransfer}\n                            disabled={!selectedProduct || !qty || parseInt(qty) > (selectedProduct?.stock_actual || 0)}\n                            className=\"flex-1 py-3 bg-purple-600 text-white font-bold rounded-xl hover:bg-purple-700 transition shadow-lg shadow-purple-200 disabled:opacity-50\"\n                        >\n                            Transferir\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default StockTransferModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6688, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/inventory/InventoryEditModal.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { X, Save, Thermometer, AlertTriangle, Tag, Package, DollarSign, Activity, Barcode, Syringe, Calendar, Trash2, Plus, Edit2 } from 'lucide-react';\nimport { InventoryBatch } from '../../../domain/types';\nimport { usePharmaStore } from '../../store/useStore';\nimport { toast } from 'sonner';\n\ninterface InventoryEditModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    product: InventoryBatch | null;\n}\n\nconst InventoryEditModal: React.FC<InventoryEditModalProps> = ({ isOpen, onClose, product }) => {\n    const { updateProduct, inventory, updateBatchDetails, addNewProduct } = usePharmaStore();\n    const [formData, setFormData] = useState<Partial<InventoryBatch>>({});\n    const [activeBatches, setActiveBatches] = useState<InventoryBatch[]>([]);\n    const [newTag, setNewTag] = useState('');\n\n    useEffect(() => {\n        if (product) {\n            setFormData({\n                ...product,\n                contraindications: product.contraindications || [],\n                therapeutic_tags: product.therapeutic_tags || []\n            });\n            // Filter batches for this product (assuming SKU is the grouper)\n            setActiveBatches(inventory.filter(i => i.sku === product.sku && i.stock_actual > 0));\n        }\n    }, [product, inventory]);\n\n    if (!isOpen || !product) return null;\n\n    const handleSave = () => {\n        if (product.id) {\n            // Update the main product (and potentially all batches if we want to sync shared data)\n            // For now, we update the specific batch passed as \"product\"\n            updateProduct(product.id, formData);\n\n            // In a real \"Master Product\" scenario, we might want to update ALL batches with shared data\n            // inventory.filter(i => i.sku === product.sku).forEach(b => updateProduct(b.id, formData));\n\n            toast.success('Producto actualizado correctamente');\n            onClose();\n        }\n    };\n\n    const handleBatchUpdate = (batchId: string, field: keyof InventoryBatch, value: any) => {\n        updateBatchDetails(product.id, batchId, { [field]: value });\n        toast.success('Lote actualizado');\n    };\n\n    const handleAddBatch = () => {\n        const newBatch: InventoryBatch = {\n            ...product,\n            id: `NEW-${Date.now()}`, // Temporary ID\n            stock_actual: 0,\n            expiry_date: Date.now() + 31536000000, // +1 year\n            location_id: 'BODEGA_CENTRAL',\n            aisle: '',\n            created_at: Date.now(),\n            updated_at: Date.now()\n        };\n        addNewProduct(newBatch); // Using addNewProduct as \"addBatch\" effectively\n        toast.success('Nuevo lote creado');\n    };\n\n    const handleMermarBatch = (batchId: string) => {\n        if (confirm('¬øEst√°s seguro de dar de baja este lote? El stock quedar√° en 0.')) {\n            updateBatchDetails(product.id, batchId, { stock_actual: 0 });\n            toast.success('Lote dado de baja');\n        }\n    };\n\n    const handleAddTag = (e: React.KeyboardEvent) => {\n        if (e.key === 'Enter' && newTag.trim()) {\n            e.preventDefault();\n            const currentTags = formData.therapeutic_tags || [];\n            if (!currentTags.includes(newTag.trim().toUpperCase())) {\n                setFormData({\n                    ...formData,\n                    therapeutic_tags: [...currentTags, newTag.trim().toUpperCase()]\n                });\n            }\n            setNewTag('');\n        }\n    };\n\n    const removeTag = (tagToRemove: string) => {\n        setFormData({\n            ...formData,\n            therapeutic_tags: (formData.therapeutic_tags || []).filter(tag => tag !== tagToRemove)\n        });\n    };\n\n    const toggleContraindication = (ci: string) => {\n        const current = formData.contraindications || [];\n        if (current.includes(ci)) {\n            setFormData({ ...formData, contraindications: current.filter(c => c !== ci) });\n        } else {\n            setFormData({ ...formData, contraindications: [...current, ci] });\n        }\n    };\n\n    // SEREMI Calculation\n    const pricePerUnit = formData.price && formData.units_per_package\n        ? Math.round(formData.price / formData.units_per_package)\n        : 0;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-5xl h-[90vh] flex flex-col animate-in fade-in zoom-in duration-200\">\n                {/* Header */}\n                <div className=\"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50 rounded-t-3xl\">\n                    <div>\n                        <h2 className=\"text-2xl font-bold text-slate-800 flex items-center gap-2\">\n                            <Package className=\"text-cyan-600\" />\n                            Gestor Maestro de Producto\n                        </h2>\n                        <p className=\"text-slate-500 text-sm\">{product.name} ({product.sku})</p>\n                    </div>\n                    <div className=\"flex gap-2\">\n                        <button\n                            onClick={handleSave}\n                            className=\"px-6 py-2 bg-cyan-600 text-white font-bold rounded-xl hover:bg-cyan-700 transition flex items-center gap-2 shadow-lg shadow-cyan-200\"\n                        >\n                            <Save size={18} /> Guardar Cambios\n                        </button>\n                        <button onClick={onClose} className=\"p-2 hover:bg-slate-200 rounded-full transition-colors\">\n                            <X size={24} className=\"text-slate-400\" />\n                        </button>\n                    </div>\n                </div>\n\n                {/* Content */}\n                <div className=\"flex-1 overflow-y-auto p-8 bg-slate-50/30\">\n                    <div className=\"grid grid-cols-12 gap-8\">\n\n                        {/* Left Column: Master Data */}\n                        <div className=\"col-span-12 lg:col-span-7 space-y-6\">\n\n                            {/* 1. IDENTIFICACI√ìN R√ÅPIDA (NEW) */}\n                            <section className=\"bg-white p-6 rounded-2xl shadow-sm border border-slate-100\">\n                                <h3 className=\"text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2\">\n                                    <Tag size={16} /> Identificaci√≥n R√°pida\n                                </h3>\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">C√≥digo de Barras (EAN)</label>\n                                        <div className=\"relative\">\n                                            <Barcode className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n                                            <input\n                                                type=\"text\"\n                                                className=\"w-full pl-10 p-3 border border-slate-200 rounded-xl font-mono text-slate-700 focus:border-cyan-500 focus:outline-none bg-slate-50\"\n                                                value={formData.barcode || ''}\n                                                onChange={e => setFormData({ ...formData, barcode: e.target.value })}\n                                                placeholder=\"Escanea aqu√≠...\"\n                                            />\n                                        </div>\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">V√≠a de Administraci√≥n</label>\n                                        <div className=\"relative\">\n                                            <Syringe className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n                                            <select\n                                                className=\"w-full pl-10 p-3 border border-slate-200 rounded-xl font-bold text-slate-700 focus:border-cyan-500 focus:outline-none appearance-none bg-white\"\n                                                value={formData.administration_route || ''}\n                                                onChange={e => setFormData({ ...formData, administration_route: e.target.value as any })}\n                                            >\n                                                <option value=\"\">Seleccionar...</option>\n                                                <option value=\"ORAL\">Oral</option>\n                                                <option value=\"TOPICA\">T√≥pica</option>\n                                                <option value=\"OFTALMICA\">Oft√°lmica</option>\n                                                <option value=\"NASAL\">Nasal</option>\n                                                <option value=\"RECTAL\">Rectal</option>\n                                                <option value=\"VAGINAL\">Vaginal</option>\n                                                <option value=\"PARENTERAL\">Parenteral (Inyectable)</option>\n                                            </select>\n                                        </div>\n                                    </div>\n                                </div>\n                            </section>\n\n                            {/* 2. DATOS SANITARIOS (SEREMI) */}\n                            <section className=\"bg-amber-50 p-6 rounded-2xl border border-amber-100 shadow-sm\">\n                                <h3 className=\"text-sm font-bold text-amber-700 uppercase tracking-wider mb-4 flex items-center gap-2\">\n                                    <AlertTriangle size={16} /> Datos Sanitarios (Norma Seremi)\n                                </h3>\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                    <div className=\"col-span-2\">\n                                        <label className=\"block text-xs font-bold text-amber-800/60 mb-1\">Principio Activo (DCI)</label>\n                                        <input\n                                            type=\"text\"\n                                            className=\"w-full p-3 border border-amber-200 rounded-xl font-bold text-slate-700 focus:border-amber-500 focus:outline-none bg-white\"\n                                            value={formData.dci || ''}\n                                            onChange={e => setFormData({ ...formData, dci: e.target.value })}\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-amber-800/60 mb-1\">Laboratorio</label>\n                                        <input\n                                            type=\"text\"\n                                            className=\"w-full p-3 border border-amber-200 rounded-xl font-bold bg-white\"\n                                            value={formData.laboratory || ''}\n                                            onChange={e => setFormData({ ...formData, laboratory: e.target.value })}\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-amber-800/60 mb-1\">Registro ISP</label>\n                                        <input\n                                            type=\"text\"\n                                            className=\"w-full p-3 border border-amber-200 rounded-xl font-mono text-sm bg-white\"\n                                            value={formData.isp_register || ''}\n                                            onChange={e => setFormData({ ...formData, isp_register: e.target.value })}\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-amber-800/60 mb-1\">Unidades por Caja</label>\n                                        <input\n                                            type=\"number\"\n                                            className=\"w-full p-3 border border-amber-200 rounded-xl font-mono bg-white\"\n                                            value={formData.units_per_package || 1}\n                                            onChange={e => setFormData({ ...formData, units_per_package: parseInt(e.target.value) })}\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-amber-800/60 mb-1\">Precio Unitario Calc.</label>\n                                        <div className=\"w-full p-3 bg-amber-100/50 border border-amber-200 rounded-xl font-mono font-bold text-amber-800\">\n                                            ${pricePerUnit}\n                                        </div>\n                                    </div>\n                                </div>\n                            </section>\n\n                            {/* 3. DATOS COMERCIALES */}\n                            <section className=\"bg-white p-6 rounded-2xl shadow-sm border border-slate-100\">\n                                <h3 className=\"text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2\">\n                                    <DollarSign size={16} /> Datos Comerciales\n                                </h3>\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                    <div className=\"col-span-2\">\n                                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">Nombre Comercial</label>\n                                        <input\n                                            type=\"text\"\n                                            className=\"w-full p-3 border border-slate-200 rounded-xl font-bold text-slate-700 focus:border-cyan-500 focus:outline-none\"\n                                            value={formData.name || ''}\n                                            onChange={e => setFormData({ ...formData, name: e.target.value })}\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">Precio Venta</label>\n                                        <input\n                                            type=\"number\"\n                                            className=\"w-full p-3 border border-slate-200 rounded-xl font-mono\"\n                                            value={formData.price || 0}\n                                            onChange={e => setFormData({ ...formData, price: Number(e.target.value) })}\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-xs font-bold text-slate-500 mb-1\">Costo Neto</label>\n                                        <input\n                                            type=\"number\"\n                                            className=\"w-full p-3 border border-slate-200 rounded-xl font-mono\"\n                                            value={formData.cost_price || 0}\n                                            onChange={e => setFormData({ ...formData, cost_price: Number(e.target.value) })}\n                                        />\n                                    </div>\n                                </div>\n                            </section>\n                        </div>\n\n                        {/* Right Column: Batch Management & Tags */}\n                        <div className=\"col-span-12 lg:col-span-5 space-y-6\">\n\n                            {/* 4. GESTI√ìN DE LOTES (CRITICAL) */}\n                            <section className=\"bg-slate-800 text-white p-6 rounded-2xl shadow-lg\">\n                                <div className=\"flex justify-between items-center mb-6\">\n                                    <h3 className=\"text-sm font-bold text-slate-300 uppercase tracking-wider flex items-center gap-2\">\n                                        <Package size={16} /> Existencias F√≠sicas (Lotes)\n                                    </h3>\n                                    <button\n                                        onClick={handleAddBatch}\n                                        className=\"px-3 py-1 bg-cyan-500 hover:bg-cyan-400 text-white text-xs font-bold rounded-lg transition flex items-center gap-1\"\n                                    >\n                                        <Plus size={14} /> Nuevo Lote\n                                    </button>\n                                </div>\n\n                                <div className=\"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar\">\n                                    {activeBatches.map(batch => (\n                                        <div key={batch.id} className=\"bg-slate-700/50 p-4 rounded-xl border border-slate-600 hover:border-slate-500 transition-colors\">\n                                            <div className=\"flex justify-between items-start mb-3\">\n                                                <div className=\"flex-1\">\n                                                    <label className=\"text-[10px] font-bold text-slate-400 uppercase\">N¬∞ Lote</label>\n                                                    <input\n                                                        type=\"text\"\n                                                        value={batch.id} // Usually Batch Number is separate, but using ID for now\n                                                        readOnly // ID shouldn't change, maybe add a separate \"batch_number\" field later\n                                                        className=\"bg-transparent text-white font-mono font-bold text-sm w-full focus:outline-none\"\n                                                    />\n                                                </div>\n                                                <button\n                                                    onClick={() => handleMermarBatch(batch.id)}\n                                                    className=\"text-red-400 hover:text-red-300 p-1 hover:bg-red-400/10 rounded\"\n                                                    title=\"Dar de baja / Mermar\"\n                                                >\n                                                    <Trash2 size={16} />\n                                                </button>\n                                            </div>\n\n                                            <div className=\"grid grid-cols-2 gap-3\">\n                                                <div>\n                                                    <label className=\"text-[10px] font-bold text-slate-400 uppercase flex items-center gap-1\">\n                                                        <Calendar size={10} /> Vencimiento\n                                                    </label>\n                                                    <input\n                                                        type=\"date\"\n                                                        value={new Date(batch.expiry_date).toISOString().split('T')[0]}\n                                                        onChange={(e) => handleBatchUpdate(batch.id, 'expiry_date', new Date(e.target.value).getTime())}\n                                                        className=\"bg-slate-800 border border-slate-600 rounded-lg px-2 py-1 text-xs text-white w-full mt-1 focus:border-cyan-500 outline-none\"\n                                                    />\n                                                </div>\n                                                <div>\n                                                    <label className=\"text-[10px] font-bold text-slate-400 uppercase flex items-center gap-1\">\n                                                        <Package size={10} /> Stock\n                                                    </label>\n                                                    <input\n                                                        type=\"number\"\n                                                        value={batch.stock_actual}\n                                                        onChange={(e) => handleBatchUpdate(batch.id, 'stock_actual', parseInt(e.target.value))}\n                                                        className=\"bg-slate-800 border border-slate-600 rounded-lg px-2 py-1 text-xs text-white w-full mt-1 focus:border-cyan-500 outline-none font-bold text-center\"\n                                                    />\n                                                </div>\n                                                <div className=\"col-span-2\">\n                                                    <label className=\"text-[10px] font-bold text-slate-400 uppercase\">Ubicaci√≥n</label>\n                                                    <input\n                                                        type=\"text\"\n                                                        value={batch.aisle || ''}\n                                                        onChange={(e) => handleBatchUpdate(batch.id, 'aisle', e.target.value)}\n                                                        placeholder=\"Ej: Estante A1\"\n                                                        className=\"bg-slate-800 border border-slate-600 rounded-lg px-2 py-1 text-xs text-white w-full mt-1 focus:border-cyan-500 outline-none\"\n                                                    />\n                                                </div>\n                                            </div>\n                                        </div>\n                                    ))}\n                                    {activeBatches.length === 0 && (\n                                        <div className=\"text-center py-8 text-slate-500 text-sm\">\n                                            No hay lotes activos.\n                                        </div>\n                                    )}\n                                </div>\n                            </section>\n\n                            {/* Tags */}\n                            <section className=\"bg-white p-6 rounded-2xl shadow-sm border border-slate-100\">\n                                <h3 className=\"text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2\">\n                                    <Activity size={16} /> Etiquetas Terap√©uticas\n                                </h3>\n                                <div className=\"flex flex-wrap gap-2 mb-3\">\n                                    {formData.therapeutic_tags?.map(tag => (\n                                        <span key={tag} className=\"px-3 py-1 bg-cyan-50 text-cyan-700 rounded-full text-xs font-bold flex items-center gap-1\">\n                                            {tag}\n                                            <button onClick={() => removeTag(tag)} className=\"hover:text-cyan-900\"><X size={12} /></button>\n                                        </span>\n                                    ))}\n                                </div>\n                                <input\n                                    type=\"text\"\n                                    className=\"w-full p-3 border border-slate-200 rounded-xl text-sm\"\n                                    placeholder=\"Escribe y presiona Enter...\"\n                                    value={newTag}\n                                    onChange={e => setNewTag(e.target.value)}\n                                    onKeyDown={handleAddTag}\n                                />\n                            </section>\n\n                            <section className=\"bg-red-50 p-6 rounded-2xl border border-red-100\">\n                                <h3 className=\"text-sm font-bold text-red-400 uppercase tracking-wider mb-4 flex items-center gap-2\">\n                                    <AlertTriangle size={16} /> Contraindicaciones\n                                </h3>\n                                <div className=\"space-y-2\">\n                                    {['EMBARAZO', 'LACTANCIA', 'HIPERTENSION', 'DIABETES', 'ULCERA'].map(ci => (\n                                        <label key={ci} className=\"flex items-center gap-2 cursor-pointer hover:bg-red-100/50 p-2 rounded-lg transition\">\n                                            <input\n                                                type=\"checkbox\"\n                                                className=\"w-4 h-4 text-red-500 rounded focus:ring-red-400\"\n                                                checked={formData.contraindications?.includes(ci)}\n                                                onChange={() => toggleContraindication(ci)}\n                                            />\n                                            <span className=\"text-sm font-bold text-red-800\">{ci}</span>\n                                        </label>\n                                    ))}\n                                </div>\n                            </section>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default InventoryEditModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7845, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/bi/TimeFilter.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Calendar, ChevronDown } from 'lucide-react';\n\nexport interface DateRange {\n    from: Date;\n    to: Date;\n}\n\ninterface TimeFilterProps {\n    onFilterChange: (range: DateRange) => void;\n    initialRange?: DateRange;\n}\n\nconst TimeFilter: React.FC<TimeFilterProps> = ({ onFilterChange, initialRange }) => {\n    const [fromDate, setFromDate] = useState<string>(\n        initialRange?.from.toISOString().split('T')[0] ||\n        new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]\n    );\n    const [toDate, setToDate] = useState<string>(\n        initialRange?.to.toISOString().split('T')[0] ||\n        new Date().toISOString().split('T')[0]\n    );\n    const [showPresets, setShowPresets] = useState(false);\n\n    const presets = [\n        { label: '√öltimos 7 d√≠as', days: 7 },\n        { label: '√öltimos 30 d√≠as', days: 30 },\n        { label: 'Este mes', days: 'current_month' as const },\n        { label: 'Mes anterior', days: 'last_month' as const },\n        { label: 'Este trimestre', days: 'current_quarter' as const },\n        { label: 'Este a√±o', days: 'current_year' as const },\n    ];\n\n    const applyPreset = (preset: typeof presets[0]) => {\n        const today = new Date();\n        let from: Date;\n        let to: Date = today;\n\n        if (typeof preset.days === 'number') {\n            from = new Date(today.getTime() - preset.days * 24 * 60 * 60 * 1000);\n        } else {\n            switch (preset.days) {\n                case 'current_month':\n                    from = new Date(today.getFullYear(), today.getMonth(), 1);\n                    break;\n                case 'last_month':\n                    from = new Date(today.getFullYear(), today.getMonth() - 1, 1);\n                    to = new Date(today.getFullYear(), today.getMonth(), 0);\n                    break;\n                case 'current_quarter':\n                    const quarter = Math.floor(today.getMonth() / 3);\n                    from = new Date(today.getFullYear(), quarter * 3, 1);\n                    break;\n                case 'current_year':\n                    from = new Date(today.getFullYear(), 0, 1);\n                    break;\n                default:\n                    from = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);\n            }\n        }\n\n        setFromDate(from.toISOString().split('T')[0]);\n        setToDate(to.toISOString().split('T')[0]);\n        setShowPresets(false);\n    };\n\n    const handleApply = () => {\n        onFilterChange({\n            from: new Date(fromDate),\n            to: new Date(toDate + 'T23:59:59')\n        });\n    };\n\n    return (\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-4\">\n            <div className=\"flex flex-wrap items-end gap-4\">\n                {/* Date Range */}\n                <div className=\"flex-1 min-w-[200px]\">\n                    <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                        Desde\n                    </label>\n                    <div className=\"relative\">\n                        <Calendar className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                        <input\n                            type=\"date\"\n                            value={fromDate}\n                            onChange={(e) => setFromDate(e.target.value)}\n                            className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        />\n                    </div>\n                </div>\n\n                <div className=\"flex-1 min-w-[200px]\">\n                    <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                        Hasta\n                    </label>\n                    <div className=\"relative\">\n                        <Calendar className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                        <input\n                            type=\"date\"\n                            value={toDate}\n                            onChange={(e) => setToDate(e.target.value)}\n                            className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        />\n                    </div>\n                </div>\n\n                {/* Presets Dropdown */}\n                <div className=\"relative\">\n                    <button\n                        onClick={() => setShowPresets(!showPresets)}\n                        className=\"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center gap-2 font-medium text-sm border border-gray-300\"\n                    >\n                        Presets\n                        <ChevronDown className=\"w-4 h-4\" />\n                    </button>\n                    {showPresets && (\n                        <div className=\"absolute top-full mt-2 right-0 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[180px]\">\n                            {presets.map((preset, idx) => (\n                                <button\n                                    key={idx}\n                                    onClick={() => applyPreset(preset)}\n                                    className=\"w-full text-left px-4 py-2 hover:bg-gray-50 text-sm text-gray-700 first:rounded-t-lg last:rounded-b-lg\"\n                                >\n                                    {preset.label}\n                                </button>\n                            ))}\n                        </div>\n                    )}\n                </div>\n\n                {/* Apply Button */}\n                <button\n                    onClick={handleApply}\n                    className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold text-sm shadow-lg shadow-blue-200\"\n                >\n                    Aplicar Filtros\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default TimeFilter;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8091, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/warehouse/UnifiedReception.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { X, CheckCircle, AlertTriangle, Package, Camera, FileText } from 'lucide-react';\nimport { Shipment } from '../../../domain/types';\nimport { usePharmaStore } from '../../store/useStore';\nimport { toast } from 'sonner';\n\ninterface UnifiedReceptionProps {\n    isOpen: boolean;\n    onClose: () => void;\n    shipment: Shipment;\n}\n\nconst UnifiedReception: React.FC<UnifiedReceptionProps> = ({ isOpen, onClose, shipment }) => {\n    const { confirmReception } = usePharmaStore();\n    const [receivedItems, setReceivedItems] = useState<{ batchId: string; quantity: number; condition: 'GOOD' | 'DAMAGED' }[]>([]);\n    const [notes, setNotes] = useState('');\n    const [photos, setPhotos] = useState<string[]>([]);\n\n    useEffect(() => {\n        if (shipment) {\n            setReceivedItems(shipment.items.map(i => ({\n                batchId: i.batchId,\n                quantity: i.quantity, // Default to expected quantity\n                condition: 'GOOD'\n            })));\n        }\n    }, [shipment]);\n\n    if (!isOpen) return null;\n\n    const handleQuantityChange = (batchId: string, qty: number) => {\n        setReceivedItems(items => items.map(i =>\n            i.batchId === batchId ? { ...i, quantity: Math.max(0, qty) } : i\n        ));\n    };\n\n    const handleConditionChange = (batchId: string, condition: 'GOOD' | 'DAMAGED') => {\n        setReceivedItems(items => items.map(i =>\n            i.batchId === batchId ? { ...i, condition } : i\n        ));\n    };\n\n    const handlePhotoUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            const url = URL.createObjectURL(file);\n            setPhotos([...photos, url]);\n        }\n    };\n\n    const handleSubmit = () => {\n        // Check for discrepancies\n        const hasDiscrepancies = receivedItems.some(rec => {\n            const original = shipment.items.find(i => i.batchId === rec.batchId);\n            return original && (rec.quantity !== original.quantity || rec.condition === 'DAMAGED');\n        });\n\n        if (hasDiscrepancies && !notes) {\n            toast.error('Debes agregar una observaci√≥n si hay discrepancias');\n            return;\n        }\n\n        confirmReception(shipment.id, {\n            photos,\n            notes,\n            receivedItems\n        });\n\n        toast.success(hasDiscrepancies ? 'Recepci√≥n con observaciones registrada' : 'Recepci√≥n exitosa');\n        onClose();\n    };\n\n    const totalExpected = shipment.items.reduce((a, b) => a + b.quantity, 0);\n    const totalReceived = receivedItems.reduce((a, b) => a + b.quantity, 0);\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col\">\n                {/* Header */}\n                <div className=\"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-2xl\">\n                    <div>\n                        <h2 className=\"text-xl font-bold text-gray-800 flex items-center gap-2\">\n                            <CheckCircle className=\"text-emerald-600\" />\n                            Recepci√≥n de Carga\n                        </h2>\n                        <p className=\"text-sm text-gray-500\">\n                            {shipment.type === 'INBOUND_PROVIDER' ? 'Proveedor' : 'Transferencia Interna'} ‚Ä¢ OT: {shipment.transport_data.tracking_number}\n                        </p>\n                    </div>\n                    <button onClick={onClose} className=\"p-2 hover:bg-gray-200 rounded-full transition-colors\">\n                        <X size={20} className=\"text-gray-500\" />\n                    </button>\n                </div>\n\n                {/* Content */}\n                <div className=\"flex-1 overflow-y-auto p-6 space-y-6\">\n                    {/* Summary Card */}\n                    <div className=\"bg-blue-50 border border-blue-100 rounded-xl p-4 flex justify-between items-center\">\n                        <div className=\"flex gap-8\">\n                            <div>\n                                <p className=\"text-xs font-bold text-blue-400 uppercase\">Origen</p>\n                                <p className=\"font-bold text-blue-900\">{shipment.origin_location_id}</p>\n                            </div>\n                            <div>\n                                <p className=\"text-xs font-bold text-blue-400 uppercase\">Bultos</p>\n                                <p className=\"font-bold text-blue-900\">{shipment.transport_data.package_count}</p>\n                            </div>\n                        </div>\n                        <div className=\"text-right\">\n                            <p className=\"text-xs font-bold text-blue-400 uppercase\">Progreso</p>\n                            <p className={`text-2xl font-extrabold ${totalReceived !== totalExpected ? 'text-amber-500' : 'text-emerald-600'}`}>\n                                {totalReceived} / {totalExpected}\n                            </p>\n                        </div>\n                    </div>\n\n                    {/* Items Table */}\n                    <div className=\"border border-gray-200 rounded-xl overflow-hidden\">\n                        <table className=\"w-full\">\n                            <thead className=\"bg-gray-50 text-xs uppercase text-gray-500 font-bold\">\n                                <tr>\n                                    <th className=\"px-6 py-4 text-left\">Producto</th>\n                                    <th className=\"px-6 py-4 text-center\">Esperado</th>\n                                    <th className=\"px-6 py-4 text-center\">Recibido</th>\n                                    <th className=\"px-6 py-4 text-center\">Estado</th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"divide-y divide-gray-100\">\n                                {shipment.items.map(item => {\n                                    const received = receivedItems.find(r => r.batchId === item.batchId);\n                                    if (!received) return null;\n\n                                    return (\n                                        <tr key={item.batchId} className={received.quantity !== item.quantity ? 'bg-amber-50/30' : ''}>\n                                            <td className=\"px-6 py-4\">\n                                                <p className=\"font-bold text-gray-800\">{item.name}</p>\n                                                <p className=\"text-xs text-gray-500 font-mono\">{item.sku}</p>\n                                            </td>\n                                            <td className=\"px-6 py-4 text-center font-medium text-gray-600\">\n                                                {item.quantity}\n                                            </td>\n                                            <td className=\"px-6 py-4 text-center\">\n                                                <input\n                                                    type=\"number\"\n                                                    value={received.quantity}\n                                                    onChange={(e) => handleQuantityChange(item.batchId, parseInt(e.target.value) || 0)}\n                                                    className={`w-20 text-center font-bold border rounded-lg py-1 focus:ring-2 outline-none ${received.quantity !== item.quantity\n                                                            ? 'border-amber-300 text-amber-700 focus:ring-amber-200'\n                                                            : 'border-gray-200 text-gray-800 focus:ring-blue-200'\n                                                        }`}\n                                                />\n                                            </td>\n                                            <td className=\"px-6 py-4 text-center\">\n                                                <select\n                                                    value={received.condition}\n                                                    onChange={(e) => handleConditionChange(item.batchId, e.target.value as any)}\n                                                    className={`px-3 py-1 rounded-lg text-sm font-bold border outline-none ${received.condition === 'GOOD'\n                                                            ? 'bg-emerald-50 text-emerald-700 border-emerald-200'\n                                                            : 'bg-red-50 text-red-700 border-red-200'\n                                                        }`}\n                                                >\n                                                    <option value=\"GOOD\">OK</option>\n                                                    <option value=\"DAMAGED\">DA√ëADO</option>\n                                                </select>\n                                            </td>\n                                        </tr>\n                                    );\n                                })}\n                            </tbody>\n                        </table>\n                    </div>\n\n                    {/* Evidence & Notes */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        <div>\n                            <label className=\"block text-sm font-bold text-gray-700 mb-2\">Evidencia Fotogr√°fica</label>\n                            <div className=\"flex gap-2 overflow-x-auto pb-2\">\n                                <label className=\"flex-shrink-0 w-24 h-24 border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-blue-400 hover:text-blue-500 cursor-pointer transition-colors bg-gray-50\">\n                                    <Camera size={24} className=\"mb-1\" />\n                                    <span className=\"text-[10px] font-bold uppercase\">Agregar</span>\n                                    <input type=\"file\" className=\"hidden\" accept=\"image/*\" onChange={handlePhotoUpload} />\n                                </label>\n                                {photos.map((url, idx) => (\n                                    <div key={idx} className=\"flex-shrink-0 w-24 h-24 rounded-xl border border-gray-200 overflow-hidden relative group\">\n                                        <img src={url} alt=\"Evidence\" className=\"w-full h-full object-cover\" />\n                                        <button\n                                            onClick={() => setPhotos(photos.filter((_, i) => i !== idx))}\n                                            className=\"absolute top-1 right-1 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity\"\n                                        >\n                                            <X size={12} />\n                                        </button>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-bold text-gray-700 mb-2\">Observaciones</label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                placeholder=\"Detalle cualquier anomal√≠a o discrepancia...\"\n                                className=\"w-full h-24 px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 outline-none resize-none text-sm\"\n                            />\n                        </div>\n                    </div>\n                </div>\n\n                {/* Footer */}\n                <div className=\"p-6 border-t border-gray-100 bg-white rounded-b-2xl flex justify-end gap-4\">\n                    <button\n                        onClick={onClose}\n                        className=\"px-6 py-3 font-bold text-gray-500 hover:bg-gray-100 rounded-xl transition-colors\"\n                    >\n                        Cancelar\n                    </button>\n                    <button\n                        onClick={handleSubmit}\n                        className=\"px-8 py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 shadow-lg shadow-emerald-200 transition-all flex items-center gap-2\"\n                    >\n                        <CheckCircle size={18} />\n                        Confirmar Recepci√≥n\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default UnifiedReception;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8702, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/warehouse/DispatchWizard.tsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport { X, Truck, MapPin, Package, CheckCircle, ArrowRight, Search, AlertTriangle, Barcode } from 'lucide-react';\nimport { usePharmaStore } from '../../store/useStore';\nimport { useLocationStore } from '../../store/useLocationStore';\nimport { useBarcodeScanner } from '../../hooks/useBarcodeScanner';\nimport { toast } from 'sonner';\nimport { Shipment } from '../../../domain/types';\n\ninterface DispatchWizardProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst DispatchWizard: React.FC<DispatchWizardProps> = ({ isOpen, onClose }) => {\n    const { inventory, createDispatch, user } = usePharmaStore();\n    const { currentLocation } = useLocationStore();\n    const [step, setStep] = useState(1);\n\n    // Step 1: Route\n    const [originId, setOriginId] = useState(currentLocation?.id || 'BODEGA_CENTRAL');\n    const [destinationId, setDestinationId] = useState('');\n\n    // Step 2: Picking\n    const [searchTerm, setSearchTerm] = useState('');\n    const [selectedItems, setSelectedItems] = useState<{ batchId: string; sku: string; name: string; quantity: number; max: number }[]>([]);\n\n    // Step 3: Transport\n    const [transportData, setTransportData] = useState({\n        carrier: 'STARKEN',\n        tracking_number: '',\n        driver_name: '',\n        package_count: 1\n    });\n\n    // Scanner\n    const scannerInputRef = React.useRef<HTMLInputElement>(null);\n\n    const handleScan = (code: string) => {\n        // Find product in origin inventory\n        // Try exact match on SKU or Barcode (assuming we add barcode later to inventory item)\n        // For now, we match SKU or Name (partial) if code is long enough, but usually scanner sends exact SKU/EAN\n\n        // In this mock, let's assume the code IS the SKU or part of the name\n        const foundItem = originInventory.find(i => i.sku === code || i.id === code);\n\n        if (foundItem) {\n            // Check if already in selected items\n            const existing = selectedItems.find(i => i.batchId === foundItem.id);\n\n            if (existing) {\n                if (existing.quantity < existing.max) {\n                    handleUpdateQuantity(existing.batchId, existing.quantity + 1);\n                    toast.success(`+1 ${foundItem.name}`);\n                    // Play beep sound (simulated)\n                } else {\n                    toast.error('Stock insuficiente para agregar m√°s');\n                }\n            } else {\n                handleAddItem(foundItem);\n                toast.success(`Agregado: ${foundItem.name}`);\n            }\n        } else {\n            toast.error(`Producto no encontrado: ${code}`);\n        }\n    };\n\n    useBarcodeScanner({\n        onScan: handleScan,\n        minLength: 3,\n        targetInputRef: scannerInputRef\n    });\n\n\n\n    // Filter Inventory for Origin\n    const originInventory = useMemo(() => {\n        return inventory.filter(item => item.location_id === originId && item.stock_actual > 0);\n    }, [inventory, originId]);\n\n    const filteredProducts = useMemo(() => {\n        if (!searchTerm) return [];\n        return originInventory.filter(item =>\n            item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n            item.sku.includes(searchTerm)\n        ).slice(0, 5);\n    }, [originInventory, searchTerm]);\n\n    const handleAddItem = (item: any) => {\n        if (selectedItems.find(i => i.batchId === item.id)) return;\n        setSelectedItems([...selectedItems, {\n            batchId: item.id,\n            sku: item.sku,\n            name: item.name,\n            quantity: 1,\n            max: item.stock_actual\n        }]);\n        setSearchTerm('');\n    };\n\n    const handleUpdateQuantity = (batchId: string, qty: number) => {\n        setSelectedItems(items => items.map(i => {\n            if (i.batchId === batchId) {\n                return { ...i, quantity: Math.min(Math.max(1, qty), i.max) };\n            }\n            return i;\n        }));\n    };\n\n    const handleRemoveItem = (batchId: string) => {\n        setSelectedItems(items => items.filter(i => i.batchId !== batchId));\n    };\n\n    const handleSubmit = () => {\n        if (!destinationId) {\n            toast.error('Selecciona un destino');\n            return;\n        }\n        if (selectedItems.length === 0) {\n            toast.error('Agrega al menos un producto');\n            return;\n        }\n        if (!transportData.tracking_number) {\n            toast.error('Ingresa el n√∫mero de seguimiento (OT)');\n            return;\n        }\n\n        const shipmentData: Omit<Shipment, 'id' | 'status' | 'created_at' | 'updated_at'> = {\n            type: 'INTERNAL_TRANSFER',\n            origin_location_id: originId,\n            destination_location_id: destinationId,\n            transport_data: transportData,\n            documentation: { evidence_photos: [] },\n            items: selectedItems.map(i => ({\n                batchId: i.batchId,\n                sku: i.sku,\n                name: i.name,\n                quantity: i.quantity,\n                condition: 'GOOD'\n            })),\n            valuation: selectedItems.reduce((sum, i) => {\n                const item = originInventory.find(inv => inv.id === i.batchId);\n                return sum + (item?.cost_price || 0) * i.quantity;\n            }, 0)\n        };\n\n        createDispatch(shipmentData);\n        toast.success('Despacho creado exitosamente');\n\n        // Generate PDF (Mock)\n        import('jspdf').then(async ({ default: jsPDF }) => {\n            const doc = new jsPDF();\n            doc.text(`GU√çA DE DESPACHO INTERNA`, 105, 20, { align: 'center' });\n            doc.text(`OT: ${transportData.tracking_number}`, 20, 40);\n            doc.text(`Origen: ${originId}`, 20, 50);\n            doc.text(`Destino: ${destinationId}`, 20, 60);\n            doc.save(`guia-${transportData.tracking_number}.pdf`);\n        });\n\n        onClose();\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-4xl h-[80vh] flex flex-col\">\n                {/* Header */}\n                <div className=\"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-2xl\">\n                    <div>\n                        <h2 className=\"text-xl font-bold text-gray-800 flex items-center gap-2\">\n                            <Truck className=\"text-blue-600\" />\n                            Nuevo Despacho\n                        </h2>\n                        <p className=\"text-sm text-gray-500\">Asistente de creaci√≥n de env√≠os</p>\n                    </div>\n                    <button onClick={onClose} className=\"p-2 hover:bg-gray-200 rounded-full transition-colors\">\n                        <X size={20} className=\"text-gray-500\" />\n                    </button>\n                </div>\n\n                {/* Steps Indicator */}\n                <div className=\"flex justify-between px-12 py-4 border-b border-gray-100 bg-white\">\n                    {[\n                        { num: 1, label: 'Ruta', icon: MapPin },\n                        { num: 2, label: 'Picking', icon: Package },\n                        { num: 3, label: 'Transporte', icon: Truck },\n                        { num: 4, label: 'Confirmar', icon: CheckCircle }\n                    ].map((s) => (\n                        <div key={s.num} className={`flex flex-col items-center gap-2 ${step >= s.num ? 'text-blue-600' : 'text-gray-300'}`}>\n                            <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold transition-all ${step >= s.num ? 'bg-blue-100 ring-4 ring-blue-50' : 'bg-gray-100'\n                                }`}>\n                                <s.icon size={18} />\n                            </div>\n                            <span className=\"text-xs font-bold uppercase tracking-wider\">{s.label}</span>\n                        </div>\n                    ))}\n                </div>\n\n                {/* Content */}\n                <div className=\"flex-1 overflow-y-auto p-8 bg-gray-50/50\">\n                    {step === 1 && (\n                        <div className=\"max-w-xl mx-auto space-y-6\">\n                            <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-200\">\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">Origen</label>\n                                <select\n                                    value={originId}\n                                    onChange={(e) => setOriginId(e.target.value)}\n                                    disabled={user?.role !== 'MANAGER'}\n                                    className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 bg-gray-50 font-medium\"\n                                >\n                                    <option value=\"BODEGA_CENTRAL\">BODEGA_CENTRAL</option>\n                                    <option value=\"SUCURSAL_CENTRO\">SUCURSAL_CENTRO</option>\n                                    <option value=\"SUCURSAL_NORTE\">SUCURSAL_NORTE</option>\n                                </select>\n                            </div>\n\n                            <div className=\"flex justify-center\">\n                                <div className=\"bg-blue-100 p-2 rounded-full text-blue-600\">\n                                    <ArrowRight size={24} className=\"rotate-90\" />\n                                </div>\n                            </div>\n\n                            <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-200\">\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">Destino</label>\n                                <select\n                                    value={destinationId}\n                                    onChange={(e) => setDestinationId(e.target.value)}\n                                    className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 font-medium\"\n                                >\n                                    <option value=\"\">Seleccionar Sucursal...</option>\n                                    <option value=\"SUCURSAL_CENTRO\" disabled={originId === 'SUCURSAL_CENTRO'}>SUCURSAL_CENTRO</option>\n                                    <option value=\"SUCURSAL_NORTE\" disabled={originId === 'SUCURSAL_NORTE'}>SUCURSAL_NORTE</option>\n                                    <option value=\"BODEGA_CENTRAL\" disabled={originId === 'BODEGA_CENTRAL'}>BODEGA_CENTRAL</option>\n                                </select>\n                            </div>\n                        </div>\n                    )}\n\n                    {step === 2 && (\n                        <div className=\"space-y-6\">\n                            {/* Scanner Input */}\n                            <div className=\"bg-blue-50 p-6 rounded-2xl border-2 border-blue-100 shadow-sm text-center\">\n                                <label className=\"block text-sm font-bold text-blue-800 mb-2 uppercase tracking-wider flex items-center justify-center gap-2\">\n                                    <Barcode size={18} /> Escanear Producto\n                                </label>\n                                <div className=\"relative max-w-lg mx-auto\">\n                                    <input\n                                        ref={scannerInputRef}\n                                        type=\"text\"\n                                        placeholder=\"Escanea aqu√≠...\"\n                                        className=\"w-full px-6 py-4 rounded-xl border-2 border-blue-200 shadow-inner focus:ring-4 focus:ring-blue-100 focus:border-blue-500 text-2xl font-mono text-center outline-none transition-all\"\n                                        value={searchTerm}\n                                        onChange={(e) => setSearchTerm(e.target.value)}\n                                        autoFocus\n                                        onBlur={() => {\n                                            // Optional: Keep focus if we want \"always ready\" mode, \n                                            // but might be annoying if user wants to click elsewhere.\n                                            // setTimeout(() => scannerInputRef.current?.focus(), 100); \n                                        }}\n                                    />\n                                    <div className=\"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 animate-pulse\">\n                                        <Package size={24} />\n                                    </div>\n                                </div>\n                                <p className=\"text-xs text-blue-400 mt-2 font-medium\">\n                                    Presiona Enter o usa la pistola para agregar\n                                </p>\n                            </div>\n\n                            {/* Manual Search Results (Fallback) */}\n                            {filteredProducts.length > 0 && searchTerm.length > 2 && (\n                                <div className=\"bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden\">\n                                    <div className=\"bg-gray-50 px-4 py-2 text-xs font-bold text-gray-400 uppercase\">Resultados de B√∫squeda</div>\n                                    {filteredProducts.map(item => (\n                                        <button\n                                            key={item.id}\n                                            onClick={() => handleAddItem(item)}\n                                            className=\"w-full text-left px-6 py-3 hover:bg-blue-50 flex justify-between items-center border-b border-gray-50 last:border-0\"\n                                        >\n                                            <div>\n                                                <p className=\"font-bold text-gray-800\">{item.name}</p>\n                                                <p className=\"text-xs text-gray-500 font-mono\">{item.sku}</p>\n                                            </div>\n                                            <div className=\"text-right\">\n                                                <p className=\"text-sm font-bold text-blue-600\">{item.stock_actual} unid.</p>\n                                                <p className=\"text-xs text-gray-400\">{item.location_id}</p>\n                                            </div>\n                                        </button>\n                                    ))}\n                                </div>\n                            )}\n\n                            {/* Selected Items List */}\n                            <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden\">\n                                <div className=\"flex justify-between items-center p-4 bg-gray-50 border-b border-gray-100\">\n                                    <h3 className=\"font-bold text-gray-700 flex items-center gap-2\">\n                                        <CheckCircle size={18} className=\"text-green-500\" />\n                                        Items Seleccionados\n                                    </h3>\n                                    <div className=\"bg-blue-600 text-white px-3 py-1 rounded-lg text-xs font-bold\">\n                                        Total Unidades: {selectedItems.reduce((acc, item) => acc + item.quantity, 0)}\n                                    </div>\n                                </div>\n                                <table className=\"w-full\">\n                                    <thead className=\"bg-gray-50 text-xs uppercase text-gray-500 font-bold hidden\">\n                                        <tr>\n                                            <th className=\"px-6 py-4 text-left\">Producto</th>\n                                            <th className=\"px-6 py-4 text-center\">Cantidad</th>\n                                            <th className=\"px-6 py-4 text-right\">Acciones</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"divide-y divide-gray-100\">\n                                        {selectedItems.map(item => (\n                                            <tr key={item.batchId} className=\"group hover:bg-gray-50 transition-colors\">\n                                                <td className=\"px-6 py-4\">\n                                                    <p className=\"font-bold text-gray-800 text-lg\">{item.name}</p>\n                                                    <div className=\"flex gap-2 text-xs text-gray-500 font-mono mt-1\">\n                                                        <span className=\"bg-gray-100 px-2 py-0.5 rounded\">SKU: {item.sku}</span>\n                                                        <span className=\"bg-gray-100 px-2 py-0.5 rounded\">Lote: {item.batchId}</span>\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4\">\n                                                    <div className=\"flex items-center justify-center gap-3\">\n                                                        <button\n                                                            onClick={() => handleUpdateQuantity(item.batchId, item.quantity - 1)}\n                                                            className=\"w-10 h-10 rounded-xl bg-gray-100 hover:bg-gray-200 font-bold text-gray-600 flex items-center justify-center transition-colors\"\n                                                        >-</button>\n                                                        <input\n                                                            type=\"number\"\n                                                            value={item.quantity}\n                                                            onChange={(e) => handleUpdateQuantity(item.batchId, parseInt(e.target.value) || 1)}\n                                                            className=\"w-20 text-center font-bold text-xl border-b-2 border-blue-100 focus:border-blue-500 outline-none bg-transparent\"\n                                                        />\n                                                        <button\n                                                            onClick={() => handleUpdateQuantity(item.batchId, item.quantity + 1)}\n                                                            className=\"w-10 h-10 rounded-xl bg-gray-100 hover:bg-gray-200 font-bold text-gray-600 flex items-center justify-center transition-colors\"\n                                                        >+</button>\n                                                    </div>\n                                                    <p className=\"text-center text-xs text-gray-400 mt-1 font-medium\">\n                                                        Disponible: {item.max}\n                                                    </p>\n                                                </td>\n                                                <td className=\"px-6 py-4 text-right\">\n                                                    <button\n                                                        onClick={() => handleRemoveItem(item.batchId)}\n                                                        className=\"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                                                        title=\"Eliminar\"\n                                                    >\n                                                        <X size={20} />\n                                                    </button>\n                                                </td>\n                                            </tr>\n                                        ))}\n                                        {selectedItems.length === 0 && (\n                                            <tr>\n                                                <td colSpan={3} className=\"px-6 py-16 text-center text-gray-400\">\n                                                    <div className=\"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                                                        <Package className=\"w-10 h-10 text-gray-300\" />\n                                                    </div>\n                                                    <p className=\"font-medium\">Lista vac√≠a</p>\n                                                    <p className=\"text-sm opacity-60\">Escanea productos para comenzar</p>\n                                                </td>\n                                            </tr>\n                                        )}\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n                    )}\n\n                    {step === 3 && (\n                        <div className=\"max-w-xl mx-auto space-y-6\">\n                            <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-200 space-y-4\">\n                                <div>\n                                    <label className=\"block text-sm font-bold text-gray-700 mb-2\">Empresa de Transporte</label>\n                                    <select\n                                        value={transportData.carrier}\n                                        onChange={(e) => setTransportData({ ...transportData, carrier: e.target.value })}\n                                        className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 font-medium\"\n                                    >\n                                        <option value=\"STARKEN\">Starken</option>\n                                        <option value=\"CHILEXPRESS\">Chilexpress</option>\n                                        <option value=\"BLUE_EXPRESS\">Blue Express</option>\n                                        <option value=\"FLOTA_PROPIA\">Flota Propia</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-bold text-gray-700 mb-2\">N√∫mero de Seguimiento / OT</label>\n                                    <input\n                                        type=\"text\"\n                                        value={transportData.tracking_number}\n                                        onChange={(e) => setTransportData({ ...transportData, tracking_number: e.target.value })}\n                                        placeholder=\"Ej: 123456789\"\n                                        className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 font-medium\"\n                                    />\n                                </div>\n\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                    <div>\n                                        <label className=\"block text-sm font-bold text-gray-700 mb-2\">Conductor (Opcional)</label>\n                                        <input\n                                            type=\"text\"\n                                            value={transportData.driver_name}\n                                            onChange={(e) => setTransportData({ ...transportData, driver_name: e.target.value })}\n                                            placeholder=\"Nombre Chofer\"\n                                            className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 font-medium\"\n                                        />\n                                    </div>\n                                    <div>\n                                        <label className=\"block text-sm font-bold text-gray-700 mb-2\">Cantidad de Bultos</label>\n                                        <input\n                                            type=\"number\"\n                                            value={transportData.package_count}\n                                            onChange={(e) => setTransportData({ ...transportData, package_count: parseInt(e.target.value) || 1 })}\n                                            min={1}\n                                            className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 font-medium\"\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n\n                    {step === 4 && (\n                        <div className=\"max-w-2xl mx-auto space-y-6\">\n                            <div className=\"bg-emerald-50 border border-emerald-100 rounded-xl p-6 text-center\">\n                                <CheckCircle className=\"w-16 h-16 text-emerald-500 mx-auto mb-4\" />\n                                <h3 className=\"text-2xl font-bold text-emerald-900 mb-2\">Todo listo para despachar</h3>\n                                <p className=\"text-emerald-700\">Revisa los detalles antes de confirmar la operaci√≥n.</p>\n                            </div>\n\n                            <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 divide-y divide-gray-100\">\n                                <div className=\"p-6 grid grid-cols-2 gap-6\">\n                                    <div>\n                                        <p className=\"text-xs font-bold text-gray-400 uppercase mb-1\">Ruta</p>\n                                        <div className=\"flex items-center gap-2 font-bold text-gray-800\">\n                                            {originId} <ArrowRight size={14} className=\"text-gray-400\" /> {destinationId}\n                                        </div>\n                                    </div>\n                                    <div>\n                                        <p className=\"text-xs font-bold text-gray-400 uppercase mb-1\">Transporte</p>\n                                        <p className=\"font-bold text-gray-800\">{transportData.carrier} - OT: {transportData.tracking_number}</p>\n                                    </div>\n                                </div>\n                                <div className=\"p-6\">\n                                    <p className=\"text-xs font-bold text-gray-400 uppercase mb-4\">Resumen de Carga</p>\n                                    <div className=\"space-y-2\">\n                                        {selectedItems.map(item => (\n                                            <div key={item.batchId} className=\"flex justify-between text-sm\">\n                                                <span className=\"text-gray-600\">{item.name}</span>\n                                                <span className=\"font-bold text-gray-900\">x{item.quantity}</span>\n                                            </div>\n                                        ))}\n                                    </div>\n                                    <div className=\"mt-4 pt-4 border-t border-gray-100 flex justify-between items-center\">\n                                        <span className=\"font-bold text-gray-800\">Total Items</span>\n                                        <span className=\"text-xl font-bold text-blue-600\">{selectedItems.reduce((a, b) => a + b.quantity, 0)}</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                {/* Footer Actions */}\n                <div className=\"p-6 border-t border-gray-100 bg-white rounded-b-2xl flex justify-between\">\n                    <button\n                        onClick={() => setStep(s => Math.max(1, s - 1))}\n                        disabled={step === 1}\n                        className=\"px-6 py-3 font-bold text-gray-500 hover:bg-gray-100 rounded-xl transition-colors disabled:opacity-50\"\n                    >\n                        Atr√°s\n                    </button>\n\n                    {step < 4 ? (\n                        <button\n                            onClick={() => {\n                                if (step === 1 && !destinationId) return toast.error('Selecciona destino');\n                                if (step === 2 && selectedItems.length === 0) return toast.error('Agrega productos');\n                                setStep(s => s + 1);\n                            }}\n                            className=\"px-8 py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-200 transition-all flex items-center gap-2\"\n                        >\n                            Siguiente <ArrowRight size={18} />\n                        </button>\n                    ) : (\n                        <button\n                            onClick={handleSubmit}\n                            className=\"px-8 py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 shadow-lg shadow-emerald-200 transition-all flex items-center gap-2\"\n                        >\n                            <CheckCircle size={18} /> Confirmar Despacho\n                        </button>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default DispatchWizard;\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;AAQA,MAAM,iBAAgD,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE;;IACtE,MAAM,EAAE,SAAS,EAAE,cAAc,EAAE,IAAI,EAAE,GAAG,IAAA,6JAAc;IAC1D,MAAM,EAAE,eAAe,EAAE,GAAG,IAAA,uKAAgB;IAC5C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IAEjC,gBAAgB;IAChB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC,iBAAiB,MAAM;IAChE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IAEnD,kBAAkB;IAClB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAkF,EAAE;IAEtI,oBAAoB;IACpB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;QAC/C,SAAS;QACT,iBAAiB;QACjB,aAAa;QACb,eAAe;IACnB;IAEA,UAAU;IACV,MAAM,kBAAkB,wKAAK,CAAC,MAAM,CAAmB;IAEvD,MAAM,aAAa,CAAC;QAChB,mCAAmC;QACnC,sFAAsF;QACtF,0GAA0G;QAE1G,qEAAqE;QACrE,MAAM,YAAY,gBAAgB,IAAI,CAAC,CAAA,IAAK,EAAE,GAAG,KAAK,QAAQ,EAAE,EAAE,KAAK;QAEvE,IAAI,WAAW;YACX,qCAAqC;YACrC,MAAM,WAAW,cAAc,IAAI,CAAC,CAAA,IAAK,EAAE,OAAO,KAAK,UAAU,EAAE;YAEnE,IAAI,UAAU;gBACV,IAAI,SAAS,QAAQ,GAAG,SAAS,GAAG,EAAE;oBAClC,qBAAqB,SAAS,OAAO,EAAE,SAAS,QAAQ,GAAG;oBAC3D,oJAAK,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,UAAU,IAAI,EAAE;gBACpC,8BAA8B;gBAClC,OAAO;oBACH,oJAAK,CAAC,KAAK,CAAC;gBAChB;YACJ,OAAO;gBACH,cAAc;gBACd,oJAAK,CAAC,OAAO,CAAC,CAAC,UAAU,EAAE,UAAU,IAAI,EAAE;YAC/C;QACJ,OAAO;YACH,oJAAK,CAAC,KAAK,CAAC,CAAC,wBAAwB,EAAE,MAAM;QACjD;IACJ;IAEA,IAAA,yKAAiB,EAAC;QACd,QAAQ;QACR,WAAW;QACX,gBAAgB;IACpB;IAIA,8BAA8B;IAC9B,MAAM,kBAAkB,IAAA,wKAAO;mDAAC;YAC5B,OAAO,UAAU,MAAM;2DAAC,CAAA,OAAQ,KAAK,WAAW,KAAK,YAAY,KAAK,YAAY,GAAG;;QACzF;kDAAG;QAAC;QAAW;KAAS;IAExB,MAAM,mBAAmB,IAAA,wKAAO;oDAAC;YAC7B,IAAI,CAAC,YAAY,OAAO,EAAE;YAC1B,OAAO,gBAAgB,MAAM;4DAAC,CAAA,OAC1B,KAAK,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,WAAW,WAAW,OACvD,KAAK,GAAG,CAAC,QAAQ,CAAC;2DACpB,KAAK,CAAC,GAAG;QACf;mDAAG;QAAC;QAAiB;KAAW;IAEhC,MAAM,gBAAgB,CAAC;QACnB,IAAI,cAAc,IAAI,CAAC,CAAA,IAAK,EAAE,OAAO,KAAK,KAAK,EAAE,GAAG;QACpD,iBAAiB;eAAI;YAAe;gBAChC,SAAS,KAAK,EAAE;gBAChB,KAAK,KAAK,GAAG;gBACb,MAAM,KAAK,IAAI;gBACf,UAAU;gBACV,KAAK,KAAK,YAAY;YAC1B;SAAE;QACF,cAAc;IAClB;IAEA,MAAM,uBAAuB,CAAC,SAAiB;QAC3C,iBAAiB,CAAA,QAAS,MAAM,GAAG,CAAC,CAAA;gBAChC,IAAI,EAAE,OAAO,KAAK,SAAS;oBACvB,OAAO;wBAAE,GAAG,CAAC;wBAAE,UAAU,KAAK,GAAG,CAAC,KAAK,GAAG,CAAC,GAAG,MAAM,EAAE,GAAG;oBAAE;gBAC/D;gBACA,OAAO;YACX;IACJ;IAEA,MAAM,mBAAmB,CAAC;QACtB,iBAAiB,CAAA,QAAS,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,KAAK;IAC9D;IAEA,MAAM,eAAe;QACjB,IAAI,CAAC,eAAe;YAChB,oJAAK,CAAC,KAAK,CAAC;YACZ;QACJ;QACA,IAAI,cAAc,MAAM,KAAK,GAAG;YAC5B,oJAAK,CAAC,KAAK,CAAC;YACZ;QACJ;QACA,IAAI,CAAC,cAAc,eAAe,EAAE;YAChC,oJAAK,CAAC,KAAK,CAAC;YACZ;QACJ;QAEA,MAAM,eAA8E;YAChF,MAAM;YACN,oBAAoB;YACpB,yBAAyB;YACzB,gBAAgB;YAChB,eAAe;gBAAE,iBAAiB,EAAE;YAAC;YACrC,OAAO,cAAc,GAAG,CAAC,CAAA,IAAK,CAAC;oBAC3B,SAAS,EAAE,OAAO;oBAClB,KAAK,EAAE,GAAG;oBACV,MAAM,EAAE,IAAI;oBACZ,UAAU,EAAE,QAAQ;oBACpB,WAAW;gBACf,CAAC;YACD,WAAW,cAAc,MAAM,CAAC,CAAC,KAAK;gBAClC,MAAM,OAAO,gBAAgB,IAAI,CAAC,CAAA,MAAO,IAAI,EAAE,KAAK,EAAE,OAAO;gBAC7D,OAAO,MAAM,CAAC,MAAM,cAAc,CAAC,IAAI,EAAE,QAAQ;YACrD,GAAG;QACP;QAEA,eAAe;QACf,oJAAK,CAAC,OAAO,CAAC;QAEd,sBAAsB;QACtB,qHAAgB,IAAI,CAAC,OAAO,EAAE,SAAS,KAAK,EAAE;YAC1C,MAAM,MAAM,IAAI;YAChB,IAAI,IAAI,CAAC,CAAC,wBAAwB,CAAC,EAAE,KAAK,IAAI;gBAAE,OAAO;YAAS;YAChE,IAAI,IAAI,CAAC,CAAC,IAAI,EAAE,cAAc,eAAe,EAAE,EAAE,IAAI;YACrD,IAAI,IAAI,CAAC,CAAC,QAAQ,EAAE,UAAU,EAAE,IAAI;YACpC,IAAI,IAAI,CAAC,CAAC,SAAS,EAAE,eAAe,EAAE,IAAI;YAC1C,IAAI,IAAI,CAAC,CAAC,KAAK,EAAE,cAAc,eAAe,CAAC,IAAI,CAAC;QACxD;QAEA;IACJ;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BAEX,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;;8CACG,6LAAC;oCAAG,WAAU;;sDACV,6LAAC,gNAAK;4CAAC,WAAU;;;;;;wCAAkB;;;;;;;8CAGvC,6LAAC;oCAAE,WAAU;8CAAwB;;;;;;;;;;;;sCAEzC,6LAAC;4BAAO,SAAS;4BAAS,WAAU;sCAChC,cAAA,6LAAC,oMAAC;gCAAC,MAAM;gCAAI,WAAU;;;;;;;;;;;;;;;;;8BAK/B,6LAAC;oBAAI,WAAU;8BACV;wBACG;4BAAE,KAAK;4BAAG,OAAO;4BAAQ,MAAM,uNAAM;wBAAC;wBACtC;4BAAE,KAAK;4BAAG,OAAO;4BAAW,MAAM,sNAAO;wBAAC;wBAC1C;4BAAE,KAAK;4BAAG,OAAO;4BAAc,MAAM,gNAAK;wBAAC;wBAC3C;4BAAE,KAAK;4BAAG,OAAO;4BAAa,MAAM,6OAAW;wBAAC;qBACnD,CAAC,GAAG,CAAC,CAAC,kBACH,6LAAC;4BAAgB,WAAW,CAAC,iCAAiC,EAAE,QAAQ,EAAE,GAAG,GAAG,kBAAkB,iBAAiB;;8CAC/G,6LAAC;oCAAI,WAAW,CAAC,iFAAiF,EAAE,QAAQ,EAAE,GAAG,GAAG,oCAAoC,eAClJ;8CACF,cAAA,6LAAC,EAAE,IAAI;wCAAC,MAAM;;;;;;;;;;;8CAElB,6LAAC;oCAAK,WAAU;8CAA8C,EAAE,KAAK;;;;;;;2BAL/D,EAAE,GAAG;;;;;;;;;;8BAWvB,6LAAC;oBAAI,WAAU;;wBACV,SAAS,mBACN,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAM,WAAU;sDAA6C;;;;;;sDAC9D,6LAAC;4CACG,OAAO;4CACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;4CAC3C,UAAU,MAAM,SAAS;4CACzB,WAAU;;8DAEV,6LAAC;oDAAO,OAAM;8DAAiB;;;;;;8DAC/B,6LAAC;oDAAO,OAAM;8DAAkB;;;;;;8DAChC,6LAAC;oDAAO,OAAM;8DAAiB;;;;;;;;;;;;;;;;;;8CAIvC,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC;wCAAI,WAAU;kDACX,cAAA,6LAAC,mOAAU;4CAAC,MAAM;4CAAI,WAAU;;;;;;;;;;;;;;;;8CAIxC,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAM,WAAU;sDAA6C;;;;;;sDAC9D,6LAAC;4CACG,OAAO;4CACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;4CAChD,WAAU;;8DAEV,6LAAC;oDAAO,OAAM;8DAAG;;;;;;8DACjB,6LAAC;oDAAO,OAAM;oDAAkB,UAAU,aAAa;8DAAmB;;;;;;8DAC1E,6LAAC;oDAAO,OAAM;oDAAiB,UAAU,aAAa;8DAAkB;;;;;;8DACxE,6LAAC;oDAAO,OAAM;oDAAiB,UAAU,aAAa;8DAAkB;;;;;;;;;;;;;;;;;;;;;;;;wBAMvF,SAAS,mBACN,6LAAC;4BAAI,WAAU;;8CAEX,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAM,WAAU;;8DACb,6LAAC,sNAAO;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAEzB,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;oDACG,KAAK;oDACL,MAAK;oDACL,aAAY;oDACZ,WAAU;oDACV,OAAO;oDACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;oDAC7C,SAAS;oDACT,QAAQ;oDACJ,wDAAwD;oDACxD,0DAA0D;oDAC1D,4DAA4D;oDAChE;;;;;;8DAEJ,6LAAC;oDAAI,WAAU;8DACX,cAAA,6LAAC,sNAAO;wDAAC,MAAM;;;;;;;;;;;;;;;;;sDAGvB,6LAAC;4CAAE,WAAU;sDAAyC;;;;;;;;;;;;gCAMzD,iBAAiB,MAAM,GAAG,KAAK,WAAW,MAAM,GAAG,mBAChD,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAI,WAAU;sDAAiE;;;;;;wCAC/E,iBAAiB,GAAG,CAAC,CAAA,qBAClB,6LAAC;gDAEG,SAAS,IAAM,cAAc;gDAC7B,WAAU;;kEAEV,6LAAC;;0EACG,6LAAC;gEAAE,WAAU;0EAA2B,KAAK,IAAI;;;;;;0EACjD,6LAAC;gEAAE,WAAU;0EAAmC,KAAK,GAAG;;;;;;;;;;;;kEAE5D,6LAAC;wDAAI,WAAU;;0EACX,6LAAC;gEAAE,WAAU;;oEAAmC,KAAK,YAAY;oEAAC;;;;;;;0EAClE,6LAAC;gEAAE,WAAU;0EAAyB,KAAK,WAAW;;;;;;;;;;;;;+CAVrD,KAAK,EAAE;;;;;;;;;;;8CAkB5B,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;oDAAG,WAAU;;sEACV,6LAAC,6OAAW;4DAAC,MAAM;4DAAI,WAAU;;;;;;wDAAmB;;;;;;;8DAGxD,6LAAC;oDAAI,WAAU;;wDAAgE;wDAC1D,cAAc,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,EAAE;;;;;;;;;;;;;sDAGlF,6LAAC;4CAAM,WAAU;;8DACb,6LAAC;oDAAM,WAAU;8DACb,cAAA,6LAAC;;0EACG,6LAAC;gEAAG,WAAU;0EAAsB;;;;;;0EACpC,6LAAC;gEAAG,WAAU;0EAAwB;;;;;;0EACtC,6LAAC;gEAAG,WAAU;0EAAuB;;;;;;;;;;;;;;;;;8DAG7C,6LAAC;oDAAM,WAAU;;wDACZ,cAAc,GAAG,CAAC,CAAA,qBACf,6LAAC;gEAAsB,WAAU;;kFAC7B,6LAAC;wEAAG,WAAU;;0FACV,6LAAC;gFAAE,WAAU;0FAAmC,KAAK,IAAI;;;;;;0FACzD,6LAAC;gFAAI,WAAU;;kGACX,6LAAC;wFAAK,WAAU;;4FAAkC;4FAAM,KAAK,GAAG;;;;;;;kGAChE,6LAAC;wFAAK,WAAU;;4FAAkC;4FAAO,KAAK,OAAO;;;;;;;;;;;;;;;;;;;kFAG7E,6LAAC;wEAAG,WAAU;;0FACV,6LAAC;gFAAI,WAAU;;kGACX,6LAAC;wFACG,SAAS,IAAM,qBAAqB,KAAK,OAAO,EAAE,KAAK,QAAQ,GAAG;wFAClE,WAAU;kGACb;;;;;;kGACD,6LAAC;wFACG,MAAK;wFACL,OAAO,KAAK,QAAQ;wFACpB,UAAU,CAAC,IAAM,qBAAqB,KAAK,OAAO,EAAE,SAAS,EAAE,MAAM,CAAC,KAAK,KAAK;wFAChF,WAAU;;;;;;kGAEd,6LAAC;wFACG,SAAS,IAAM,qBAAqB,KAAK,OAAO,EAAE,KAAK,QAAQ,GAAG;wFAClE,WAAU;kGACb;;;;;;;;;;;;0FAEL,6LAAC;gFAAE,WAAU;;oFAAqD;oFACjD,KAAK,GAAG;;;;;;;;;;;;;kFAG7B,6LAAC;wEAAG,WAAU;kFACV,cAAA,6LAAC;4EACG,SAAS,IAAM,iBAAiB,KAAK,OAAO;4EAC5C,WAAU;4EACV,OAAM;sFAEN,cAAA,6LAAC,oMAAC;gFAAC,MAAM;;;;;;;;;;;;;;;;;+DAnCZ,KAAK,OAAO;;;;;wDAwCxB,cAAc,MAAM,KAAK,mBACtB,6LAAC;sEACG,cAAA,6LAAC;gEAAG,SAAS;gEAAG,WAAU;;kFACtB,6LAAC;wEAAI,WAAU;kFACX,cAAA,6LAAC,sNAAO;4EAAC,WAAU;;;;;;;;;;;kFAEvB,6LAAC;wEAAE,WAAU;kFAAc;;;;;;kFAC3B,6LAAC;wEAAE,WAAU;kFAAqB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;wBAUjE,SAAS,mBACN,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;;0DACG,6LAAC;gDAAM,WAAU;0DAA6C;;;;;;0DAC9D,6LAAC;gDACG,OAAO,cAAc,OAAO;gDAC5B,UAAU,CAAC,IAAM,iBAAiB;wDAAE,GAAG,aAAa;wDAAE,SAAS,EAAE,MAAM,CAAC,KAAK;oDAAC;gDAC9E,WAAU;;kEAEV,6LAAC;wDAAO,OAAM;kEAAU;;;;;;kEACxB,6LAAC;wDAAO,OAAM;kEAAc;;;;;;kEAC5B,6LAAC;wDAAO,OAAM;kEAAe;;;;;;kEAC7B,6LAAC;wDAAO,OAAM;kEAAe;;;;;;;;;;;;;;;;;;kDAIrC,6LAAC;;0DACG,6LAAC;gDAAM,WAAU;0DAA6C;;;;;;0DAC9D,6LAAC;gDACG,MAAK;gDACL,OAAO,cAAc,eAAe;gDACpC,UAAU,CAAC,IAAM,iBAAiB;wDAAE,GAAG,aAAa;wDAAE,iBAAiB,EAAE,MAAM,CAAC,KAAK;oDAAC;gDACtF,aAAY;gDACZ,WAAU;;;;;;;;;;;;kDAIlB,6LAAC;wCAAI,WAAU;;0DACX,6LAAC;;kEACG,6LAAC;wDAAM,WAAU;kEAA6C;;;;;;kEAC9D,6LAAC;wDACG,MAAK;wDACL,OAAO,cAAc,WAAW;wDAChC,UAAU,CAAC,IAAM,iBAAiB;gEAAE,GAAG,aAAa;gEAAE,aAAa,EAAE,MAAM,CAAC,KAAK;4DAAC;wDAClF,aAAY;wDACZ,WAAU;;;;;;;;;;;;0DAGlB,6LAAC;;kEACG,6LAAC;wDAAM,WAAU;kEAA6C;;;;;;kEAC9D,6LAAC;wDACG,MAAK;wDACL,OAAO,cAAc,aAAa;wDAClC,UAAU,CAAC,IAAM,iBAAiB;gEAAE,GAAG,aAAa;gEAAE,eAAe,SAAS,EAAE,MAAM,CAAC,KAAK,KAAK;4DAAE;wDACnG,KAAK;wDACL,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;wBAQjC,SAAS,mBACN,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAI,WAAU;;sDACX,6LAAC,6OAAW;4CAAC,WAAU;;;;;;sDACvB,6LAAC;4CAAG,WAAU;sDAA2C;;;;;;sDACzD,6LAAC;4CAAE,WAAU;sDAAmB;;;;;;;;;;;;8CAGpC,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;;sEACG,6LAAC;4DAAE,WAAU;sEAAiD;;;;;;sEAC9D,6LAAC;4DAAI,WAAU;;gEACV;gEAAS;8EAAC,6LAAC,mOAAU;oEAAC,MAAM;oEAAI,WAAU;;;;;;gEAAkB;gEAAE;;;;;;;;;;;;;8DAGvE,6LAAC;;sEACG,6LAAC;4DAAE,WAAU;sEAAiD;;;;;;sEAC9D,6LAAC;4DAAE,WAAU;;gEAA2B,cAAc,OAAO;gEAAC;gEAAQ,cAAc,eAAe;;;;;;;;;;;;;;;;;;;sDAG3G,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;oDAAE,WAAU;8DAAiD;;;;;;8DAC9D,6LAAC;oDAAI,WAAU;8DACV,cAAc,GAAG,CAAC,CAAA,qBACf,6LAAC;4DAAuB,WAAU;;8EAC9B,6LAAC;oEAAK,WAAU;8EAAiB,KAAK,IAAI;;;;;;8EAC1C,6LAAC;oEAAK,WAAU;;wEAA0B;wEAAE,KAAK,QAAQ;;;;;;;;2DAFnD,KAAK,OAAO;;;;;;;;;;8DAM9B,6LAAC;oDAAI,WAAU;;sEACX,6LAAC;4DAAK,WAAU;sEAA0B;;;;;;sEAC1C,6LAAC;4DAAK,WAAU;sEAAmC,cAAc,MAAM,CAAC,CAAC,GAAG,IAAM,IAAI,EAAE,QAAQ,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8BAS1H,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BACG,SAAS,IAAM,QAAQ,CAAA,IAAK,KAAK,GAAG,CAAC,GAAG,IAAI;4BAC5C,UAAU,SAAS;4BACnB,WAAU;sCACb;;;;;;wBAIA,OAAO,kBACJ,6LAAC;4BACG,SAAS;gCACL,IAAI,SAAS,KAAK,CAAC,eAAe,OAAO,oJAAK,CAAC,KAAK,CAAC;gCACrD,IAAI,SAAS,KAAK,cAAc,MAAM,KAAK,GAAG,OAAO,oJAAK,CAAC,KAAK,CAAC;gCACjE,QAAQ,CAAA,IAAK,IAAI;4BACrB;4BACA,WAAU;;gCACb;8CACa,6LAAC,mOAAU;oCAAC,MAAM;;;;;;;;;;;qFAGhC,6LAAC;4BACG,SAAS;4BACT,WAAU;;8CAEV,6LAAC,6OAAW;oCAAC,MAAM;;;;;;gCAAM;;;;;;;;;;;;;;;;;;;;;;;;AAOrD;GAreM;;QAC0C,6JAAc;QAC9B,uKAAgB;QAmD5C,yKAAiB;;;KArDf;uCAueS"}},
    {"offset": {"line": 10070, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/warehouse/DocumentViewerModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { X, FileText, Image as ImageIcon, Trash2, Upload, Eye, ExternalLink } from 'lucide-react';\nimport { Shipment } from '../../../domain/types';\nimport { usePharmaStore } from '../../store/useStore';\nimport { toast } from 'sonner';\n\ninterface DocumentViewerModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    shipment: Shipment;\n}\n\nconst DocumentViewerModal: React.FC<DocumentViewerModalProps> = ({ isOpen, onClose, shipment }) => {\n    const { uploadLogisticsDocument, user } = usePharmaStore();\n    const [uploadType, setUploadType] = useState<'INVOICE' | 'GUIDE' | 'PHOTO'>('PHOTO');\n    const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n\n    if (!isOpen) return null;\n\n    const isAdmin = user?.role === 'MANAGER' || user?.role === 'ADMIN';\n\n    const handleUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (!file) return;\n\n        // In a real app, we would upload to S3/Cloudinary here.\n        // For this demo, we create a local object URL.\n        const url = URL.createObjectURL(file);\n\n        uploadLogisticsDocument(shipment.id, uploadType, url);\n        toast.success('Documento adjuntado correctamente');\n    };\n\n    const handleDelete = (type: 'INVOICE' | 'GUIDE' | 'PHOTO', index?: number) => {\n        if (!isAdmin) {\n            toast.error('Solo administradores pueden eliminar documentos');\n            return;\n        }\n        // Note: The store action currently only supports \"adding/setting\". \n        // To support delete, we might need to update the store or just overwrite with undefined/empty array.\n        // For this demo, we'll just show a toast as the store update is complex for a quick fix.\n        toast.info('Funcionalidad de eliminar pendiente de implementaci√≥n en store');\n    };\n\n    const documents = [\n        { type: 'Factura', url: shipment.documentation.invoice_url, icon: FileText, key: 'INVOICE' },\n        { type: 'Gu√≠a de Despacho', url: shipment.documentation.dispatch_guide_url, icon: FileText, key: 'GUIDE' },\n        ...shipment.documentation.evidence_photos.map((url, idx) => ({\n            type: `Evidencia #${idx + 1}`,\n            url,\n            icon: ImageIcon,\n            key: 'PHOTO',\n            index: idx\n        }))\n    ].filter(doc => doc.url);\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col\">\n                {/* Header */}\n                <div className=\"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-2xl\">\n                    <div>\n                        <h2 className=\"text-xl font-bold text-gray-800\">Documentaci√≥n del Env√≠o</h2>\n                        <p className=\"text-sm text-gray-500 font-mono\">OT: {shipment.transport_data.tracking_number}</p>\n                    </div>\n                    <button onClick={onClose} className=\"p-2 hover:bg-gray-200 rounded-full transition-colors\">\n                        <X size={20} className=\"text-gray-500\" />\n                    </button>\n                </div>\n\n                {/* Content */}\n                <div className=\"flex-1 overflow-y-auto p-6\">\n                    {/* Document List */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8\">\n                        {documents.length > 0 ? (\n                            documents.map((doc, idx) => (\n                                <div key={idx} className=\"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all group relative bg-white\">\n                                    <div className=\"flex items-start justify-between mb-3\">\n                                        <div className=\"p-2 bg-blue-50 text-blue-600 rounded-lg\">\n                                            <doc.icon size={24} />\n                                        </div>\n                                        {isAdmin && (\n                                            <button\n                                                onClick={() => handleDelete(doc.key as any, doc.index)}\n                                                className=\"p-1.5 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                                            >\n                                                <Trash2 size={16} />\n                                            </button>\n                                        )}\n                                    </div>\n                                    <h3 className=\"font-bold text-gray-700 mb-1\">{doc.type}</h3>\n\n                                    <div className=\"flex gap-2 mt-4\">\n                                        <button\n                                            onClick={() => setPreviewUrl(doc.url!)}\n                                            className=\"flex-1 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-bold flex items-center justify-center gap-2 transition-colors\"\n                                        >\n                                            <Eye size={16} /> Ver\n                                        </button>\n                                        <a\n                                            href={doc.url}\n                                            target=\"_blank\"\n                                            rel=\"noopener noreferrer\"\n                                            className=\"p-2 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-lg transition-colors\"\n                                        >\n                                            <ExternalLink size={16} />\n                                        </a>\n                                    </div>\n                                </div>\n                            ))\n                        ) : (\n                            <div className=\"col-span-full text-center py-12 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200\">\n                                <FileText className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\n                                <p className=\"text-gray-500 font-medium\">No hay documentos adjuntos</p>\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Upload Section */}\n                    <div className=\"bg-blue-50 rounded-xl p-6 border border-blue-100\">\n                        <h3 className=\"font-bold text-blue-900 mb-4 flex items-center gap-2\">\n                            <Upload size={18} />\n                            Adjuntar Nuevo Documento\n                        </h3>\n                        <div className=\"flex flex-col sm:flex-row gap-4 items-end\">\n                            <div className=\"flex-1 w-full\">\n                                <label className=\"block text-xs font-bold text-blue-700 mb-1 uppercase\">Tipo de Documento</label>\n                                <select\n                                    value={uploadType}\n                                    onChange={(e) => setUploadType(e.target.value as any)}\n                                    className=\"w-full px-4 py-2 rounded-lg border border-blue-200 focus:ring-2 focus:ring-blue-500 outline-none text-sm font-medium\"\n                                >\n                                    <option value=\"PHOTO\">Evidencia Fotogr√°fica</option>\n                                    <option value=\"GUIDE\">Gu√≠a de Despacho</option>\n                                    <option value=\"INVOICE\">Factura</option>\n                                </select>\n                            </div>\n                            <div className=\"flex-1 w-full\">\n                                <label className=\"block w-full cursor-pointer\">\n                                    <input type=\"file\" className=\"hidden\" onChange={handleUpload} accept=\"image/*,.pdf\" />\n                                    <div className=\"w-full px-4 py-2 bg-white border border-blue-200 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors text-center text-sm font-bold flex items-center justify-center gap-2\">\n                                        <Upload size={16} />\n                                        Seleccionar Archivo\n                                    </div>\n                                </label>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Preview Overlay */}\n                {previewUrl && (\n                    <div className=\"fixed inset-0 z-[60] bg-black/90 flex items-center justify-center p-4\" onClick={() => setPreviewUrl(null)}>\n                        <button className=\"absolute top-4 right-4 text-white hover:text-gray-300\">\n                            <X size={32} />\n                        </button>\n                        <img src={previewUrl} alt=\"Preview\" className=\"max-w-full max-h-full rounded-lg shadow-2xl\" onClick={(e) => e.stopPropagation()} />\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default DocumentViewerModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10525, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/presentation/components/suppliers/AddSupplierModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { X, Building2, MapPin, Phone, Mail, CreditCard, Tag, Plus, Trash2 } from 'lucide-react';\nimport { Supplier, BankAccount } from '../../../domain/types';\nimport { toast } from 'sonner';\n\ninterface AddSupplierModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onSave: (supplier: Omit<Supplier, 'id'>) => void;\n}\n\nconst CHILEAN_BANKS = [\n    'Banco Estado',\n    'Banco de Chile',\n    'Banco Santander',\n    'Banco BCI',\n    'Banco Scotiabank',\n    'Banco Ita√∫',\n    'Banco Security',\n    'Banco Falabella',\n    'Banco Ripley',\n    'Banco Consorcio'\n];\n\nconst CHILEAN_REGIONS = [\n    'Regi√≥n de Arica y Parinacota',\n    'Regi√≥n de Tarapac√°',\n    'Regi√≥n de Antofagasta',\n    'Regi√≥n de Atacama',\n    'Regi√≥n de Coquimbo',\n    'Regi√≥n de Valpara√≠so',\n    'Regi√≥n Metropolitana',\n    'Regi√≥n del Libertador General Bernardo O\\'Higgins',\n    'Regi√≥n del Maule',\n    'Regi√≥n de √ëuble',\n    'Regi√≥n del Biob√≠o',\n    'Regi√≥n de La Araucan√≠a',\n    'Regi√≥n de Los R√≠os',\n    'Regi√≥n de Los Lagos',\n    'Regi√≥n de Ays√©n',\n    'Regi√≥n de Magallanes'\n];\n\nconst SECTORS = [\n    'Laboratorio Farmac√©utico',\n    'Distribuidora Mayorista',\n    'Insumos M√©dicos',\n    'Retail y Belleza',\n    'Servicios Log√≠sticos',\n    'Equipamiento M√©dico'\n];\n\nconst AddSupplierModal: React.FC<AddSupplierModalProps> = ({ isOpen, onClose, onSave }) => {\n    // Section 1: Company Data\n    const [rut, setRut] = useState('');\n    const [businessName, setBusinessName] = useState('');\n    const [fantasyName, setFantasyName] = useState('');\n    const [sector, setSector] = useState('');\n    const [website, setWebsite] = useState('');\n\n    // Section 2: Location & Contact\n    const [address, setAddress] = useState('');\n    const [region, setRegion] = useState('');\n    const [city, setCity] = useState('');\n    const [commune, setCommune] = useState('');\n    const [phone1, setPhone1] = useState('');\n    const [phone2, setPhone2] = useState('');\n    const [emailOrders, setEmailOrders] = useState('');\n    const [emailBilling, setEmailBilling] = useState('');\n    const [contactEmail, setContactEmail] = useState('');\n\n    // Section 3: Banking\n    const [bankName, setBankName] = useState('');\n    const [accountType, setAccountType] = useState<'VISTA' | 'CORRIENTE' | 'AHORRO'>('CORRIENTE');\n    const [accountNumber, setAccountNumber] = useState('');\n    const [rutHolder, setRutHolder] = useState('');\n\n    // Section 4: Brands & Portfolio\n    const [brandInput, setBrandInput] = useState('');\n    const [brands, setBrands] = useState<string[]>([]);\n\n    // Additional fields\n    const [paymentTerms, setPaymentTerms] = useState<'CONTADO' | '30_DIAS' | '60_DIAS' | '90_DIAS'>('30_DIAS');\n    const [leadTimeDays, setLeadTimeDays] = useState(7);\n\n    const handleAddBrand = () => {\n        const trimmed = brandInput.trim();\n        if (trimmed && !brands.includes(trimmed)) {\n            setBrands([...brands, trimmed]);\n            setBrandInput('');\n        }\n    };\n\n    const handleRemoveBrand = (brand: string) => {\n        setBrands(brands.filter(b => b !== brand));\n    };\n\n    const handleKeyDown = (e: React.KeyboardEvent) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n            e.preventDefault();\n            handleAddBrand();\n        }\n    };\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n\n        // Validation\n        if (!rut || !businessName || !fantasyName || !sector) {\n            toast.error('Por favor completa los campos obligatorios de Datos Empresa');\n            return;\n        }\n\n        if (!address || !region || !city || !emailOrders || !emailBilling || !phone1) {\n            toast.error('Por favor completa los campos obligatorios de Ubicaci√≥n & Contacto');\n            return;\n        }\n\n        const bankAccount: BankAccount | undefined = bankName && accountNumber ? {\n            bank: bankName,\n            account_type: accountType,\n            account_number: accountNumber,\n            email_notification: emailBilling,\n            rut_holder: rutHolder || rut\n        } : undefined;\n\n        const supplierData: Omit<Supplier, 'id'> = {\n            rut,\n            business_name: businessName,\n            fantasy_name: fantasyName,\n            website,\n            address,\n            region,\n            city,\n            commune,\n            phone_1: phone1,\n            phone_2: phone2,\n            contact_email: contactEmail || emailOrders,\n            email_orders: emailOrders,\n            email_billing: emailBilling,\n            contacts: [],\n            sector,\n            brands,\n            categories: [],\n            payment_terms: paymentTerms,\n            rating: 3,\n            lead_time_days: leadTimeDays,\n            bank_account: bankAccount\n        };\n\n        onSave(supplierData);\n        handleReset();\n        onClose();\n    };\n\n    const handleReset = () => {\n        setRut('');\n        setBusinessName('');\n        setFantasyName('');\n        setSector('');\n        setWebsite('');\n        setAddress('');\n        setRegion('');\n        setCity('');\n        setCommune('');\n        setPhone1('');\n        setPhone2('');\n        setEmailOrders('');\n        setEmailBilling('');\n        setContactEmail('');\n        setBankName('');\n        setAccountType('CORRIENTE');\n        setAccountNumber('');\n        setRutHolder('');\n        setBrands([]);\n        setBrandInput('');\n        setPaymentTerms('30_DIAS');\n        setLeadTimeDays(7);\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col\">\n                {/* Header */}\n                <div className=\"bg-gradient-to-r from-blue-600 to-cyan-600 px-6 py-4 flex justify-between items-center\">\n                    <div className=\"flex items-center gap-3\">\n                        <div className=\"bg-white/20 p-2 rounded-lg\">\n                            <Building2 className=\"w-6 h-6 text-white\" />\n                        </div>\n                        <div>\n                            <h2 className=\"text-xl font-bold text-white\">Nuevo Proveedor</h2>\n                            <p className=\"text-blue-100 text-sm\">Alta Maestra de Socio Comercial</p>\n                        </div>\n                    </div>\n                    <button\n                        onClick={onClose}\n                        className=\"text-white/80 hover:text-white transition-colors\"\n                    >\n                        <X className=\"w-6 h-6\" />\n                    </button>\n                </div>\n\n                {/* Form */}\n                <form onSubmit={handleSubmit} className=\"flex-1 overflow-y-auto p-6 space-y-6\">\n                    {/* Section 1: Company Data */}\n                    <div className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-6 border border-blue-200\">\n                        <h3 className=\"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2\">\n                            <Building2 className=\"w-5 h-5 text-blue-600\" />\n                            A. Datos de la Empresa\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    RUT <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={rut}\n                                    onChange={(e) => setRut(e.target.value)}\n                                    placeholder=\"12.345.678-9\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Raz√≥n Social <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={businessName}\n                                    onChange={(e) => setBusinessName(e.target.value)}\n                                    placeholder=\"Laboratorios Chile S.A.\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Nombre Fantas√≠a <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={fantasyName}\n                                    onChange={(e) => setFantasyName(e.target.value)}\n                                    placeholder=\"Lab Chile\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Rubro/Sector <span className=\"text-red-500\">*</span>\n                                </label>\n                                <select\n                                    value={sector}\n                                    onChange={(e) => setSector(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n                                    required\n                                >\n                                    <option value=\"\">Seleccionar...</option>\n                                    {SECTORS.map(s => (\n                                        <option key={s} value={s}>{s}</option>\n                                    ))}\n                                </select>\n                            </div>\n                            <div className=\"md:col-span-2\">\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Sitio Web\n                                </label>\n                                <input\n                                    type=\"url\"\n                                    value={website}\n                                    onChange={(e) => setWebsite(e.target.value)}\n                                    placeholder=\"https://www.ejemplo.cl\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n                                />\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Section 2: Location & Contact */}\n                    <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200\">\n                        <h3 className=\"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2\">\n                            <MapPin className=\"w-5 h-5 text-green-600\" />\n                            B. Ubicaci√≥n & Contacto\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            <div className=\"md:col-span-2\">\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Direcci√≥n <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={address}\n                                    onChange={(e) => setAddress(e.target.value)}\n                                    placeholder=\"Av. Libertador Bernardo O'Higgins 1234\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Regi√≥n <span className=\"text-red-500\">*</span>\n                                </label>\n                                <select\n                                    value={region}\n                                    onChange={(e) => setRegion(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\n                                    required\n                                >\n                                    <option value=\"\">Seleccionar...</option>\n                                    {CHILEAN_REGIONS.map(r => (\n                                        <option key={r} value={r}>{r}</option>\n                                    ))}\n                                </select>\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Ciudad <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={city}\n                                    onChange={(e) => setCity(e.target.value)}\n                                    placeholder=\"Santiago\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Comuna\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={commune}\n                                    onChange={(e) => setCommune(e.target.value)}\n                                    placeholder=\"Providencia\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Tel√©fono Principal <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                    type=\"tel\"\n                                    value={phone1}\n                                    onChange={(e) => setPhone1(e.target.value)}\n                                    placeholder=\"+56 2 2345 6789\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Tel√©fono Secundario\n                                </label>\n                                <input\n                                    type=\"tel\"\n                                    value={phone2}\n                                    onChange={(e) => setPhone2(e.target.value)}\n                                    placeholder=\"+56 9 8765 4321\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Email Pedidos/O.C. <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                    type=\"email\"\n                                    value={emailOrders}\n                                    onChange={(e) => setEmailOrders(e.target.value)}\n                                    placeholder=\"pedidos@proveedor.cl\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Email Facturaci√≥n/Cobranza <span className=\"text-red-500\">*</span>\n                                </label>\n                                <input\n                                    type=\"email\"\n                                    value={emailBilling}\n                                    onChange={(e) => setEmailBilling(e.target.value)}\n                                    placeholder=\"cobranza@proveedor.cl\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\n                                    required\n                                />\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Section 3: Banking */}\n                    <div className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200\">\n                        <h3 className=\"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2\">\n                            <CreditCard className=\"w-5 h-5 text-purple-600\" />\n                            C. Datos Bancarios (Para Transferencias)\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Banco\n                                </label>\n                                <select\n                                    value={bankName}\n                                    onChange={(e) => setBankName(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none\"\n                                >\n                                    <option value=\"\">Seleccionar...</option>\n                                    {CHILEAN_BANKS.map(bank => (\n                                        <option key={bank} value={bank}>{bank}</option>\n                                    ))}\n                                </select>\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Tipo de Cuenta\n                                </label>\n                                <select\n                                    value={accountType}\n                                    onChange={(e) => setAccountType(e.target.value as any)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none\"\n                                >\n                                    <option value=\"CORRIENTE\">Cuenta Corriente</option>\n                                    <option value=\"VISTA\">Cuenta Vista</option>\n                                    <option value=\"AHORRO\">Cuenta de Ahorro</option>\n                                </select>\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    N√∫mero de Cuenta\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={accountNumber}\n                                    onChange={(e) => setAccountNumber(e.target.value)}\n                                    placeholder=\"1234567890\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    RUT Titular (si difiere)\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={rutHolder}\n                                    onChange={(e) => setRutHolder(e.target.value)}\n                                    placeholder=\"11.111.111-1\"\n                                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none\"\n                                />\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Section 4: Brands & Portfolio */}\n                    <div className=\"bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-6 border border-orange-200\">\n                        <h3 className=\"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2\">\n                            <Tag className=\"w-5 h-5 text-orange-600\" />\n                            D. Marcas & Portafolio\n                        </h3>\n                        <div className=\"space-y-4\">\n                            <div>\n                                <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                    Agregar Marcas\n                                </label>\n                                <div className=\"flex gap-2\">\n                                    <input\n                                        type=\"text\"\n                                        value={brandInput}\n                                        onChange={(e) => setBrandInput(e.target.value)}\n                                        onKeyDown={handleKeyDown}\n                                        placeholder=\"Escribe una marca y presiona Enter o Espacio\"\n                                        className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 outline-none\"\n                                    />\n                                    <button\n                                        type=\"button\"\n                                        onClick={handleAddBrand}\n                                        className=\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 flex items-center gap-2\"\n                                    >\n                                        <Plus className=\"w-4 h-4\" />\n                                        Agregar\n                                    </button>\n                                </div>\n                                <p className=\"text-xs text-gray-500 mt-1\">\n                                    Presiona Enter o Espacio para agregar cada marca\n                                </p>\n                            </div>\n\n                            {/* Brands Chips */}\n                            {brands.length > 0 && (\n                                <div className=\"flex flex-wrap gap-2\">\n                                    {brands.map((brand, idx) => (\n                                        <div\n                                            key={idx}\n                                            className=\"bg-orange-100 text-orange-800 px-3 py-1.5 rounded-full flex items-center gap-2 text-sm font-medium\"\n                                        >\n                                            <Tag className=\"w-3 h-3\" />\n                                            {brand}\n                                            <button\n                                                type=\"button\"\n                                                onClick={() => handleRemoveBrand(brand)}\n                                                className=\"hover:text-orange-900\"\n                                            >\n                                                <Trash2 className=\"w-3 h-3\" />\n                                            </button>\n                                        </div>\n                                    ))}\n                                </div>\n                            )}\n\n                            {/* Commercial Terms */}\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-orange-200\">\n                                <div>\n                                    <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                        Condiciones de Pago\n                                    </label>\n                                    <select\n                                        value={paymentTerms}\n                                        onChange={(e) => setPaymentTerms(e.target.value as any)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 outline-none\"\n                                    >\n                                        <option value=\"CONTADO\">Contado</option>\n                                        <option value=\"30_DIAS\">30 D√≠as</option>\n                                        <option value=\"60_DIAS\">60 D√≠as</option>\n                                        <option value=\"90_DIAS\">90 D√≠as</option>\n                                    </select>\n                                </div>\n                                <div>\n                                    <label className=\"block text-sm font-bold text-gray-700 mb-2\">\n                                        Tiempo de Entrega (d√≠as)\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={leadTimeDays}\n                                        onChange={(e) => setLeadTimeDays(parseInt(e.target.value) || 0)}\n                                        min=\"1\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 outline-none\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </form>\n\n                {/* Footer */}\n                <div className=\"bg-gray-50 px-6 py-4 flex justify-between items-center border-t border-gray-200\">\n                    <p className=\"text-sm text-gray-600\">\n                        <span className=\"text-red-500\">*</span> Campos obligatorios\n                    </p>\n                    <div className=\"flex gap-3\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 font-medium\"\n                        >\n                            Cancelar\n                        </button>\n                        <button\n                            onClick={handleSubmit}\n                            className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold shadow-lg shadow-blue-200\"\n                        >\n                            Guardar Proveedor\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default AddSupplierModal;\n"],"names":[],"mappings":"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"}}]
}