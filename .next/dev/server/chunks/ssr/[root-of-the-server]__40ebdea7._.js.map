{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/components/supply/RestockingTable.tsx"],"sourcesContent":["'use client';\n\nimport { RestockingItem } from '@/lib/data/supply';\nimport { AlertTriangle, ShoppingCart } from 'lucide-react';\n\ninterface RestockingTableProps {\n    suggestions: RestockingItem[];\n}\n\nexport default function RestockingTable({ suggestions }: RestockingTableProps) {\n    if (suggestions.length === 0) {\n        return (\n            <div className=\"text-center py-12 bg-white rounded-lg shadow\">\n                <div className=\"mx-auto h-12 w-12 text-green-500\">\n                    <ShoppingCart className=\"h-full w-full\" />\n                </div>\n                <h3 className=\"mt-2 text-sm font-semibold text-gray-900\">Sin sugerencias</h3>\n                <p className=\"mt-1 text-sm text-gray-500\">El inventario está saludable. No se requieren compras urgentes.</p>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg\">\n            <div className=\"bg-red-50 px-4 py-3 border-b border-red-200 flex items-center gap-2\">\n                <AlertTriangle className=\"h-5 w-5 text-red-600\" />\n                <h3 className=\"text-sm font-medium text-red-800\">Sugerencia de Compra Urgente</h3>\n            </div>\n            <table className=\"min-w-full divide-y divide-gray-300\">\n                <thead className=\"bg-gray-50\">\n                    <tr>\n                        <th scope=\"col\" className=\"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6\">\n                            Producto\n                        </th>\n                        <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                            Stock Actual\n                        </th>\n                        <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                            Mínimo\n                        </th>\n                        <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                            Sugerido\n                        </th>\n                        <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                            Proveedor\n                        </th>\n                    </tr>\n                </thead>\n                <tbody className=\"divide-y divide-gray-200 bg-white\">\n                    {suggestions.map((item) => (\n                        <tr key={item.producto_id}>\n                            <td className=\"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6\">\n                                {item.nombre}\n                            </td>\n                            <td className=\"whitespace-nowrap px-3 py-4 text-sm text-red-600 font-bold\">\n                                {item.stock_actual}\n                            </td>\n                            <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500\">\n                                {item.stock_minimo}\n                            </td>\n                            <td className=\"whitespace-nowrap px-3 py-4 text-sm text-blue-600 font-bold bg-blue-50\">\n                                {item.sugerencia_pedido}\n                            </td>\n                            <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500\">\n                                {item.proveedor_sugerido}\n                            </td>\n                        </tr>\n                    ))}\n                </tbody>\n            </table>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAHA;;;AASe,SAAS,gBAAgB,EAAE,WAAW,EAAwB;IACzE,IAAI,YAAY,MAAM,KAAK,GAAG;QAC1B,qBACI,8OAAC;YAAI,WAAU;;8BACX,8OAAC;oBAAI,WAAU;8BACX,cAAA,8OAAC,sOAAY;wBAAC,WAAU;;;;;;;;;;;8BAE5B,8OAAC;oBAAG,WAAU;8BAA2C;;;;;;8BACzD,8OAAC;oBAAE,WAAU;8BAA6B;;;;;;;;;;;;IAGtD;IAEA,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAI,WAAU;;kCACX,8OAAC,yOAAa;wBAAC,WAAU;;;;;;kCACzB,8OAAC;wBAAG,WAAU;kCAAmC;;;;;;;;;;;;0BAErD,8OAAC;gBAAM,WAAU;;kCACb,8OAAC;wBAAM,WAAU;kCACb,cAAA,8OAAC;;8CACG,8OAAC;oCAAG,OAAM;oCAAM,WAAU;8CAAyE;;;;;;8CAGnG,8OAAC;oCAAG,OAAM;oCAAM,WAAU;8CAA4D;;;;;;8CAGtF,8OAAC;oCAAG,OAAM;oCAAM,WAAU;8CAA4D;;;;;;8CAGtF,8OAAC;oCAAG,OAAM;oCAAM,WAAU;8CAA4D;;;;;;8CAGtF,8OAAC;oCAAG,OAAM;oCAAM,WAAU;8CAA4D;;;;;;;;;;;;;;;;;kCAK9F,8OAAC;wBAAM,WAAU;kCACZ,YAAY,GAAG,CAAC,CAAC,qBACd,8OAAC;;kDACG,8OAAC;wCAAG,WAAU;kDACT,KAAK,MAAM;;;;;;kDAEhB,8OAAC;wCAAG,WAAU;kDACT,KAAK,YAAY;;;;;;kDAEtB,8OAAC;wCAAG,WAAU;kDACT,KAAK,YAAY;;;;;;kDAEtB,8OAAC;wCAAG,WAAU;kDACT,KAAK,iBAAiB;;;;;;kDAE3B,8OAAC;wCAAG,WAAU;kDACT,KAAK,kBAAkB;;;;;;;+BAdvB,KAAK,WAAW;;;;;;;;;;;;;;;;;;;;;;AAsBjD"}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/components/supply/ReceptionForm.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Supplier, receiveProduct } from '@/lib/data/supply';\nimport { useRouter } from 'next/navigation';\nimport { CheckCircle, Loader2 } from 'lucide-react';\n\ninterface ReceptionFormProps {\n    suppliers: Supplier[];\n    products: { id: number; nombre: string }[]; // Simplified product list for select\n}\n\nexport default function ReceptionForm({ suppliers, products }: ReceptionFormProps) {\n    const router = useRouter();\n    const [loading, setLoading] = useState(false);\n    const [success, setSuccess] = useState(false);\n    const [formData, setFormData] = useState({\n        proveedor_id: '',\n        producto_id: '',\n        cantidad: '',\n        numero_lote: '',\n        fecha_vencimiento: '',\n    });\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        try {\n            // In a real app, we would call a server action or API route.\n            // Since we are using direct DB calls in lib/data/supply.ts which are server-side,\n            // we can't call them directly from client component.\n            // We need a Server Action or pass a server action as prop.\n            // For MVP simplicity, let's assume we have a server action wrapper or API.\n            // BUT, since I can't easily create a server action file right now without more context,\n            // I'll create a simple API route for reception or just simulate it if I can't.\n            // Wait, Next.js App Router allows Server Actions.\n            // I will create a server action in a separate file `src/app/actions/supply.ts` later.\n            // For now, I will just alert.\n\n            // ACTUALLY, I should implement the Server Action pattern properly.\n            // I'll create the action file in the next step.\n            // Here I will assume `receiveProductAction` is passed or imported.\n\n            // Let's use a mock fetch to an API route I will create.\n            const res = await fetch('/api/supply/receive', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    ...formData,\n                    producto_id: Number(formData.producto_id),\n                    cantidad: Number(formData.cantidad)\n                }),\n            });\n\n            if (!res.ok) throw new Error('Error al recibir producto');\n\n            setSuccess(true);\n            setFormData({\n                proveedor_id: '',\n                producto_id: '',\n                cantidad: '',\n                numero_lote: '',\n                fecha_vencimiento: '',\n            });\n            router.refresh(); // Refresh server components\n            setTimeout(() => setSuccess(false), 3000);\n        } catch (error) {\n            console.error(error);\n            alert('Error al guardar la recepción');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"bg-white shadow sm:rounded-lg\">\n            <div className=\"px-4 py-5 sm:p-6\">\n                <h3 className=\"text-base font-semibold leading-6 text-gray-900\">Ingreso de Mercadería (Factura)</h3>\n                <div className=\"mt-2 max-w-xl text-sm text-gray-500\">\n                    <p>Registre la recepción de productos para actualizar el stock.</p>\n                </div>\n                <form className=\"mt-5 space-y-4\" onSubmit={handleSubmit}>\n\n                    <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\n                        <div>\n                            <label htmlFor=\"proveedor\" className=\"block text-sm font-medium text-gray-700\">Proveedor</label>\n                            <select\n                                id=\"proveedor\"\n                                required\n                                className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border\"\n                                value={formData.proveedor_id}\n                                onChange={(e) => setFormData({ ...formData, proveedor_id: e.target.value })}\n                            >\n                                <option value=\"\">Seleccione...</option>\n                                {suppliers.map(s => (\n                                    <option key={s.id} value={s.id}>{s.nombre_fantasia}</option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"producto\" className=\"block text-sm font-medium text-gray-700\">Producto</label>\n                            <select\n                                id=\"producto\"\n                                required\n                                className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border\"\n                                value={formData.producto_id}\n                                onChange={(e) => setFormData({ ...formData, producto_id: e.target.value })}\n                            >\n                                <option value=\"\">Seleccione...</option>\n                                {products.map(p => (\n                                    <option key={p.id} value={p.id}>{p.nombre}</option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"cantidad\" className=\"block text-sm font-medium text-gray-700\">Cantidad</label>\n                            <input\n                                type=\"number\"\n                                id=\"cantidad\"\n                                required\n                                min=\"1\"\n                                className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border\"\n                                value={formData.cantidad}\n                                onChange={(e) => setFormData({ ...formData, cantidad: e.target.value })}\n                            />\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"lote\" className=\"block text-sm font-medium text-gray-700\">Nuevo Lote</label>\n                            <input\n                                type=\"text\"\n                                id=\"lote\"\n                                required\n                                className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border\"\n                                value={formData.numero_lote}\n                                onChange={(e) => setFormData({ ...formData, numero_lote: e.target.value })}\n                            />\n                        </div>\n\n                        <div>\n                            <label htmlFor=\"vencimiento\" className=\"block text-sm font-medium text-gray-700\">Vencimiento</label>\n                            <input\n                                type=\"date\"\n                                id=\"vencimiento\"\n                                required\n                                className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm p-2 border\"\n                                value={formData.fecha_vencimiento}\n                                onChange={(e) => setFormData({ ...formData, fecha_vencimiento: e.target.value })}\n                            />\n                        </div>\n                    </div>\n\n                    <div className=\"pt-4\">\n                        <button\n                            type=\"submit\"\n                            disabled={loading}\n                            className=\"inline-flex justify-center rounded-md bg-purple-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-purple-600 disabled:opacity-50\"\n                        >\n                            {loading ? <Loader2 className=\"animate-spin h-5 w-5\" /> : 'Registrar Recepción'}\n                        </button>\n                        {success && (\n                            <span className=\"ml-3 inline-flex items-center text-green-600 text-sm font-medium\">\n                                <CheckCircle className=\"h-5 w-5 mr-1\" /> Guardado\n                            </span>\n                        )}\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 613, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/lib/store/useAuthStore.ts"],"sourcesContent":["import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\n\nexport type Role = 'ADMIN' | 'QF' | 'VENDEDOR';\n\ninterface User {\n    id: number;\n    username: string;\n    role: Role;\n}\n\ninterface AuthState {\n    user: User | null;\n    isAuthenticated: boolean;\n    role: Role | null;\n    login: (user: User) => void;\n    logout: () => void;\n}\n\nexport const useAuthStore = create<AuthState>()(\n    persist(\n        (set) => ({\n            user: null,\n            isAuthenticated: false,\n            role: null,\n            login: (user) => set({ user, isAuthenticated: true, role: user.role }),\n            logout: () => set({ user: null, isAuthenticated: false, role: null }),\n        }),\n        {\n            name: 'farmacias-vallenar-auth',\n        }\n    )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAkBO,MAAM,eAAe,IAAA,kJAAM,IAC9B,IAAA,wJAAO,EACH,CAAC,MAAQ,CAAC;QACN,MAAM;QACN,iBAAiB;QACjB,MAAM;QACN,OAAO,CAAC,OAAS,IAAI;gBAAE;gBAAM,iBAAiB;gBAAM,MAAM,KAAK,IAAI;YAAC;QACpE,QAAQ,IAAM,IAAI;gBAAE,MAAM;gBAAM,iBAAiB;gBAAO,MAAM;YAAK;IACvE,CAAC,GACD;IACI,MAAM;AACV"}},
    {"offset": {"line": 642, "column": 0}, "map": {"version":3,"sources":["file:///Users/miguelperdomoserrato/farmacias-vallenar-suit/src/components/auth/RouteGuard.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuthStore, Role } from '@/lib/store/useAuthStore';\n\ninterface RouteGuardProps {\n    children: React.ReactNode;\n    allowedRoles?: Role[];\n}\n\nexport default function RouteGuard({ children, allowedRoles }: RouteGuardProps) {\n    const router = useRouter();\n    const { isAuthenticated, role } = useAuthStore();\n    const [authorized, setAuthorized] = useState(false);\n\n    useEffect(() => {\n        // Wait for hydration (zustand persist)\n        const checkAuth = () => {\n            if (!isAuthenticated) {\n                router.push('/login');\n                return;\n            }\n\n            if (allowedRoles && role && !allowedRoles.includes(role)) {\n                // Redirect to dashboard if role not allowed for this specific route\n                // Or maybe show unauthorized page. For now, dashboard.\n                router.push('/');\n                return;\n            }\n\n            setAuthorized(true);\n        };\n\n        checkAuth();\n    }, [isAuthenticated, role, router, allowedRoles]);\n\n    if (!authorized) {\n        return null; // Or a loading spinner\n    }\n\n    return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAWe,SAAS,WAAW,EAAE,QAAQ,EAAE,YAAY,EAAmB;IAC1E,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,EAAE,eAAe,EAAE,IAAI,EAAE,GAAG,IAAA,mJAAY;IAC9C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,IAAA,kNAAS,EAAC;QACN,uCAAuC;QACvC,MAAM,YAAY;YACd,IAAI,CAAC,iBAAiB;gBAClB,OAAO,IAAI,CAAC;gBACZ;YACJ;YAEA,IAAI,gBAAgB,QAAQ,CAAC,aAAa,QAAQ,CAAC,OAAO;gBACtD,oEAAoE;gBACpE,uDAAuD;gBACvD,OAAO,IAAI,CAAC;gBACZ;YACJ;YAEA,cAAc;QAClB;QAEA;IACJ,GAAG;QAAC;QAAiB;QAAM;QAAQ;KAAa;IAEhD,IAAI,CAAC,YAAY;QACb,OAAO,MAAM,uBAAuB;IACxC;IAEA,qBAAO;kBAAG;;AACd"}}]
}