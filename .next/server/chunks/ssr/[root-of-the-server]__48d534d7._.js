module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},48182,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(42263);function f({children:a,allowedRoles:f}){let g=(0,d.useRouter)(),{isAuthenticated:h,user:i}=(0,e.useAuthStore)(),[j,k]=(0,c.useState)(!1);return((0,c.useEffect)(()=>{h?f&&i&&!f.includes(i.role)?g.push("/"):k(!0):g.push("/login")},[h,i,g,f]),j)?(0,b.jsx)(b.Fragment,{children:a}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})}a.s(["default",()=>f])},38784,a=>{"use strict";let b=(0,a.i(70106).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);a.s(["ShoppingCart",()=>b],38784)},87532,a=>{"use strict";let b=(0,a.i(70106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],87532)},15618,a=>{"use strict";let b=(0,a.i(70106).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},85220,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(87532),e=a.i(38784),f=a.i(70106);let g=(0,f.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),h=(0,f.default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),i=(0,f.default)("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),j=(0,f.default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]),k=(0,f.default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);var l=a.i(15618);let m=(0,f.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);async function n(a,b){await new Promise(a=>setTimeout(a,800));let c=Math.round(a/1.19);return{folio:Math.floor(1e5*Math.random())+1,fecha:new Date().toISOString(),total:a,neto:c,iva:a-c,items:b,razon_social:"FARMACIAS VALLENAR SPA",rut_emisor:"76.123.456-7",direccion:"Calle Prat 123, Vallenar",giro:"VENTA AL POR MENOR DE PRODUCTOS FARMACEUTICOS",track_id:crypto.randomUUID(),estado:"ACEPTADO"}}function o(a){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(a)}let p=(0,f.default)("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);function q({data:a}){return(0,b.jsxs)("div",{className:"bg-white p-4 w-[300px] mx-auto text-black font-mono text-xs print-only",children:[(0,b.jsxs)("div",{className:"text-center mb-4",children:[(0,b.jsx)("h1",{className:"font-bold text-lg uppercase",children:a.razon_social}),(0,b.jsxs)("p",{children:["RUT: ",a.rut_emisor]}),(0,b.jsx)("p",{children:a.giro}),(0,b.jsx)("p",{children:a.direccion}),(0,b.jsx)("p",{children:"Fono: +56 51 261 2345"})]}),(0,b.jsxs)("div",{className:"text-center border-t border-b border-black py-2 mb-4",children:[(0,b.jsx)("h2",{className:"font-bold text-sm",children:"BOLETA ELECTRÓNICA"}),(0,b.jsxs)("p",{className:"text-lg font-bold",children:["Nº ",a.folio]}),(0,b.jsx)("p",{children:"S.I.I. - VALLENAR"}),(0,b.jsxs)("p",{className:"mt-1",children:["Fecha: ",new Date(a.fecha).toLocaleString()]})]}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsxs)("table",{className:"w-full text-left",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-black border-dashed",children:[(0,b.jsx)("th",{className:"py-1 w-8",children:"Cant"}),(0,b.jsx)("th",{className:"py-1",children:"Desc"}),(0,b.jsx)("th",{className:"py-1 text-right",children:"Total"})]})}),(0,b.jsx)("tbody",{children:a.items.map((a,c)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"py-1 align-top",children:a.cantidad}),(0,b.jsx)("td",{className:"py-1 align-top",children:a.nombre}),(0,b.jsx)("td",{className:"py-1 align-top text-right",children:o(a.total)})]},c))})]})}),(0,b.jsxs)("div",{className:"border-t border-black border-dashed pt-2 mb-4",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Neto:"}),(0,b.jsx)("span",{children:o(a.neto)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"IVA (19%):"}),(0,b.jsx)("span",{children:o(a.iva)})]}),(0,b.jsxs)("div",{className:"flex justify-between font-bold text-sm mt-1",children:[(0,b.jsx)("span",{children:"TOTAL:"}),(0,b.jsx)("span",{children:o(a.total)})]})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center mb-4",children:[(0,b.jsx)("div",{className:"border-2 border-black p-2 mb-1",children:(0,b.jsx)(p,{size:64,className:"text-black"})}),(0,b.jsxs)("p",{className:"text-[10px] uppercase text-center",children:["Timbre Electrónico SII",(0,b.jsx)("br",{}),"Res. 80 de 2014 - Verifique documento: www.sii.cl"]})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"font-bold",children:"¡GRACIAS POR SU PREFERENCIA!"}),(0,b.jsx)("p",{className:"text-[10px] mt-1",children:"Copia Cliente"})]})]})}var r=a.i(48182);let s=[{id:1,name:"Paracetamol 500mg",price:2990,stock:100,requiresPrescription:!1},{id:2,name:"Ibuprofeno 400mg",price:3490,stock:50,requiresPrescription:!1},{id:3,name:"Amoxicilina 500mg",price:5990,stock:30,requiresPrescription:!0},{id:4,name:"Loratadina 10mg",price:1990,stock:80,requiresPrescription:!1},{id:5,name:"Losartán 50mg",price:8990,stock:150,requiresPrescription:!1}];function t(){let[a,f]=(0,c.useState)(""),[o,p]=(0,c.useState)([]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(!1),z=(a,b)=>{p(c=>c.map(c=>{if(c.id===a){let a=c.quantity+b;return a>0?{...c,quantity:a}:c}return c}))},A=o.reduce((a,b)=>a+b.price*b.quantity,0),B=async()=>{if(0!==o.length){u(!0);try{let a=o.map(a=>({nombre:a.name,cantidad:a.quantity,precio:a.price,total:a.price*a.quantity})),b=await n(A,a);w(b),y(!0),p([])}catch(a){alert("Error al procesar la venta")}finally{u(!1)}}},C=()=>{y(!1),w(null),p([])},D=s.filter(b=>b.name.toLowerCase().includes(a.toLowerCase()));return(0,b.jsx)(r.default,{allowedRoles:["ADMIN","QUIMICO","VENDEDOR"],children:(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4",children:[(0,b.jsxs)("div",{className:"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,b.jsx)("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(d.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),(0,b.jsx)("input",{type:"text",placeholder:"Buscar producto...",className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:a,onChange:a=>f(a.target.value)})]})}),(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:D.map(a=>(0,b.jsxs)("button",{onClick:()=>{p(b=>b.find(b=>b.id===a.id)?b.map(b=>b.id===a.id?{...b,quantity:b.quantity+1}:b):[...b,{...a,quantity:1}])},className:"bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-all text-left group",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-900 group-hover:text-blue-600",children:a.name}),(0,b.jsxs)("div",{className:"text-gray-500 text-sm mt-1",children:["Stock: ",a.stock]}),(0,b.jsxs)("div",{className:"text-lg font-bold text-blue-600 mt-2",children:["$",a.price.toLocaleString()]}),a.requiresPrescription&&(0,b.jsx)("span",{className:"inline-block mt-2 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:"Receta"})]},a.id))})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm h-[calc(100vh-2rem)] flex flex-col sticky top-4",children:[(0,b.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,b.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,b.jsx)(e.ShoppingCart,{className:"text-blue-600"}),"Carro de Compra"]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:0===o.length?(0,b.jsx)("div",{className:"text-center text-gray-400 py-8",children:"Carro vacío"}):o.map(a=>(0,b.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsxs)("div",{className:"text-sm text-gray-500",children:["$",a.price.toLocaleString()," x ",a.quantity]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 bg-white rounded-lg border border-gray-200",children:[(0,b.jsx)("button",{onClick:()=>z(a.id,-1),className:"p-1 hover:bg-gray-100 rounded-l-lg",children:(0,b.jsx)(m,{size:16})}),(0,b.jsx)("span",{className:"w-8 text-center text-sm",children:a.quantity}),(0,b.jsx)("button",{onClick:()=>z(a.id,1),className:"p-1 hover:bg-gray-100 rounded-r-lg",children:(0,b.jsx)(l.Plus,{size:16})})]}),(0,b.jsx)("button",{onClick:()=>{var b;return b=a.id,void p(a=>a.filter(a=>a.id!==b))},className:"text-red-500 hover:text-red-700 p-1",children:(0,b.jsx)(g,{size:18})})]})]},a.id))}),(0,b.jsxs)("div",{className:"p-4 border-t border-gray-100 bg-gray-50 rounded-b-xl",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4 text-lg font-bold",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsxs)("span",{children:["$",A.toLocaleString()]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,b.jsxs)("button",{className:"flex items-center justify-center gap-2 p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,b.jsx)(i,{size:20,className:"text-green-600"}),"Efectivo"]}),(0,b.jsxs)("button",{className:"flex items-center justify-center gap-2 p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,b.jsx)(h,{size:20,className:"text-blue-600"}),"Tarjeta"]})]}),(0,b.jsx)("button",{onClick:B,disabled:0===o.length||t,className:"w-full py-4 bg-blue-600 text-white rounded-xl font-bold text-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Procesando...":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{}),"Emitir Boleta"]})})]})]})]}),x&&v&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden flex flex-col max-h-[90vh]",children:[(0,b.jsxs)("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[(0,b.jsx)("h3",{className:"font-bold text-lg text-gray-800",children:"Boleta Generada"}),(0,b.jsxs)("button",{onClick:C,className:"text-gray-400 hover:text-gray-600",children:[(0,b.jsx)("span",{className:"sr-only",children:"Cerrar"}),"✕"]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-100 flex justify-center",children:(0,b.jsx)("div",{className:"shadow-lg",children:(0,b.jsx)(q,{data:v})})}),(0,b.jsxs)("div",{className:"p-4 border-t bg-white grid grid-cols-2 gap-4",children:[(0,b.jsxs)("button",{onClick:C,className:"flex items-center justify-center gap-2 px-4 py-3 border border-gray-300 rounded-xl text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:[(0,b.jsx)(l.Plus,{size:20}),"Nueva Venta"]}),(0,b.jsxs)("button",{onClick:()=>{window.print()},className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition-colors shadow-lg shadow-blue-200",children:[(0,b.jsx)(k,{size:20}),"Imprimir"]})]})]})})]})})}a.s(["default",()=>t],85220)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__48d534d7._.js.map