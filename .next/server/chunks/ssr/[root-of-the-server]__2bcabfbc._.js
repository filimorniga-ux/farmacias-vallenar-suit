module.exports=[30056,a=>a.a(async(b,c)=>{try{let b=await a.y("pg");a.n(b),c()}catch(a){c(a)}},!0),61469,a=>a.a(async(b,c)=>{try{var d=a.i(30056),e=b([d]);[d]=e.then?(await e)():e;let g=new d.Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}});async function f(a,b){let c=Date.now();try{let d=await g.query(a,b),e=Date.now()-c;return console.log("Executed query",{text:a,duration:e,rows:d.rowCount}),d}catch(a){return console.warn("âš ï¸ Safe Mode: Database connection failed. Returning empty data."),{rows:[],rowCount:0,command:"",oid:0,fields:[]}}}g.on("error",(a,b)=>{console.error("Unexpected error on idle client",a)}),a.s(["query",()=>f]),c()}catch(a){c(a)}},!1),37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},73921,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/auth/RouteGuard.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/auth/RouteGuard.tsx <module evaluation>","default");a.s(["default",0,b])},21524,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/auth/RouteGuard.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/auth/RouteGuard.tsx","default");a.s(["default",0,b])},78240,a=>{"use strict";a.i(73921);var b=a.i(21524);a.n(b)},26683,a=>a.a(async(b,c)=>{try{var d=a.i(61469),e=b([d]);async function f(a,b,c){try{let e=`
            INSERT INTO audit_logs (usuario, accion, detalle)
            VALUES ($1, $2, $3)
        `;await (0,d.query)(e,[a,b,c])}catch(a){console.error("Error logging action:",a)}}[d]=e.then?(await e)():e,a.s(["logAction",()=>f]),c()}catch(a){c(a)}},!1),50933,a=>a.a(async(b,c)=>{try{var d=a.i(37936),e=a.i(26683),f=a.i(13095),g=b([e]);async function h(a,b,c){await (0,e.logAction)(a,b,c)}[e]=g.then?(await g)():g,(0,f.ensureServerEntryExports)([h]),(0,d.registerServerReference)(h,"70610f9480cb8076820485f1c0bd0020dae47b9cb9",null),a.s(["logActionServer",()=>h]),c()}catch(a){c(a)}},!1),74990,a=>a.a(async(b,c)=>{try{var d=a.i(61469),e=b([d]);async function f(){try{return(await (0,d.query)("SELECT id, nombre FROM productos WHERE activo = true ORDER BY nombre ASC")).rows}catch(a){return console.error("Error fetching products:",a),[]}}async function g(){try{return(await (0,d.query)("SELECT * FROM proveedores ORDER BY nombre_fantasia ASC")).rows}catch(a){return console.error("Error fetching suppliers:",a),[]}}async function h(){try{let a=`
      SELECT 
        p.id as producto_id,
        p.nombre,
        p.stock_minimo_seguridad,
        COALESCE(SUM(l.cantidad_disponible), 0) as stock_actual
      FROM productos p
      LEFT JOIN lotes l ON p.id = l.producto_id
      WHERE p.activo = true
      GROUP BY p.id, p.nombre, p.stock_minimo_seguridad
    `,b=await (0,d.query)(a),c=[];return b.rows.forEach(a=>{let b=Number(a.stock_actual),d=Number(a.stock_minimo_seguridad)||10;if(b<=d){let e=3*d-b;e<0&&(e=0),e>0&&c.push({producto_id:a.producto_id,nombre:a.nombre,stock_actual:b,stock_minimo:d,sugerencia_pedido:e,proveedor_sugerido:"Laboratorio Chile"})}}),c.sort((a,b)=>a.stock_actual-b.stock_actual)}catch(a){return console.error("Error calculating restocking suggestions:",a),[]}}[d]=e.then?(await e)():e,a.s(["getProducts",()=>f,"getRestockingSuggestions",()=>h,"getSuppliers",()=>g]),c()}catch(a){c(a)}},!1),81170,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/supply/RestockingTable.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/supply/RestockingTable.tsx <module evaluation>","default");a.s(["default",0,b])},3739,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/supply/RestockingTable.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/supply/RestockingTable.tsx","default");a.s(["default",0,b])},18060,a=>{"use strict";a.i(81170);var b=a.i(3739);a.n(b)},46604,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/supply/ReceptionForm.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/supply/ReceptionForm.tsx <module evaluation>","default");a.s(["default",0,b])},31983,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/supply/ReceptionForm.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/supply/ReceptionForm.tsx","default");a.s(["default",0,b])},43759,a=>{"use strict";a.i(46604);var b=a.i(31983);a.n(b)},24847,a=>a.a(async(b,c)=>{try{var d=a.i(7997),e=a.i(37936),f=a.i(74990),g=a.i(18060),h=a.i(43759),i=a.i(78240),j=b([f]);[f]=j.then?(await j)():j;let l=async function(){let{logActionServer:b}=await a.A(70238);await b("admin","AJUSTE_STOCK","Ajuste manual de stock simulado: Paracetamol -10")};async function k(){let a=await (0,f.getSuppliers)(),b=await (0,f.getRestockingSuggestions)(),c=await (0,f.getProducts)();return(0,d.jsx)(i.default,{allowedRoles:["ADMIN","QF"],children:(0,d.jsx)("div",{className:"min-h-screen bg-gray-100 py-8",children:(0,d.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,d.jsxs)("div",{className:"md:flex md:items-center md:justify-between mb-8",children:[(0,d.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight",children:"ðŸšš Abastecimiento"}),(0,d.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"GestiÃ³n de proveedores y reposiciÃ³n inteligente."})]}),(0,d.jsx)("div",{className:"mt-4 flex md:ml-4 md:mt-0",children:(0,d.jsx)("form",{action:l,children:(0,d.jsx)("button",{type:"submit",className:"ml-3 inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Simular Ajuste Stock"})})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,d.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,d.jsxs)("div",{className:"bg-white shadow sm:rounded-lg p-6",children:[(0,d.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900 mb-4",children:"Alertas de Stock"}),(0,d.jsx)(g.default,{suggestions:b})]})}),(0,d.jsx)("div",{className:"lg:col-span-1",children:(0,d.jsx)(h.default,{suppliers:a,products:c})})]})]})})})}(0,e.registerServerReference)(l,"00e00ff649a3c28d13f68be9addfd3ca593e7d7e05",null),a.s(["$$RSC_SERVER_ACTION_0",0,l,"default",()=>k,"dynamic",0,"force-dynamic"]),c()}catch(a){c(a)}},!1),62076,a=>a.a(async(b,c)=>{try{var d=a.i(24847),e=a.i(50933),f=b([d,e]);[d,e]=f.then?(await f)():f,a.s([]),c()}catch(a){c(a)}},!1),84105,a=>a.a(async(b,c)=>{try{var d=a.i(62076),e=a.i(24847),f=a.i(50933),g=b([d,e,f]);[d,e,f]=g.then?(await g)():g,a.s(["00e00ff649a3c28d13f68be9addfd3ca593e7d7e05",()=>e.$$RSC_SERVER_ACTION_0,"70610f9480cb8076820485f1c0bd0020dae47b9cb9",()=>f.logActionServer]),c()}catch(a){c(a)}},!1),70238,a=>{a.v(a=>Promise.resolve().then(()=>a(50933)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2bcabfbc._.js.map