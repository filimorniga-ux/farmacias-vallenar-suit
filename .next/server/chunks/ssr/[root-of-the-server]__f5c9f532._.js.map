{"version":3,"sources":["../../../../src/lib/db.ts","../../../../src/components/auth/RouteGuard.tsx/__nextjs-internal-proxy.mjs","../../../../src/lib/data/logistics.ts","../../../../src/components/logistica/DataTable.tsx/__nextjs-internal-proxy.mjs","../../../../src/components/logistica/AddPurchaseButton.tsx/__nextjs-internal-proxy.mjs","../../../../src/app/logistica/page.tsx"],"sourcesContent":["import { Pool } from 'pg';\n\n// Disable SSL verification for self-signed certs in development\nif (process.env.NODE_ENV !== 'production') {\n    process.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';\n}\n\nconst pool = new Pool({\n    // La conexi√≥n se sigue leyendo de la variable DATABASE_URL\n    connectionString: process.env.DATABASE_URL,\n    // [PARCHE CR√çTICO PARA EL ENTORNO LOCAL]\n    ssl: {\n        rejectUnauthorized: false,\n    },\n});\n\nexport async function query(text: string, params?: any[]) {\n    const start = Date.now();\n    const res = await pool.query(text, params);\n    const duration = Date.now() - start;\n    console.log('Executed query', { text, duration, rows: res.rowCount });\n    return res;\n}\n\nexport default pool;\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/auth/RouteGuard.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/auth/RouteGuard.tsx\",\n    \"default\",\n);\n","import { query } from '../db';\n\nexport interface LogisticsItem {\n  producto_id: number;\n  nombre: string;\n  dci: string | null;\n  categoria: string;\n  condicion_venta: string;\n  requiere_frio: boolean;\n  lote_id: number;\n  numero_lote: string;\n  fecha_vencimiento: string; // ISO string from DB\n  cantidad_disponible: number;\n  ubicacion_fisica: string | null;\n  estado: string;\n}\n\nexport async function getLogisticsData(): Promise<LogisticsItem[]> {\n  const sql = `\n    SELECT \n      p.id as producto_id,\n      p.nombre,\n      p.dci,\n      p.categoria,\n      p.condicion_venta,\n      p.requiere_frio,\n      l.id as lote_id,\n      l.numero_lote,\n      l.fecha_vencimiento,\n      l.cantidad_disponible,\n      l.ubicacion_fisica,\n      l.estado\n    FROM productos p\n    JOIN lotes l ON p.id = l.producto_id\n    ORDER BY l.fecha_vencimiento ASC\n  `;\n\n  try {\n    const result = await query(sql);\n    // Convert date objects to ISO strings if necessary, though pg usually returns Date objects.\n    // We'll map to ensure consistent types for the frontend.\n    return result.rows.map((row: any) => ({\n      ...row,\n      fecha_vencimiento: new Date(row.fecha_vencimiento).toISOString(),\n    }));\n  } catch (error) {\n    console.error('Error fetching logistics data:', error);\n    throw new Error('Failed to fetch logistics data');\n  }\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/logistica/DataTable.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/logistica/DataTable.tsx\",\n    \"default\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/logistica/AddPurchaseButton.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/logistica/AddPurchaseButton.tsx\",\n    \"default\",\n);\n","import { getLogisticsData } from '@/lib/data/logistics';\nimport DataTable from '@/components/logistica/DataTable';\nimport AddPurchaseButton from '@/components/logistica/AddPurchaseButton';\nimport RouteGuard from '@/components/auth/RouteGuard';\n\nexport const dynamic = 'force-dynamic';\n\nexport default async function LogisticaPage() {\n    const logisticsData = await getLogisticsData();\n\n    return (\n        <RouteGuard allowedRoles={['ADMIN', 'QF', 'VENDEDOR']}>\n            <div className=\"min-h-screen bg-gray-100 py-8\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <div className=\"md:flex md:items-center md:justify-between mb-8\">\n                        <div className=\"min-w-0 flex-1\">\n                            <h2 className=\"text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight\">\n                                üì¶ Log√≠stica y Bodega\n                            </h2>\n                            <p className=\"mt-1 text-sm text-gray-500\">\n                                Gesti√≥n de inventario, lotes y trazabilidad.\n                            </p>\n                        </div>\n                        <div className=\"mt-4 flex md:ml-4 md:mt-0\">\n                            <AddPurchaseButton />\n                        </div>\n                    </div>\n\n                    <div className=\"bg-white shadow-sm ring-1 ring-gray-900/5 sm:rounded-xl md:col-span-2\">\n                        <div className=\"px-4 py-6 sm:px-6\">\n                            <DataTable initialData={logisticsData} />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </RouteGuard>\n    );\n}\n"],"names":[],"mappings":"+ZAAA,IAAA,EAAA,EAAA,CAAA,CAAA,yCAOA,IAAM,EAAO,IAAI,EAAA,IAAI,CAAC,CAElB,iBAAkB,QAAQ,GAAG,CAAC,YAAY,CAE1C,IAAK,CACD,mBAAoB,EACxB,CACJ,GAEO,eAAe,EAAM,CAAY,CAAE,CAAc,EACpD,IAAM,EAAQ,KAAK,GAAG,GAChB,EAAM,MAAM,EAAK,KAAK,CAAC,EAAM,GAC7B,EAAW,KAAK,GAAG,GAAK,EAE9B,OADA,QAAQ,GAAG,CAAC,iBAAkB,MAAE,WAAM,EAAU,KAAM,EAAI,QAAQ,AAAC,GAC5D,CACX,2ECpBe,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAU,AAAJ,MAAU,oSAAsS,EACnU,mEACA,8DAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,gRAAkR,EAC/S,+CACA,0HCLJ,IAAA,EAAA,EAAA,CAAA,CAAA,gBAiBO,eAAe,IACpB,IAAM,EAAM,CAAC;;;;;;;;;;;;;;;;;EAiBb,CAAC,CAED,GAAI,CAIF,MAHe,AAGR,OAHc,CAAA,EAAA,EAAA,KAAA,AAAK,EAAC,EAAA,EAGb,IAAI,CAAC,GAAG,CAAC,AAAC,IAAc,CACpC,CADmC,EAChC,CAAG,CACN,kBAAmB,IAAI,KAAK,EAAI,iBAAiB,EAAE,WAAW,GAChE,CAAC,CACH,CAAE,MAAO,EAAO,CAEd,MADA,QAAQ,KAAK,CAAC,iCAAkC,GAC1C,AAAI,MAAM,iCAClB,CACF,+GC/Ce,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,wSAA0S,EACvU,uEACA,8DAHW,CAAA,EAAA,AADf,EAAA,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,oRAAsR,EACnT,mDACA,wHCHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,gTAAkT,EAC/U,+EACA,8DAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAU,AAAJ,MAAU,4RAA8R,EAC3T,2DACA,yICLJ,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,gBAIe,eAAe,IAC1B,IAAM,EAAgB,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,IAE5C,MACI,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAU,CAAA,CAAC,aAAc,CAAC,QAAS,KAAM,WAAW,UACjD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4DACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gGAAuF,0BAGrG,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,oDAI9C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qCACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAiB,CAAA,CAAA,QAI1B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iFACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6BACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAS,CAAA,CAAC,YAAa,cAOpD,2DAhCuB","ignoreList":[1,3,4]}